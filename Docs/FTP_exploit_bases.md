# Les bases des exploits FTP

## Introduction

Le protocole de transfert de fichiers (FTP) est, comme son nom l'indique, un protocole utilisé pour permettre le transfert de fichiers à distance sur un réseau. Le protocole FTP est un protocole client-serveur. Le client établit une connexion avec le serveur, ce dernier valide les informations d'identification fournies et ouvre la session. Une fois la session ouverte, le client peut envoyer des commandes FTP telles que `LIST`, `RETR`, `STOR`, etc. pour effectuer des opérations sur les fichiers distants.

Une session FTP typique utilise deux canaux :
* un canal de commande (parfois appelé canal de contrôle)
* un canal de données

Cette séparation des informations de commande et des données dans des canaux distincts permet d'envoyer des commandes au serveur sans devoir attendre la fin du transfert de données en cours. Si les deux canaux étaient interconnectés, vous ne pourriez entrer des commandes qu'entre deux transferts de données, ce qui ne serait pas efficace pour les transferts de fichiers volumineux ou les connexions internet lentes.

### Actif vs Passif

Le serveur FTP peut prendre en charge les connexions actives ou passives, ou les deux.

* Dans une connexion FTP active, le client ouvre un port et écoute. Le serveur doit se connecter activement au client.
* Dans une connexion FTP passive, le serveur ouvre un port et écoute (passivement) et le client s'y connecte.

## Enumeration

### Ports de base FTP

Le port de base FTP est le port 21 pour les commandes et 22 pour les transferts de données. C'est du TCP/IP.

### Repérage des utilisateurs

Certaines versions vulnérables de in.ftpd et d'autres variantes de serveurs FTP renvoient des réponses différentes à la commande ```cwd``` pour les répertoires personnels qui existent et ceux qui n'existent pas. Cela peut être exploité parce que vous pouvez lancer des commandes cwd avant l'authentification, et s'il y a un répertoire personnel, il y a plus que probablement un compte d'utilisateur pour l'accompagner. Bien que ce bogue soit principalement présent dans les systèmes anciens, il vaut la peine d'être connu, car c'est un moyen d'exploiter le protocole FTP.

Plus d'infos sur [ce lien](https://www.exploit-db.com/exploits/20745 ).

### Test de connexion anonyme

On peut tester de se connecter en utilisant un nom d'utilisateur générique comme "anonymous" ou "ftp" avec un mot de passe vide. Si le serveur accepte la connexion, il est possible de télécharger des fichiers sans avoir à s'authentifier. Cela peut être utile pour télécharger des fichiers de configuration ou des fichiers de mot de passe.

Pour se connecter en ftp il suffit de rentrer la commande suivante :

```bash
ftp [IP]
```


  

