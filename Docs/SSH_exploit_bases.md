# Les bases des exploits SSH

## Introduction

Le protocole SSH (Secure Shell) est un protocole de communication sécurisé qui permet d'accéder à un ordinateur distant en utilisant un canal sécurisé entre un client et un serveur. Il est utilisé par les administrateurs système pour gérer à distance les systèmes et les applications, et par les utilisateurs pour accéder à distance aux ressources d'un réseau. Il est également utilisé pour transférer des fichiers d'un ordinateur à un autre sur un réseau.

## Connexion en SSH

### Connexion en SSH avec le nom d'utilisateur

Pour se connecter en SSH avec le nom d'utilisateur il suffit de rentrer la commande suivante :

```bash
ssh [USER]@[IP]
```
On peut aussi faire : 

```bash
ssh [IP] -l [USER]
```

### Connexion en SSH avec une clé privée

Pour se connecter en SSH avec une clé privée (typiquement un fichier "id_rsa" ) il suffit de rentrer la commande suivante :

```bash
ssh [USER]@[IP] -i [PATH]
```

Attention à bien changer le droit d'accès de la clé privée au préalable avec la commande suivante :

```bash
chmod 600 [PATH]
```

## Le port de base SSH

Le port de base SSH est le port 22. C'est du TCP/IP.

## Enumeration

### Packet nécessaire

Tout d'abord, il faut avoir le paquet openssh-client installé sur la machine. Pour cela, il suffit de rentrer la commande suivante :

```bash
sudo apt install openssh-client
```

### Enumération des utilisateurs

Pour lister les utilisateurs, il suffit de rentrer la commande suivante :

```bash
ssh [IP] -l [USER] -o PreferredAuthentications=none
```

## Exploitation

### Bruteforce d'un utilisateur

Si on connait un utilisateur, on peut essayer de bruteforce son mot de passe avec Hydra. Particulièrement s'il sagit d'un utilisateur commun comme "root" ou "admin".

```bash
hydra -t 16 -l [USERNAME] -P /usr/share/wordlists/rockyou.txt -vV [IP] ssh
```
Pour rappel :
* `-t 16` : nombre de threads
* `-P /usr/share/wordlists/rockyou.txt` : wordlist à utiliser
