# TELNET : les exploits de base

## Introduction

Telnet est un protocole d'application qui vous permet, à l'aide d'un client telnet, de vous connecter et d'exécuter des commandes sur une machine distante hébergeant un serveur telnet.

Le client telnet établit une connexion avec le serveur. Le client devient alors un terminal virtuel qui vous permet d'interagir avec l'hôte distant.

Telnet envoie tous les messages en texte clair et ne dispose pas de mécanismes de sécurité spécifiques. Par conséquent, dans de nombreuses applications et services, Telnet a été remplacé par SSH dans la plupart des implémentations.

## Connexion à un serveur Telnet

Pour se connecter à un serveur telnet, il suffit de taper la commande suivante :

```bash
telnet <ip> <port>
```
Les ports par défaut sont **23 pour telnet** et **22 pour SSH**.

Mettre un port différent de 23 pour telnet est une bonne pratique de sécurité et permet potentiellement de créer une **backdoor**.

### Commandes de base de telnet

* ```.RUN <ma commande à run>``` permet d'exécuter une commande
* ```.HELP``` permet d'afficher l'aide
* ```.EXIT``` permet de se déconnecter du serveur

## Exploits

### Telnet bruteforce

Telnet est un protocole qui n'est pas sécurisé. Il est donc possible de faire du bruteforce sur les mots de passe.

Pour cela, il suffit d'utiliser le script **telnet_brute.py**.

```bash
python3 telnet_brute.py <ip> <user> <wordlist>
```

### Telnet backdoor

Il est possible de créer une backdoor en utilisant telnet.

Pour cela, il suffit de créer un fichier **.bat** avec le contenu suivant :

```bash
@echo off
telnet <ip> <port>
```
Pour utiliser cette backdoor, il suffit de lancer le fichier **.bat**.

### Telnet RCE

Il est possible d'exploiter une vulnérabilité de telnet pour exécuter des commandes sur la machine distante.

Pour cela, il suffit d'utiliser le script **telnet_rce.py**.

```bash
python3 telnet_rce.py <ip> <port> <command>
```

### Telnet CVE les plus connues

* [CVE-2005-0469](https://www.cvedetails.com/cve/CVE-2005-0469/) : Buffer overflow in the slc_add_reply function in various BSD-based Telnet clients, when handling LINEMODE suboptions, allows remote attackers to execute arbitrary code via a reply with a large number of Set Local Character (SLC) commands.
* [CVE-2005-0468](https://www.cvedetails.com/cve/CVE-2005-0468/): Heap-based buffer overflow in the env_opt_add function in telnet.c for various BSD-based Telnet clients allows remote attackers to execute arbitrary code via responses that contain a large number of characters that require escaping, which consumers more memory than allocated.
* [CVE-1999-1090](https://www.cvedetails.com/cve/CVE-1999-1090/) : The default configuration of NCSA Telnet package for Macintosh and PC enables FTP, even though it does not include an "ftp=yes" line, which allows remote attackers to read and modify arbitrary files.