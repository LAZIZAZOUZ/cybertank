{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Alexis Raynaud Projet de documentation de mes connaissances en cyber avec Mkdocs Puit de connaissance en Cyber Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Alexis Raynaud"},{"location":"#alexis-raynaud","text":"Projet de documentation de mes connaissances en cyber avec Mkdocs","title":"Alexis Raynaud"},{"location":"#puit-de-connaissance-en-cyber","text":"Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Puit de connaissance en Cyber"},{"location":"accueil/","text":"Puit de connaissance en Cyber Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Accueil"},{"location":"accueil/#puit-de-connaissance-en-cyber","text":"Bienvenue sur mon petit site statique local pour rassembler toutes les connaissances que je peux avoir en Cyber","title":"Puit de connaissance en Cyber"},{"location":"changer_DNS_windows/","text":"Changement de DNS windows Connaitre son DNS actuel ipconfig /all | findstr \"Server DNS\" Pour trouver le DNS rapidement. Personnellement \u00e7a me met l'IP de ma box ce qui est normal car mes requ\u00eates sont envoy\u00e9es \u00e0 ma box qui renvoie vers le DNS de son choix et \u00e7a \u00e7a me plait pas. En utilisant le cmd Connaitre le nom de l'interface r\u00e9seau pour laquelle on va changer le DNS netsh interface show interface Personnellement c'est Ethernet Du coup on va changer le serveur DNS du protocol IPv4 et IPv6 s\u00e9par\u00e9ment. IPv4 Je commence par IPv4 et je vais mettre le DNS public google : 8.8.8.8 (principal) et 8.8.4.4 (secoure), on va le faire en deux fois : /!\\ il faut lancer le terminal en administrateur netsh interface ipv4 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv4 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 IPv6 C'est la m\u00eame chose mais avec des adresses IPv6 : 2001:4860:4860::8888 (principale sur le port 8888) et secondaire : 2001:4860:4860::8844 netsh interface ipv6 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv6 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 On peut v\u00e9rifier que \u00e7a a bien march\u00e9 : Connaitre le DNS d'une interface r\u00e9seau particuli\u00e8re pour un protocole particulier netsh interface Nom_protocole show dnsservers \"Nom interface\" Remettre le DNS de base On peut r\u00e9atribuer le DNS de base qui sera attribu\u00e9 automatiquement via le DHCP netsh interface ipv4 set dnsservers \"Nom de l'interface r\u00e9seau\" dhcp","title":"Changer DNS"},{"location":"changer_DNS_windows/#changement-de-dns-windows","text":"","title":"Changement de DNS windows"},{"location":"changer_DNS_windows/#connaitre-son-dns-actuel","text":"ipconfig /all | findstr \"Server DNS\" Pour trouver le DNS rapidement. Personnellement \u00e7a me met l'IP de ma box ce qui est normal car mes requ\u00eates sont envoy\u00e9es \u00e0 ma box qui renvoie vers le DNS de son choix et \u00e7a \u00e7a me plait pas.","title":"Connaitre son DNS actuel"},{"location":"changer_DNS_windows/#en-utilisant-le-cmd","text":"Connaitre le nom de l'interface r\u00e9seau pour laquelle on va changer le DNS netsh interface show interface Personnellement c'est Ethernet Du coup on va changer le serveur DNS du protocol IPv4 et IPv6 s\u00e9par\u00e9ment.","title":"En utilisant le cmd"},{"location":"changer_DNS_windows/#ipv4","text":"Je commence par IPv4 et je vais mettre le DNS public google : 8.8.8.8 (principal) et 8.8.4.4 (secoure), on va le faire en deux fois : /!\\ il faut lancer le terminal en administrateur netsh interface ipv4 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv4 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2","title":"IPv4"},{"location":"changer_DNS_windows/#ipv6","text":"C'est la m\u00eame chose mais avec des adresses IPv6 : 2001:4860:4860::8888 (principale sur le port 8888) et secondaire : 2001:4860:4860::8844 netsh interface ipv6 set dnsservers \"Nom interface r\u00e9seau\" static [Adresse IP du serveur DNS primaire] primary netsh interface ipv6 add dnsservers \"Nom interface r\u00e9seau\" [Adresse IP du serveur DNS secondaire] index=2 On peut v\u00e9rifier que \u00e7a a bien march\u00e9 :","title":"IPv6"},{"location":"changer_DNS_windows/#connaitre-le-dns-dune-interface-reseau-particuliere-pour-un-protocole-particulier","text":"netsh interface Nom_protocole show dnsservers \"Nom interface\"","title":"Connaitre le DNS d'une interface r\u00e9seau particuli\u00e8re pour un protocole particulier"},{"location":"changer_DNS_windows/#remettre-le-dns-de-base","text":"On peut r\u00e9atribuer le DNS de base qui sera attribu\u00e9 automatiquement via le DHCP netsh interface ipv4 set dnsservers \"Nom de l'interface r\u00e9seau\" dhcp","title":"Remettre le DNS de base"},{"location":"metasploit_bases/","text":"Les bases de Metasploit Intro fonctionnement Metasploit se lance avec la commande msfconsole . C'est une interface qui permet de lancer des exploits sur une cible. Quand on rentre dans la console metasploit, c'est une console \u00e0 part du terminal classique. Les commandes utiles \u00e0 garder en t\u00eate sont help ma_commande et history qui permet de lister l'historique des commandes effectu\u00e9es. Dans metasploit, il y a des modules que l'on s\u00e9lectionne en utilisant la commande use le/chemin/de/mon/module . Les modules sont un ensemble de code qui va s'ex\u00e9cuter automatiquement. La plupart du temps les modules sont des exploits . Ils permettent d'exploiter une faille mais il y a aussi des modules permettant de rep\u00e9rer des vuln\u00e9rabilit\u00e9s ou autre. Il faut garder en t\u00eate qu'avec metasploit il y a une notion de profondeur. Lorsqu'on utilise un module on est au niveau de ce module uniquement, quand on est dans la payload d'un module et qu'on fait des modifications on est dans la payload pr\u00e9cise uniquement, etc. Pour revenir d'un niveau en arri\u00e8re on peut utiliser la commande : back Utiliser une exploit Rechercher un module Il y a un grand nombre de modules pr\u00e9sents avec metasploit. Il est donc n\u00e9cessaire de faire des recherches au sein de ces modules. Pour cela on peut utiliser la commande : search ce que je veux chercher Il y a plusieurs param\u00e8tres possibles avec la fonction search. Plus d'infos en faisant un help search . Parmis les param\u00e8tres utiles il y a le fait de pouvoir s\u00e9lectionner le rang des r\u00e9sultats. En effet, chaque exploit \u00e0 un rang qui correspond globalement \u00e0 son taux de r\u00e9ussite. On peut aussi s\u00e9lectionner les modules ayant la fonctionnalit\u00e9 \"check\" qui permet de checker si l'exploit est possible sur la cible sans le lancer pour autant. S\u00e9lectionner un module Directement apr\u00e8s une recherche on peut faire un use [num\u00e9ro du module dans la recherche] ce qui vient s\u00e9lectionner le module souhait\u00e9. Ou alors on peut marquer le nom complet du module apr\u00e8s le use. Param\u00e9trer le module Avant de param\u00e9trer le module il vaut mieux comprendre ce qu'il fait et de quels param\u00e8tres il a besoin. Pour \u00e7a on peut faire un : info qui nous donne toutes les infos sur le module. Il y a aussi une liste de param\u00e8tres qu'on peut entrer en faisant : set mon_param\u00e8tre sa_valeur Attention ! le param\u00e8tre sera sauvegard\u00e9 en tant que variable local de ce module. Si on change de module il faudra refaire les param\u00e8tres. Pour faire des param\u00e8tres globaux il faut utiliser : setg mon_param\u00e8tre_global sa_valeur On peut faire un show options pour voir si les param\u00e8tres ont bien \u00e9t\u00e9 mis correctement On peut supprimer un param\u00e8tre local avec la commande unset nom_du_param\u00e8tre . On peut supprimer tous les param\u00e8tres locaux avec unset all . Pour faire de m\u00eame avec les param\u00e8tre globaux : unsetg Trouver des payloads Une fois que l'exploit sera lanc\u00e9, une premi\u00e8re faille sera cr\u00e9\u00e9e et \u00e7a va ouvrir une porte appel\u00e9e session . Suite \u00e0 quoi on peut envoyer des payloads qui sont des morceaux de code qui vont s'ex\u00e9cuter sur la machine cible. Pour trouver des payloads compatibles avec le module utilis\u00e9, on peut faire un : show payloads Lancer l'exploit Avant de lancer l'exploit, si le module le permet, on peut checker si l'exploit est faisable sur la cible avec : check Pour lancer une exploit il suffit de taper la commande exploit ou run . Si on rajoute l'option exploit -z \u00e7a va lancer l'exploit et mettre la session ouverte en arri\u00e8re plan. G\u00e9rer les sessions Une fois l'exploit r\u00e9ussi, cela ouvre une session. On peut continuer sur cette session directement ou la mettre en arri\u00e8re plan avec la commande : background Pour lister les sessions actives en arri\u00e8re plan on peut faire un : sessions Pour int\u00e9ragir avec une session : session -i [num\u00e9ro de la sesssion]","title":"Les bases"},{"location":"metasploit_bases/#les-bases-de-metasploit","text":"","title":"Les bases de Metasploit"},{"location":"metasploit_bases/#intro-fonctionnement","text":"Metasploit se lance avec la commande msfconsole . C'est une interface qui permet de lancer des exploits sur une cible. Quand on rentre dans la console metasploit, c'est une console \u00e0 part du terminal classique. Les commandes utiles \u00e0 garder en t\u00eate sont help ma_commande et history qui permet de lister l'historique des commandes effectu\u00e9es. Dans metasploit, il y a des modules que l'on s\u00e9lectionne en utilisant la commande use le/chemin/de/mon/module . Les modules sont un ensemble de code qui va s'ex\u00e9cuter automatiquement. La plupart du temps les modules sont des exploits . Ils permettent d'exploiter une faille mais il y a aussi des modules permettant de rep\u00e9rer des vuln\u00e9rabilit\u00e9s ou autre. Il faut garder en t\u00eate qu'avec metasploit il y a une notion de profondeur. Lorsqu'on utilise un module on est au niveau de ce module uniquement, quand on est dans la payload d'un module et qu'on fait des modifications on est dans la payload pr\u00e9cise uniquement, etc. Pour revenir d'un niveau en arri\u00e8re on peut utiliser la commande : back","title":"Intro fonctionnement"},{"location":"metasploit_bases/#utiliser-une-exploit","text":"","title":"Utiliser une exploit"},{"location":"metasploit_bases/#rechercher-un-module","text":"Il y a un grand nombre de modules pr\u00e9sents avec metasploit. Il est donc n\u00e9cessaire de faire des recherches au sein de ces modules. Pour cela on peut utiliser la commande : search ce que je veux chercher Il y a plusieurs param\u00e8tres possibles avec la fonction search. Plus d'infos en faisant un help search . Parmis les param\u00e8tres utiles il y a le fait de pouvoir s\u00e9lectionner le rang des r\u00e9sultats. En effet, chaque exploit \u00e0 un rang qui correspond globalement \u00e0 son taux de r\u00e9ussite. On peut aussi s\u00e9lectionner les modules ayant la fonctionnalit\u00e9 \"check\" qui permet de checker si l'exploit est possible sur la cible sans le lancer pour autant.","title":"Rechercher un module"},{"location":"metasploit_bases/#selectionner-un-module","text":"Directement apr\u00e8s une recherche on peut faire un use [num\u00e9ro du module dans la recherche] ce qui vient s\u00e9lectionner le module souhait\u00e9. Ou alors on peut marquer le nom complet du module apr\u00e8s le use.","title":"S\u00e9lectionner un module"},{"location":"metasploit_bases/#parametrer-le-module","text":"Avant de param\u00e9trer le module il vaut mieux comprendre ce qu'il fait et de quels param\u00e8tres il a besoin. Pour \u00e7a on peut faire un : info qui nous donne toutes les infos sur le module. Il y a aussi une liste de param\u00e8tres qu'on peut entrer en faisant : set mon_param\u00e8tre sa_valeur Attention ! le param\u00e8tre sera sauvegard\u00e9 en tant que variable local de ce module. Si on change de module il faudra refaire les param\u00e8tres. Pour faire des param\u00e8tres globaux il faut utiliser : setg mon_param\u00e8tre_global sa_valeur On peut faire un show options pour voir si les param\u00e8tres ont bien \u00e9t\u00e9 mis correctement On peut supprimer un param\u00e8tre local avec la commande unset nom_du_param\u00e8tre . On peut supprimer tous les param\u00e8tres locaux avec unset all . Pour faire de m\u00eame avec les param\u00e8tre globaux : unsetg","title":"Param\u00e9trer le module"},{"location":"metasploit_bases/#trouver-des-payloads","text":"Une fois que l'exploit sera lanc\u00e9, une premi\u00e8re faille sera cr\u00e9\u00e9e et \u00e7a va ouvrir une porte appel\u00e9e session . Suite \u00e0 quoi on peut envoyer des payloads qui sont des morceaux de code qui vont s'ex\u00e9cuter sur la machine cible. Pour trouver des payloads compatibles avec le module utilis\u00e9, on peut faire un : show payloads","title":"Trouver des payloads"},{"location":"metasploit_bases/#lancer-lexploit","text":"Avant de lancer l'exploit, si le module le permet, on peut checker si l'exploit est faisable sur la cible avec : check Pour lancer une exploit il suffit de taper la commande exploit ou run . Si on rajoute l'option exploit -z \u00e7a va lancer l'exploit et mettre la session ouverte en arri\u00e8re plan.","title":"Lancer l'exploit"},{"location":"metasploit_bases/#gerer-les-sessions","text":"Une fois l'exploit r\u00e9ussi, cela ouvre une session. On peut continuer sur cette session directement ou la mettre en arri\u00e8re plan avec la commande : background Pour lister les sessions actives en arri\u00e8re plan on peut faire un : sessions Pour int\u00e9ragir avec une session : session -i [num\u00e9ro de la sesssion]","title":"G\u00e9rer les sessions"},{"location":"nmap_bases_scan/","text":"Les bases de Nmap : les scans La base des bases c'est de faire un man nmap Pour voir tous les switchs disponibles. Une autre mani\u00e8re d'avoir des infos est d'aller sur : le site officiel nmap Scan du r\u00e9seau Pour commencer et avoir une vue d'ensemble du r\u00e9seau le mieux est de connaitre les IPs des machines actives sur le r\u00e9seau local. Pour faire \u00e7a on peut demander \u00e0 nmap de faire un scan de type ping (protocole ICMP) en utilisant -sn . Il faut donner le masque du r\u00e9seau sur lequel il va faire son scan avec un /24 (ou /16 ou /8 ou autre) avec l'ip du broadcast ou alors mettre des * : nmap -sn -vv 192.168.0.0-254 nmap -sn -vv 192.168.0.0/24 nmap -sn -vv 192.168.0.* Pro tip : pour n'afficher que les hosts qui sont up on peut associer \u00e0 la commande nmap : grep -v \"down\" qui demande de ne pas afficher toutes les lignes o\u00f9 il y a marqu\u00e9 \"down\" Rappel, le -vv c'est pour verbosity c'est pour que les r\u00e9sultats soient affich\u00e9s avec plus de d\u00e9tails. -v donne un niveau de d\u00e9tail, -vv en donne 2. Les scans basiques et moins basiques Les scans basiques : * Scan de connexion TCP : -sT * Scan de connexion SYN ( TCP discret ou demi-ouvert) : -sS * Scan de connexion UDP : -sU Les moins basiques : * Scan de connexion NULL (TCP sans flag) : -sN * Scan de conexion FIN (TCP avec flag de fermeture) : -sF * Scan de connexion Xmas (TCP avec 3 flags) : -sX TCP basique (scan de base de Nmap sans sudo) En utilisant le switch -sT , Nmap va essayer une connexion TCP/IP ( 3 way handshake), il envoie un paquet de synchronisation SYN puis s'attend \u00e0 recevoir un packet de synchronisation et de prise en compte : SYN/ACK et finit par r\u00e9pondre un packet de prise en compte : ACK (acknoledgement). Si la connexion est ferm\u00e9e, pour toute requ\u00eate SYN sera envoy\u00e9 un paquet de rejet appel\u00e9 reset : RST Petit rappel, apr\u00e8s une connexion compl\u00e8te TCP/IP, on a un flux d'ouvert qu'il faut penser \u00e0 fermer. Si le port est derri\u00e8re un firewall, le peu importe qu'il soit ouvert ou non, si notre flux n'est pas explicitement ouvert notre SYN sera drop par le firewall et on resevra un RST donc ce n'est pas forc\u00e9ment le meilleur moyen de connaitre les ports ouverts Scan SYN (scan de base de Nmap en sudo) C'est un scan plus discret car dit \u00e0 moiti\u00e9 ouvert. Il se lance avec -sS . Nmap va envoyer un requ\u00eate SYN puis s'il re\u00e7oit une r\u00e9ponse SYN/ACK, au lieu d'ouvrir le flux en envoyant un paquet ACK, il envoie un packet RST. Il ferme donc directement le flux mais prend connaissance que le port est ouvert. Avantages : * Il peut \u00eatre utilis\u00e9 pour contourner les anciens syst\u00e8mes de d\u00e9tection d'intrusion, car ils recherchent une poign\u00e9e de main compl\u00e8te \u00e0 trois voies. Ce n'est souvent plus le cas avec les solutions IDS modernes ; c'est pour cette raison que les analyses SYN sont encore souvent appel\u00e9es analyses \"furtives\". * Les analyses SYN ne sont souvent pas enregistr\u00e9es par les applications qui \u00e9coutent sur des ports ouverts, car la pratique courante consiste \u00e0 enregistrer une connexion une fois qu'elle a \u00e9t\u00e9 enti\u00e8rement \u00e9tablie. Une fois de plus, cela contribue \u00e0 l'id\u00e9e que les analyses SYN sont furtives. * Sans avoir \u00e0 se pr\u00e9occuper de l'\u00e9tablissement (et de la d\u00e9connexion) d'une poign\u00e9e de main \u00e0 trois voies pour chaque port, les balayages SYN sont nettement plus rapides qu'un balayage TCP Connect standard. Inconv\u00e9nients : * Ils n\u00e9cessitent les permissions sudo pour fonctionner correctement sous Linux. En effet, les analyses SYN n\u00e9cessitent la capacit\u00e9 de cr\u00e9er des paquets bruts (par opposition \u00e0 la poign\u00e9e de main TCP compl\u00e8te), ce qui est un privil\u00e8ge que seul l'utilisateur root poss\u00e8de par d\u00e9faut. * Les services instables sont parfois interrompus par les analyses SYN, ce qui peut s'av\u00e9rer probl\u00e9matique si un client a fourni un environnement de production pour le test. En d\u00e9finitive, les avantages l'emportent sur les inconv\u00e9nients. Pour cette raison, les scans SYN sont les scans par d\u00e9faut utilis\u00e9s par Nmap s'il est ex\u00e9cut\u00e9 avec les permissions sudo. S'il est ex\u00e9cut\u00e9 sans les permissions sudo, Nmap utilise par d\u00e9faut le scan TCP Connect que nous avons vu dans la t\u00e2che pr\u00e9c\u00e9dente Scan UDP Les scans UDP sont tr\u00e8s lent car le protocole UDP est fait pour la rapidit\u00e9 et n'a pas \"d'accus\u00e9 de r\u00e9ception\", on peut connaitre les ports ferm\u00e9s mais on ne peut pas diff\u00e9rencier les ports ouverts de ceux bloqu\u00e9s par firewall (et qui drop les paquets). On l'active avec -sU . Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ouvert, il ne devrait pas y avoir de r\u00e9ponse. Lorsque cela se produit, Nmap se r\u00e9f\u00e8re au port comme \u00e9tant ouvert|filtr\u00e9. En d'autres termes, il suspecte que le port est ouvert, mais qu'il pourrait \u00eatre prot\u00e9g\u00e9 par un pare-feu. S'il obtient une r\u00e9ponse UDP (ce qui est tr\u00e8s inhabituel), le port est marqu\u00e9 comme ouvert. Le plus souvent, il n'y a pas de r\u00e9ponse, auquel cas la demande est envoy\u00e9e une deuxi\u00e8me fois pour une double v\u00e9rification. S'il n'y a toujours pas de r\u00e9ponse, le port est marqu\u00e9 comme ouvert|filtr\u00e9 et Nmap continue. Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ferm\u00e9, la cible doit r\u00e9pondre par un paquet ICMP (ping) contenant un message indiquant que le port est inaccessible. Cela identifie clairement les ports ferm\u00e9s, que Nmap marque comme tels et passe \u00e0 autre chose. *Lorsqu'il scanne des ports UDP, Nmap envoie g\u00e9n\u00e9ralement des requ\u00eates compl\u00e8tement vides - juste des paquets UDP bruts. Cela dit, pour les ports qui sont g\u00e9n\u00e9ralement occup\u00e9s par des services bien connus, il enverra plut\u00f4t une charge utile sp\u00e9cifique au protocole qui est plus susceptible de susciter une r\u00e9ponse \u00e0 partir de laquelle un r\u00e9sultat plus pr\u00e9cis peut \u00eatre tir\u00e9. * Am\u00e9liorer la rapidit\u00e9 du scan Comme le scan UDP est uuuuultra lent on peut le lancer que sur les ports les plus connus/fr\u00e9quement utilis\u00e9s. Par exemple si on veut faire le scan que sur les 50 ports les plus connus on peut faire : --top-ports 50 On peut faire \u00e7a avec n'importe quel type de scan mais celui avec lequel c'est le plus utilis\u00e9 est avec le scan udp : nmap -sU --top-ports 50 192.10.0.5 Contourner les firewall Ces 3 scans sont encore un peu plus furtifs que le scan SYN. L'objectif ici est, bien s\u00fbr, d'\u00e9chapper aux pare-feux. De nombreux pare-feux sont configur\u00e9s pour rejeter les paquets TCP entrants vers les ports bloqu\u00e9s qui ont le drapeau SYN activ\u00e9 (bloquant ainsi les nouvelles demandes d'\u00e9tablissement de connexion). En envoyant des demandes qui ne contiennent pas le drapeau SYN, nous contournons efficacement ce type de pare-feu. Bien que ce soit une bonne chose en th\u00e9orie, la plupart des solutions IDS modernes sont sensibles \u00e0 ces types d'analyse, il ne faut donc pas compter sur leur efficacit\u00e9 \u00e0 100 % lorsqu'il s'agit de syst\u00e8mes modernes. Attention, en pratique Microsoft Windows (et un grand nombre de dispositifs de r\u00e9seau Cisco) sont connus pour r\u00e9pondre par un RST \u00e0 tout paquet TCP malform\u00e9, que le port soit ouvert ou non. Il en r\u00e9sulte que tous les ports apparaissent comme \u00e9tant ferm\u00e9s. Scan NULL -sN Simplement, le scan envoie une requ\u00eate TCP remplie de 0 et attend en retour une r\u00e9ponse de RST. Scan FIN -sF Le scan envoie une requ\u00eate TCP avec uniquement le bit de \"FIN\" d'activ\u00e9 et s'attend \u00e0 une r\u00e9ponse RST. Scan Xmas -sX Le scan envoie un req\u00eate TCP avec les bits Urgent(URG), Push (PSH) et Fin (FIN) d'activ\u00e9s Rappel sur la structure d'un flag TCP/IP : 3 octets compos\u00e9s de : * 3 bits r\u00e9serv\u00e9s - 1 bit \"Nonce\" * 1 bit CWR (Congestion Windows Reduced) - 1 bit ECN (Echo) - 1 bit URG (Urgent) - 1 bit ACK (Acknoledgement) * 1 bit PSH (Push) - 1 bit RST (Reset) - 1 bit SYN (Synchronisation) - 1 bit FIN","title":"Les scans"},{"location":"nmap_bases_scan/#les-bases-de-nmap-les-scans","text":"La base des bases c'est de faire un man nmap Pour voir tous les switchs disponibles. Une autre mani\u00e8re d'avoir des infos est d'aller sur : le site officiel nmap","title":"Les bases de Nmap : les scans"},{"location":"nmap_bases_scan/#scan-du-reseau","text":"Pour commencer et avoir une vue d'ensemble du r\u00e9seau le mieux est de connaitre les IPs des machines actives sur le r\u00e9seau local. Pour faire \u00e7a on peut demander \u00e0 nmap de faire un scan de type ping (protocole ICMP) en utilisant -sn . Il faut donner le masque du r\u00e9seau sur lequel il va faire son scan avec un /24 (ou /16 ou /8 ou autre) avec l'ip du broadcast ou alors mettre des * : nmap -sn -vv 192.168.0.0-254 nmap -sn -vv 192.168.0.0/24 nmap -sn -vv 192.168.0.* Pro tip : pour n'afficher que les hosts qui sont up on peut associer \u00e0 la commande nmap : grep -v \"down\" qui demande de ne pas afficher toutes les lignes o\u00f9 il y a marqu\u00e9 \"down\" Rappel, le -vv c'est pour verbosity c'est pour que les r\u00e9sultats soient affich\u00e9s avec plus de d\u00e9tails. -v donne un niveau de d\u00e9tail, -vv en donne 2.","title":"Scan du r\u00e9seau"},{"location":"nmap_bases_scan/#les-scans-basiques-et-moins-basiques","text":"Les scans basiques : * Scan de connexion TCP : -sT * Scan de connexion SYN ( TCP discret ou demi-ouvert) : -sS * Scan de connexion UDP : -sU Les moins basiques : * Scan de connexion NULL (TCP sans flag) : -sN * Scan de conexion FIN (TCP avec flag de fermeture) : -sF * Scan de connexion Xmas (TCP avec 3 flags) : -sX","title":"Les scans basiques et moins basiques"},{"location":"nmap_bases_scan/#tcp-basique-scan-de-base-de-nmap-sans-sudo","text":"En utilisant le switch -sT , Nmap va essayer une connexion TCP/IP ( 3 way handshake), il envoie un paquet de synchronisation SYN puis s'attend \u00e0 recevoir un packet de synchronisation et de prise en compte : SYN/ACK et finit par r\u00e9pondre un packet de prise en compte : ACK (acknoledgement). Si la connexion est ferm\u00e9e, pour toute requ\u00eate SYN sera envoy\u00e9 un paquet de rejet appel\u00e9 reset : RST Petit rappel, apr\u00e8s une connexion compl\u00e8te TCP/IP, on a un flux d'ouvert qu'il faut penser \u00e0 fermer. Si le port est derri\u00e8re un firewall, le peu importe qu'il soit ouvert ou non, si notre flux n'est pas explicitement ouvert notre SYN sera drop par le firewall et on resevra un RST donc ce n'est pas forc\u00e9ment le meilleur moyen de connaitre les ports ouverts","title":"TCP basique (scan de base de Nmap sans sudo)"},{"location":"nmap_bases_scan/#scan-syn-scan-de-base-de-nmap-en-sudo","text":"C'est un scan plus discret car dit \u00e0 moiti\u00e9 ouvert. Il se lance avec -sS . Nmap va envoyer un requ\u00eate SYN puis s'il re\u00e7oit une r\u00e9ponse SYN/ACK, au lieu d'ouvrir le flux en envoyant un paquet ACK, il envoie un packet RST. Il ferme donc directement le flux mais prend connaissance que le port est ouvert. Avantages : * Il peut \u00eatre utilis\u00e9 pour contourner les anciens syst\u00e8mes de d\u00e9tection d'intrusion, car ils recherchent une poign\u00e9e de main compl\u00e8te \u00e0 trois voies. Ce n'est souvent plus le cas avec les solutions IDS modernes ; c'est pour cette raison que les analyses SYN sont encore souvent appel\u00e9es analyses \"furtives\". * Les analyses SYN ne sont souvent pas enregistr\u00e9es par les applications qui \u00e9coutent sur des ports ouverts, car la pratique courante consiste \u00e0 enregistrer une connexion une fois qu'elle a \u00e9t\u00e9 enti\u00e8rement \u00e9tablie. Une fois de plus, cela contribue \u00e0 l'id\u00e9e que les analyses SYN sont furtives. * Sans avoir \u00e0 se pr\u00e9occuper de l'\u00e9tablissement (et de la d\u00e9connexion) d'une poign\u00e9e de main \u00e0 trois voies pour chaque port, les balayages SYN sont nettement plus rapides qu'un balayage TCP Connect standard. Inconv\u00e9nients : * Ils n\u00e9cessitent les permissions sudo pour fonctionner correctement sous Linux. En effet, les analyses SYN n\u00e9cessitent la capacit\u00e9 de cr\u00e9er des paquets bruts (par opposition \u00e0 la poign\u00e9e de main TCP compl\u00e8te), ce qui est un privil\u00e8ge que seul l'utilisateur root poss\u00e8de par d\u00e9faut. * Les services instables sont parfois interrompus par les analyses SYN, ce qui peut s'av\u00e9rer probl\u00e9matique si un client a fourni un environnement de production pour le test. En d\u00e9finitive, les avantages l'emportent sur les inconv\u00e9nients. Pour cette raison, les scans SYN sont les scans par d\u00e9faut utilis\u00e9s par Nmap s'il est ex\u00e9cut\u00e9 avec les permissions sudo. S'il est ex\u00e9cut\u00e9 sans les permissions sudo, Nmap utilise par d\u00e9faut le scan TCP Connect que nous avons vu dans la t\u00e2che pr\u00e9c\u00e9dente","title":"Scan SYN (scan de base de Nmap en sudo)"},{"location":"nmap_bases_scan/#scan-udp","text":"Les scans UDP sont tr\u00e8s lent car le protocole UDP est fait pour la rapidit\u00e9 et n'a pas \"d'accus\u00e9 de r\u00e9ception\", on peut connaitre les ports ferm\u00e9s mais on ne peut pas diff\u00e9rencier les ports ouverts de ceux bloqu\u00e9s par firewall (et qui drop les paquets). On l'active avec -sU . Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ouvert, il ne devrait pas y avoir de r\u00e9ponse. Lorsque cela se produit, Nmap se r\u00e9f\u00e8re au port comme \u00e9tant ouvert|filtr\u00e9. En d'autres termes, il suspecte que le port est ouvert, mais qu'il pourrait \u00eatre prot\u00e9g\u00e9 par un pare-feu. S'il obtient une r\u00e9ponse UDP (ce qui est tr\u00e8s inhabituel), le port est marqu\u00e9 comme ouvert. Le plus souvent, il n'y a pas de r\u00e9ponse, auquel cas la demande est envoy\u00e9e une deuxi\u00e8me fois pour une double v\u00e9rification. S'il n'y a toujours pas de r\u00e9ponse, le port est marqu\u00e9 comme ouvert|filtr\u00e9 et Nmap continue. Lorsqu'un paquet est envoy\u00e9 \u00e0 un port UDP ferm\u00e9, la cible doit r\u00e9pondre par un paquet ICMP (ping) contenant un message indiquant que le port est inaccessible. Cela identifie clairement les ports ferm\u00e9s, que Nmap marque comme tels et passe \u00e0 autre chose. *Lorsqu'il scanne des ports UDP, Nmap envoie g\u00e9n\u00e9ralement des requ\u00eates compl\u00e8tement vides - juste des paquets UDP bruts. Cela dit, pour les ports qui sont g\u00e9n\u00e9ralement occup\u00e9s par des services bien connus, il enverra plut\u00f4t une charge utile sp\u00e9cifique au protocole qui est plus susceptible de susciter une r\u00e9ponse \u00e0 partir de laquelle un r\u00e9sultat plus pr\u00e9cis peut \u00eatre tir\u00e9. *","title":"Scan UDP"},{"location":"nmap_bases_scan/#ameliorer-la-rapidite-du-scan","text":"Comme le scan UDP est uuuuultra lent on peut le lancer que sur les ports les plus connus/fr\u00e9quement utilis\u00e9s. Par exemple si on veut faire le scan que sur les 50 ports les plus connus on peut faire : --top-ports 50 On peut faire \u00e7a avec n'importe quel type de scan mais celui avec lequel c'est le plus utilis\u00e9 est avec le scan udp : nmap -sU --top-ports 50 192.10.0.5","title":"Am\u00e9liorer la rapidit\u00e9 du scan"},{"location":"nmap_bases_scan/#contourner-les-firewall","text":"Ces 3 scans sont encore un peu plus furtifs que le scan SYN. L'objectif ici est, bien s\u00fbr, d'\u00e9chapper aux pare-feux. De nombreux pare-feux sont configur\u00e9s pour rejeter les paquets TCP entrants vers les ports bloqu\u00e9s qui ont le drapeau SYN activ\u00e9 (bloquant ainsi les nouvelles demandes d'\u00e9tablissement de connexion). En envoyant des demandes qui ne contiennent pas le drapeau SYN, nous contournons efficacement ce type de pare-feu. Bien que ce soit une bonne chose en th\u00e9orie, la plupart des solutions IDS modernes sont sensibles \u00e0 ces types d'analyse, il ne faut donc pas compter sur leur efficacit\u00e9 \u00e0 100 % lorsqu'il s'agit de syst\u00e8mes modernes. Attention, en pratique Microsoft Windows (et un grand nombre de dispositifs de r\u00e9seau Cisco) sont connus pour r\u00e9pondre par un RST \u00e0 tout paquet TCP malform\u00e9, que le port soit ouvert ou non. Il en r\u00e9sulte que tous les ports apparaissent comme \u00e9tant ferm\u00e9s.","title":"Contourner les firewall"},{"location":"nmap_bases_scan/#scan-null-sn","text":"Simplement, le scan envoie une requ\u00eate TCP remplie de 0 et attend en retour une r\u00e9ponse de RST.","title":"Scan NULL -sN"},{"location":"nmap_bases_scan/#scan-fin-sf","text":"Le scan envoie une requ\u00eate TCP avec uniquement le bit de \"FIN\" d'activ\u00e9 et s'attend \u00e0 une r\u00e9ponse RST.","title":"Scan FIN -sF"},{"location":"nmap_bases_scan/#scan-xmas-sx","text":"Le scan envoie un req\u00eate TCP avec les bits Urgent(URG), Push (PSH) et Fin (FIN) d'activ\u00e9s","title":"Scan Xmas -sX"},{"location":"nmap_bases_scan/#rappel-sur-la-structure-dun-flag-tcpip","text":"3 octets compos\u00e9s de : * 3 bits r\u00e9serv\u00e9s - 1 bit \"Nonce\" * 1 bit CWR (Congestion Windows Reduced) - 1 bit ECN (Echo) - 1 bit URG (Urgent) - 1 bit ACK (Acknoledgement) * 1 bit PSH (Push) - 1 bit RST (Reset) - 1 bit SYN (Synchronisation) - 1 bit FIN","title":"Rappel sur la structure d'un flag TCP/IP :"},{"location":"nmap_bases_utiles/","text":"Les bases de Nmap : des fonctionnalit\u00e9s utiles Enregistrer le r\u00e9sultat \u00e7a peut \u00eatre pratique d'enregistrer le r\u00e9sultat d'un scan. L\u2019option -oN permet d\u2019enregistrer le r\u00e9sultat du portscan dans un fichier au format texte : nmap -oN output.txt 192.168.1.1 Pour enregistrer le r\u00e9sultat du scan de port dans un fichier au format XML : nmap -oX output.xml 192.168.1.1 Analyser un h\u00f4te ou un r\u00e9seau Scanner plusieurs h\u00f4tes En param\u00e8tre : nmap [ip1] [ip2] [ip3] Avec une liste pr\u00e9d\u00e9finie : nmap -iL chemin/liste_ip.txt On peut directement mettre une adresse web en param\u00e8tre : nmap www.google.com Exclure IP ou H\u00f4tes ou R\u00e9seaux En param\u00e8tre : nmap 192.168.1.0/24 --exclude 192.168.1.1 nmap 192.168.1.0/24 --exclude 192.168.1.1 192.168.1.5 nmap 192.168.1.0/24 --exclude 192.168.1.1,2,3 Depuis une liste : nmap 192.168.1.0/24 --excludefile exclusion.txt Scanner des ports en particulier Il faut pr\u00e9ciser le type de protocole utilis\u00e9 par le port : T pour TCP/IP, U pour UDP Exemple : nmap -p T:80 [ip] nmap -p U:53 [ip] nmap -p T:1-1024 [ip] nmap -p U:53,9,113,T:21-25,80,443,8080 [ip] Recherche num\u00e9ro de version On peut trouver le num\u00e9ro de version du service qui s'ex\u00e9cute sur des h\u00f4tes avec : nmap -sV [ip] Trouver l'OS En utilisant l'option -O D\u00e9sactiver les requ\u00eates ping C'est tr\u00e8s utile car certains parefeu bloque par d\u00e9faut toutes les requ\u00eates ICMP (ping) et nmap ping par d\u00e9faut donc une cible peut \u00eatre enregistr\u00e9e comme down juste \u00e0 cause de \u00e7a. nmap -Pn [ip] D\u00e9sactiver la r\u00e9solution DNS nmap -n [ip] Changer de type de scan L\u2019option -P permet de changer le type de scan : -Pn : Traitez tous les h\u00f4tes comme en ligne \u2013 ignorez la d\u00e9couverte des h\u00f4tes -PS/PA/PU/PY[portlist] : TCP SYN/ACK, UDP or SCTP d\u00e9couverte vers des ports donn\u00e9s -PE / PP / PM : sondes de d\u00e9couverte d\u2019\u00e9cho, d\u2019horodatage et de demande de masque de r\u00e9seau ICMP -PO [liste de protocoles] : Ping de protocole IP Exemples : Analyser les h\u00f4tes distants \u00e0 l\u2019aide de TCP ACK (PA) et TCP Syn (PS) : nmap -PS 192.168.1.1 Analyser l\u2019h\u00f4te distant pour des ports sp\u00e9cifiques avec TCP ACK : nmap -PA -p 22,80 192.168.1.1 Utiliser des scripts Le Nmap Scripting Engine (NSE) est un ajout incroyablement puissant \u00e0 Nmap, qui \u00e9tend consid\u00e9rablement ses fonctionnalit\u00e9s. Les scripts NSE sont \u00e9crits dans le langage de programmation Lua, et peuvent \u00eatre utilis\u00e9s pour faire une vari\u00e9t\u00e9 de choses : de l'analyse des vuln\u00e9rabilit\u00e9s, \u00e0 l'automatisation des exploits pour ces vuln\u00e9rabilit\u00e9s. Le NSE est particuli\u00e8rement utile pour la reconnaissance, mais il convient de garder \u00e0 l'esprit l'\u00e9tendue de la biblioth\u00e8que de scripts. De nombreuses cat\u00e9gories sont disponibles. Parmi les cat\u00e9gories utiles, on peut citer safe : n'affectera pas la cible intrusive : pas s\u00fbr : susceptible d'affecter la cible vuln : recherche de vuln\u00e9rabilit\u00e9s exploit : Tentative d'exploitation d'une vuln\u00e9rabilit\u00e9 auth : Tentative de contournement de l'authentification pour les services en cours d'ex\u00e9cution (par exemple, connexion anonyme \u00e0 un serveur FTP) brute : Tentative de forcer les informations d'identification des services en cours d'ex\u00e9cution. discovery : Tenter d'interroger les services en cours d'ex\u00e9cution pour obtenir des informations suppl\u00e9mentaires sur le r\u00e9seau (par exemple, interroger un serveur SNMP). Une liste plus exhaustive est disponible ici . Scanner les vuln\u00e9rabilit\u00e9s Il existe un script pr\u00e9d\u00e9fini pr\u00e9sent dans la commande dans Nmap qui permet aux utilisateurs d\u2019ex\u00e9cuter un scan de vuln\u00e9rabilit\u00e9s. Cela est donc tr\u00e8s pratique pour s\u2019assurer que votre syst\u00e8me est \u00e0 jour et non vuln\u00e9rable. On peut utiliser ces scripts pr\u00e9d\u00e9finis ou poss\u00e9der leur langage de programmation Lua pour d\u00e9river une fonctionnalit\u00e9 sp\u00e9cifique qui peut aider \u00e0 la d\u00e9tection CVE. Pour cela, on utilise l\u2019option -script vuln : nmap -Pn \u2013script vuln [ip] On peut simplement utiliser le v\u00e9rificateur de logiciels malveillants Google SafeBrowsing par la commande: nmap -p80 \u2013script http-google-malware www.malekal.com Pour aller plus loin On peut utiliser un script disponible sur git pour avoir plus de vuln\u00e9rabilit\u00e9s check\u00e9s. Etape 1 : Se mettre dans le r\u00e9pertoire : cd /usr/share/nmap/scripts Etape 2 : Cloner le repo : git clone https://github.com/vulnersCom/nmap-vulners.git Etape 3 : Utiliser vulners: nmap -sV --script nmap-vulners/ [ip cible] Lancer une attaque brutforce On utilise l\u2019option -script pour sp\u00e9cifier le type d\u2019attaque. nmap -sV \u2013script http-wordpress-brute \u2013script-args \u2018userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.hostname=domain.com, http-wordpress-brute.threads=3,brute.firstonly=true\u2019 [ip] Contre MS-SQL nmap -p 1433 \u2013script ms-sql-brute \u2013script-args userdb=customuser.txt,passdb=custompass.txt [ip] Contre FTP nmap \u2013script ftp-brute -p 21 192.168.1.105 Contourner un firewall tips Utiliser les switch -sN , -sF ou -sX Se r\u00e9f\u00e9rer au document La base de Nmap : les scans Bloquer les requ\u00eates ICMP Votre h\u00f4te Windows typique, avec son pare-feu par d\u00e9faut, bloque tous les paquets ICMP. Cela pose un probl\u00e8me : non seulement nous utilisons souvent ping pour \u00e9tablir manuellement l'activit\u00e9 d'une cible, mais Nmap fait la m\u00eame chose par d\u00e9faut. Cela signifie que Nmap enregistrera un h\u00f4te avec cette configuration de pare-feu comme mort et ne prendra pas la peine de le scanner. Nous avons donc besoin d'un moyen de contourner cette configuration. Heureusement, Nmap fournit une option pour cela : -Pn , qui dit \u00e0 Nmap de ne pas prendre la peine d'envoyer un ping \u00e0 l'h\u00f4te avant de le scanner. Cela signifie que Nmap traitera toujours le(s) h\u00f4te(s) cible(s) comme \u00e9tant vivant(s), contournant ainsi le bloc ICMP ; cependant, cela a pour prix de prendre potentiellement beaucoup de temps pour compl\u00e9ter le scan (si l'h\u00f4te est vraiment mort, alors Nmap v\u00e9rifiera et rev\u00e9rifiera chaque port sp\u00e9cifi\u00e9). Fragmenter le paquet -f : Utilis\u00e9 pour fragmenter les paquets (c'est-\u00e0-dire les diviser en petits morceaux), ce qui r\u00e9duit la probabilit\u00e9 que les paquets soient d\u00e9tect\u00e9s par un pare-feu ou un syst\u00e8me de d\u00e9tection d'intrusion. --mtu <nombre> : Comme -f mais avec plus de contr\u00f4le. Accepte une taille maximale d'unit\u00e9 de transmission \u00e0 utiliser pour les paquets envoy\u00e9s. Il doit s'agir d'un multiple de 8. Ajouter un d\u00e9lai --scan-delay <time>ms : Utilis\u00e9 pour ajouter un d\u00e9lai entre les paquets envoy\u00e9s. C'est tr\u00e8s utile si le r\u00e9seau est instable, mais aussi pour \u00e9viter les d\u00e9clenchements de pare-feu/IDS bas\u00e9s sur le temps qui peuvent \u00eatre en place. Faire une mauvaise checksum --badsum : Est utilis\u00e9 pour g\u00e9n\u00e9rer une somme de contr\u00f4le invalide pour les paquets. Toute pile TCP/IP r\u00e9elle laisserait tomber ce paquet, mais les pare-feux peuvent potentiellement r\u00e9pondre automatiquement, sans prendre la peine de v\u00e9rifier la somme de contr\u00f4le du paquet. Ainsi, ce commutateur peut \u00eatre utilis\u00e9 pour d\u00e9terminer la pr\u00e9sence d'un pare-feu/IDS. Autres options utiles \u2013exclude : Exclure des h\u00f4tes du scan -n : D\u00e9sactiver la r\u00e9solution DNS \u2013open : Afficher que les ports ouverts -oN : Enregistrer le r\u00e9sultat du scan dans un fichier au formate texte -oX : Enregistrer le r\u00e9sultat du scan dans un fichier au formate XML -p : Sp\u00e9cifier les ports r\u00e9seaux \u00e0 scanner -Pn : D\u00e9sactiver la d\u00e9couverte d\u2019h\u00f4te -r : Analyser les ports cons\u00e9cutivement -sT : Faire un scan de port TCP -sU : Faire un scan de port UDP -sV : Trouver les versions du service -script : Utilise un script interne \u00e0 nmap pour scan de vuln\u00e9rabilit\u00e9, bruteforce, etc -v : -vv : Mode bavard","title":"Utile"},{"location":"nmap_bases_utiles/#les-bases-de-nmap-des-fonctionnalites-utiles","text":"","title":"Les bases de Nmap : des fonctionnalit\u00e9s utiles"},{"location":"nmap_bases_utiles/#enregistrer-le-resultat","text":"\u00e7a peut \u00eatre pratique d'enregistrer le r\u00e9sultat d'un scan. L\u2019option -oN permet d\u2019enregistrer le r\u00e9sultat du portscan dans un fichier au format texte : nmap -oN output.txt 192.168.1.1 Pour enregistrer le r\u00e9sultat du scan de port dans un fichier au format XML : nmap -oX output.xml 192.168.1.1","title":"Enregistrer le r\u00e9sultat"},{"location":"nmap_bases_utiles/#analyser-un-hote-ou-un-reseau","text":"","title":"Analyser un h\u00f4te ou un r\u00e9seau"},{"location":"nmap_bases_utiles/#scanner-plusieurs-hotes","text":"En param\u00e8tre : nmap [ip1] [ip2] [ip3] Avec une liste pr\u00e9d\u00e9finie : nmap -iL chemin/liste_ip.txt On peut directement mettre une adresse web en param\u00e8tre : nmap www.google.com","title":"Scanner plusieurs h\u00f4tes"},{"location":"nmap_bases_utiles/#exclure-ip-ou-hotes-ou-reseaux","text":"En param\u00e8tre : nmap 192.168.1.0/24 --exclude 192.168.1.1 nmap 192.168.1.0/24 --exclude 192.168.1.1 192.168.1.5 nmap 192.168.1.0/24 --exclude 192.168.1.1,2,3 Depuis une liste : nmap 192.168.1.0/24 --excludefile exclusion.txt","title":"Exclure  IP ou H\u00f4tes ou R\u00e9seaux"},{"location":"nmap_bases_utiles/#scanner-des-ports-en-particulier","text":"Il faut pr\u00e9ciser le type de protocole utilis\u00e9 par le port : T pour TCP/IP, U pour UDP Exemple : nmap -p T:80 [ip] nmap -p U:53 [ip] nmap -p T:1-1024 [ip] nmap -p U:53,9,113,T:21-25,80,443,8080 [ip]","title":"Scanner des ports en particulier"},{"location":"nmap_bases_utiles/#recherche-numero-de-version","text":"On peut trouver le num\u00e9ro de version du service qui s'ex\u00e9cute sur des h\u00f4tes avec : nmap -sV [ip]","title":"Recherche num\u00e9ro de version"},{"location":"nmap_bases_utiles/#trouver-los","text":"En utilisant l'option -O","title":"Trouver l'OS"},{"location":"nmap_bases_utiles/#desactiver-les-requetes-ping","text":"C'est tr\u00e8s utile car certains parefeu bloque par d\u00e9faut toutes les requ\u00eates ICMP (ping) et nmap ping par d\u00e9faut donc une cible peut \u00eatre enregistr\u00e9e comme down juste \u00e0 cause de \u00e7a. nmap -Pn [ip]","title":"D\u00e9sactiver les requ\u00eates ping"},{"location":"nmap_bases_utiles/#desactiver-la-resolution-dns","text":"nmap -n [ip]","title":"D\u00e9sactiver la r\u00e9solution DNS"},{"location":"nmap_bases_utiles/#changer-de-type-de-scan","text":"L\u2019option -P permet de changer le type de scan : -Pn : Traitez tous les h\u00f4tes comme en ligne \u2013 ignorez la d\u00e9couverte des h\u00f4tes -PS/PA/PU/PY[portlist] : TCP SYN/ACK, UDP or SCTP d\u00e9couverte vers des ports donn\u00e9s -PE / PP / PM : sondes de d\u00e9couverte d\u2019\u00e9cho, d\u2019horodatage et de demande de masque de r\u00e9seau ICMP -PO [liste de protocoles] : Ping de protocole IP Exemples : Analyser les h\u00f4tes distants \u00e0 l\u2019aide de TCP ACK (PA) et TCP Syn (PS) : nmap -PS 192.168.1.1 Analyser l\u2019h\u00f4te distant pour des ports sp\u00e9cifiques avec TCP ACK : nmap -PA -p 22,80 192.168.1.1","title":"Changer de type de scan"},{"location":"nmap_bases_utiles/#utiliser-des-scripts","text":"Le Nmap Scripting Engine (NSE) est un ajout incroyablement puissant \u00e0 Nmap, qui \u00e9tend consid\u00e9rablement ses fonctionnalit\u00e9s. Les scripts NSE sont \u00e9crits dans le langage de programmation Lua, et peuvent \u00eatre utilis\u00e9s pour faire une vari\u00e9t\u00e9 de choses : de l'analyse des vuln\u00e9rabilit\u00e9s, \u00e0 l'automatisation des exploits pour ces vuln\u00e9rabilit\u00e9s. Le NSE est particuli\u00e8rement utile pour la reconnaissance, mais il convient de garder \u00e0 l'esprit l'\u00e9tendue de la biblioth\u00e8que de scripts. De nombreuses cat\u00e9gories sont disponibles. Parmi les cat\u00e9gories utiles, on peut citer safe : n'affectera pas la cible intrusive : pas s\u00fbr : susceptible d'affecter la cible vuln : recherche de vuln\u00e9rabilit\u00e9s exploit : Tentative d'exploitation d'une vuln\u00e9rabilit\u00e9 auth : Tentative de contournement de l'authentification pour les services en cours d'ex\u00e9cution (par exemple, connexion anonyme \u00e0 un serveur FTP) brute : Tentative de forcer les informations d'identification des services en cours d'ex\u00e9cution. discovery : Tenter d'interroger les services en cours d'ex\u00e9cution pour obtenir des informations suppl\u00e9mentaires sur le r\u00e9seau (par exemple, interroger un serveur SNMP). Une liste plus exhaustive est disponible ici .","title":"Utiliser des scripts"},{"location":"nmap_bases_utiles/#scanner-les-vulnerabilites","text":"Il existe un script pr\u00e9d\u00e9fini pr\u00e9sent dans la commande dans Nmap qui permet aux utilisateurs d\u2019ex\u00e9cuter un scan de vuln\u00e9rabilit\u00e9s. Cela est donc tr\u00e8s pratique pour s\u2019assurer que votre syst\u00e8me est \u00e0 jour et non vuln\u00e9rable. On peut utiliser ces scripts pr\u00e9d\u00e9finis ou poss\u00e9der leur langage de programmation Lua pour d\u00e9river une fonctionnalit\u00e9 sp\u00e9cifique qui peut aider \u00e0 la d\u00e9tection CVE. Pour cela, on utilise l\u2019option -script vuln : nmap -Pn \u2013script vuln [ip] On peut simplement utiliser le v\u00e9rificateur de logiciels malveillants Google SafeBrowsing par la commande: nmap -p80 \u2013script http-google-malware www.malekal.com","title":"Scanner les vuln\u00e9rabilit\u00e9s"},{"location":"nmap_bases_utiles/#pour-aller-plus-loin","text":"On peut utiliser un script disponible sur git pour avoir plus de vuln\u00e9rabilit\u00e9s check\u00e9s. Etape 1 : Se mettre dans le r\u00e9pertoire : cd /usr/share/nmap/scripts Etape 2 : Cloner le repo : git clone https://github.com/vulnersCom/nmap-vulners.git Etape 3 : Utiliser vulners: nmap -sV --script nmap-vulners/ [ip cible]","title":"Pour aller plus loin"},{"location":"nmap_bases_utiles/#lancer-une-attaque-brutforce","text":"On utilise l\u2019option -script pour sp\u00e9cifier le type d\u2019attaque. nmap -sV \u2013script http-wordpress-brute \u2013script-args \u2018userdb=users.txt,passdb=passwds.txt,http-wordpress-brute.hostname=domain.com, http-wordpress-brute.threads=3,brute.firstonly=true\u2019 [ip]","title":"Lancer une attaque brutforce"},{"location":"nmap_bases_utiles/#contre-ms-sql","text":"nmap -p 1433 \u2013script ms-sql-brute \u2013script-args userdb=customuser.txt,passdb=custompass.txt [ip]","title":"Contre MS-SQL"},{"location":"nmap_bases_utiles/#contre-ftp","text":"nmap \u2013script ftp-brute -p 21 192.168.1.105","title":"Contre FTP"},{"location":"nmap_bases_utiles/#contourner-un-firewall-tips","text":"","title":"Contourner un firewall tips"},{"location":"nmap_bases_utiles/#utiliser-les-switch-sn-sf-ou-sx","text":"Se r\u00e9f\u00e9rer au document La base de Nmap : les scans","title":"Utiliser les switch -sN, -sF ou -sX"},{"location":"nmap_bases_utiles/#bloquer-les-requetes-icmp","text":"Votre h\u00f4te Windows typique, avec son pare-feu par d\u00e9faut, bloque tous les paquets ICMP. Cela pose un probl\u00e8me : non seulement nous utilisons souvent ping pour \u00e9tablir manuellement l'activit\u00e9 d'une cible, mais Nmap fait la m\u00eame chose par d\u00e9faut. Cela signifie que Nmap enregistrera un h\u00f4te avec cette configuration de pare-feu comme mort et ne prendra pas la peine de le scanner. Nous avons donc besoin d'un moyen de contourner cette configuration. Heureusement, Nmap fournit une option pour cela : -Pn , qui dit \u00e0 Nmap de ne pas prendre la peine d'envoyer un ping \u00e0 l'h\u00f4te avant de le scanner. Cela signifie que Nmap traitera toujours le(s) h\u00f4te(s) cible(s) comme \u00e9tant vivant(s), contournant ainsi le bloc ICMP ; cependant, cela a pour prix de prendre potentiellement beaucoup de temps pour compl\u00e9ter le scan (si l'h\u00f4te est vraiment mort, alors Nmap v\u00e9rifiera et rev\u00e9rifiera chaque port sp\u00e9cifi\u00e9).","title":"Bloquer les requ\u00eates ICMP"},{"location":"nmap_bases_utiles/#fragmenter-le-paquet","text":"-f : Utilis\u00e9 pour fragmenter les paquets (c'est-\u00e0-dire les diviser en petits morceaux), ce qui r\u00e9duit la probabilit\u00e9 que les paquets soient d\u00e9tect\u00e9s par un pare-feu ou un syst\u00e8me de d\u00e9tection d'intrusion. --mtu <nombre> : Comme -f mais avec plus de contr\u00f4le. Accepte une taille maximale d'unit\u00e9 de transmission \u00e0 utiliser pour les paquets envoy\u00e9s. Il doit s'agir d'un multiple de 8.","title":"Fragmenter le paquet"},{"location":"nmap_bases_utiles/#ajouter-un-delai","text":"--scan-delay <time>ms : Utilis\u00e9 pour ajouter un d\u00e9lai entre les paquets envoy\u00e9s. C'est tr\u00e8s utile si le r\u00e9seau est instable, mais aussi pour \u00e9viter les d\u00e9clenchements de pare-feu/IDS bas\u00e9s sur le temps qui peuvent \u00eatre en place.","title":"Ajouter un d\u00e9lai"},{"location":"nmap_bases_utiles/#faire-une-mauvaise-checksum","text":"--badsum : Est utilis\u00e9 pour g\u00e9n\u00e9rer une somme de contr\u00f4le invalide pour les paquets. Toute pile TCP/IP r\u00e9elle laisserait tomber ce paquet, mais les pare-feux peuvent potentiellement r\u00e9pondre automatiquement, sans prendre la peine de v\u00e9rifier la somme de contr\u00f4le du paquet. Ainsi, ce commutateur peut \u00eatre utilis\u00e9 pour d\u00e9terminer la pr\u00e9sence d'un pare-feu/IDS.","title":"Faire une mauvaise checksum"},{"location":"nmap_bases_utiles/#autres-options-utiles","text":"\u2013exclude : Exclure des h\u00f4tes du scan -n : D\u00e9sactiver la r\u00e9solution DNS \u2013open : Afficher que les ports ouverts -oN : Enregistrer le r\u00e9sultat du scan dans un fichier au formate texte -oX : Enregistrer le r\u00e9sultat du scan dans un fichier au formate XML -p : Sp\u00e9cifier les ports r\u00e9seaux \u00e0 scanner -Pn : D\u00e9sactiver la d\u00e9couverte d\u2019h\u00f4te -r : Analyser les ports cons\u00e9cutivement -sT : Faire un scan de port TCP -sU : Faire un scan de port UDP -sV : Trouver les versions du service -script : Utilise un script interne \u00e0 nmap pour scan de vuln\u00e9rabilit\u00e9, bruteforce, etc -v : -vv : Mode bavard","title":"Autres options utiles"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/","text":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware Etape 1 : D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !) Etape 2 : Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu. Etape 3 : si \u00e7a n'a pas fonctionn\u00e9 Regarder si la carte m\u00e8re a un cavalier au niveau du module BIOS, c'est ce qu'on appelle un NUC. Il devrait y avoir 3 pin avec marqu\u00e9 \"BIOS sec\" et le chevalet est sur 2 d'entre eux (normalement sur le pin 1 et 2) Etape 4 : Si c'est un NUC de nouvelle g\u00e9n\u00e9ration Retirer le cavalier (avant prendre une photo est conseill\u00e9 pour retenir sa position) Rebrancher et rallumer L'ordinateur va entrer dans un menu de configuration S\u00e9lectionner \"Supprimer le mot de passe de l'utilisateur et du superviseur du BIOS Eteindre et tout d\u00e9brancher Replacer le NUC sur les broches 1 et 2 (dans le bon sens Attention) Rebrancher et voil\u00e0 Etape 5 : Si c'est un NUC de premi\u00e8re g\u00e9n\u00e9ration Liste des mod\u00e8les de 1 \u00e8re g\u00e9n\u00e9ration : D33217CK D33217GKE DCP847SKE D53427RKE DC3217BY DC3217IYE DCCP847DYE DC53427HYE Etapes \u00e0 suivre : 1. Mettre le NUC sur les pins 2-3 (au lieu de 1-2) 2. Reprendre \u00e0 l'\u00e9tape 2 de la partie pr\u00e9c\u00e9dente","title":"PC fixe"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#supprimer-le-mdp-maitre-bios-dun-pc-fixe-avec-acces-au-hardware","text":"","title":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-1","text":"D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !)","title":"Etape 1 :"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-2","text":"Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu.","title":"Etape 2 :"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-3-si-ca-na-pas-fonctionne","text":"Regarder si la carte m\u00e8re a un cavalier au niveau du module BIOS, c'est ce qu'on appelle un NUC. Il devrait y avoir 3 pin avec marqu\u00e9 \"BIOS sec\" et le chevalet est sur 2 d'entre eux (normalement sur le pin 1 et 2)","title":"Etape 3 : si \u00e7a n'a pas fonctionn\u00e9"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-4-si-cest-un-nuc-de-nouvelle-generation","text":"Retirer le cavalier (avant prendre une photo est conseill\u00e9 pour retenir sa position) Rebrancher et rallumer L'ordinateur va entrer dans un menu de configuration S\u00e9lectionner \"Supprimer le mot de passe de l'utilisateur et du superviseur du BIOS Eteindre et tout d\u00e9brancher Replacer le NUC sur les broches 1 et 2 (dans le bon sens Attention) Rebrancher et voil\u00e0","title":"Etape 4 : Si c'est un NUC de nouvelle g\u00e9n\u00e9ration"},{"location":"reset_mdp_BIOS_hardware_PC_fixe/#etape-5-si-cest-un-nuc-de-premiere-generation","text":"Liste des mod\u00e8les de 1 \u00e8re g\u00e9n\u00e9ration : D33217CK D33217GKE DCP847SKE D53427RKE DC3217BY DC3217IYE DCCP847DYE DC53427HYE Etapes \u00e0 suivre : 1. Mettre le NUC sur les pins 2-3 (au lieu de 1-2) 2. Reprendre \u00e0 l'\u00e9tape 2 de la partie pr\u00e9c\u00e9dente","title":"Etape 5 : Si c'est un NUC de premi\u00e8re g\u00e9n\u00e9ration"},{"location":"reset_mdp_BIOS_hardware_PC_portable/","text":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware Etape 1 : D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !) Etape 2 : Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu. Etape 3 : si \u00e7a n'a pas fonctionn\u00e9 C'est que le mot de passe est gard\u00e9 sur une petite puce \u00e0 c\u00f4t\u00e9.. L'action pr\u00e9c\u00e9dente a du remettre un mot de passe g\u00e9n\u00e9rique. Il faut alors trouver le mdp g\u00e9n\u00e9rique de l'ordinateur. Etape 4 : Retrouver le mdp g\u00e9n\u00e9rique du BIOS Retrouver le site du fabricant de l'ordinateur pour aller sur la page de r\u00e9cup\u00e9ration du mot de passe BIOS. Pour HP et Dell par exemple c'est : bios-pw . Attention : pour les PCs Asus je crois qu'il faut faire une requ\u00eate manuelle en demandant au support. Ils demanderont le num\u00e9ro de s\u00e9rie et la facture de l'ordinateur ou une carte d'identit\u00e9 Retrouver le num\u00e9ro de s\u00e9rie de l'odinateur (g\u00e9n\u00e9ralement c'est marqu\u00e9 derri\u00e8re l'ordinateur sur les petites \u00e9tiquettes) Rentrer le num\u00e9ro de s\u00e9rie et cliquer sur le r\u00e9cup\u00e9rer le mot de passe Rentrer le mdp g\u00e9n\u00e9r\u00e9 en mode QWERTY car de base le clavi\u00e9 est mapp\u00e9 en qwerty.","title":"PC portable"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#supprimer-le-mdp-maitre-bios-dun-pc-fixe-avec-acces-au-hardware","text":"","title":"Supprimer le mdp maitre BIOS d'un PC fixe avec acc\u00e8s au hardware"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-1","text":"D\u00e9brancher la carte m\u00e8re et essayer d'allumer l'ordinateur \u00e0 vide afin de vider les condensateurs (on est jamais trop prudent !)","title":"Etape 1 :"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-2","text":"Retirer la pile de la carte m\u00e8re attendre 2 min. D\u00e9marrer \u00e0 vide. Remettre le pile. Rallumer l'ordinateur et regarder si le mdp a disparu.","title":"Etape 2 :"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-3-si-ca-na-pas-fonctionne","text":"C'est que le mot de passe est gard\u00e9 sur une petite puce \u00e0 c\u00f4t\u00e9.. L'action pr\u00e9c\u00e9dente a du remettre un mot de passe g\u00e9n\u00e9rique. Il faut alors trouver le mdp g\u00e9n\u00e9rique de l'ordinateur.","title":"Etape 3 : si \u00e7a n'a pas fonctionn\u00e9"},{"location":"reset_mdp_BIOS_hardware_PC_portable/#etape-4-retrouver-le-mdp-generique-du-bios","text":"Retrouver le site du fabricant de l'ordinateur pour aller sur la page de r\u00e9cup\u00e9ration du mot de passe BIOS. Pour HP et Dell par exemple c'est : bios-pw . Attention : pour les PCs Asus je crois qu'il faut faire une requ\u00eate manuelle en demandant au support. Ils demanderont le num\u00e9ro de s\u00e9rie et la facture de l'ordinateur ou une carte d'identit\u00e9 Retrouver le num\u00e9ro de s\u00e9rie de l'odinateur (g\u00e9n\u00e9ralement c'est marqu\u00e9 derri\u00e8re l'ordinateur sur les petites \u00e9tiquettes) Rentrer le num\u00e9ro de s\u00e9rie et cliquer sur le r\u00e9cup\u00e9rer le mot de passe Rentrer le mdp g\u00e9n\u00e9r\u00e9 en mode QWERTY car de base le clavi\u00e9 est mapp\u00e9 en qwerty.","title":"Etape 4 : Retrouver le mdp g\u00e9n\u00e9rique du BIOS"},{"location":"wifi-cracking/","text":"Cracker le mdp d'un wifi Les types de wifi : Il ya 3 types de r\u00e9seau wifi : WEP Les r\u00e9seaux WEP pour Wired Equivalent Privacy ne sont normalement plus utilis\u00e9s car ils a \u00e9t\u00e9 prouv\u00e9 qu'ils ont une faille de s\u00e9curit\u00e9 qui permet, apr\u00e8s avoir captur\u00e9 assez de paquets, de faire une attaque statistique pour d\u00e9terminer le mdp. WPA2-PSK Les r\u00e9seaux Wifi auxquels vous vous connectez en fournissant un mot de passe qui est le m\u00eame pour tout le monde WPA2-EAP R\u00e9seaux Wifi auxquels vous vous authentifiez en fournissant un nom d'utilisateur et un mot de passe, qui sont envoy\u00e9s \u00e0 un serveur RADIUS(Un serveur pour l'authentification des clients, pas seulement pour le wifi). Type d'authentification Les r\u00e9seaux WPA2 utilise une authentification appel\u00e9e 4-way handshake. Globalement, sans rentrer dans les d\u00e9tails \u00e7a permet au client et \u00e0 l'AP de prouver qu'ils connaissent la cl\u00e9, sans se le dire l'un \u00e0 l'autre. Le WPA et le WPA2 utilisent pratiquement la m\u00eame m\u00e9thode d'authentification, de sorte que les attaques sont les m\u00eames. Vuln\u00e9rabilit\u00e9 Il n'y en a pas de connu pour le WPA2, il faut donc passer par une attaque bruteforce. A noter que le nombre de caract\u00e8re minimal pour un mdp de WPA2 c'est 8. Les cl\u00e9s du WPA sont d\u00e9riv\u00e9es de l'ESSID (Un SSID (Le \"nom\" du r\u00e9seau que vous voyez lorsque vous essayez de vous connecter) qui peut s'appliquer \u00e0 plusieurs points d'acc\u00e8s, par exemple un bureau d'entreprise, formant normalement un r\u00e9seau plus grand. Pour Aircrack, ils font normalement r\u00e9f\u00e9rence au r\u00e9seau que vous attaquez.) et du mot de passe du r\u00e9seau. L'ESSID agit comme un sel, ce qui rend les attaques par dictionnaire plus difficiles. Cela signifie que pour un mot de passe donn\u00e9, la cl\u00e9 variera toujours pour chaque point d'acc\u00e8s. Cela signifie qu'\u00e0 moins de calculer \u00e0 l'avance le dictionnaire pour ce seul point d'acc\u00e8s/adresse MAC, vous devrez essayer des mots de passe jusqu'\u00e0 ce que vous trouviez le bon. Outil utilis\u00e9 Pour les r\u00e9seaux wifi on va utiliser l'outil aircrack-ng pour le bruteforce : site de l'outil","title":"Cracker le mdp d'un wifi"},{"location":"wifi-cracking/#cracker-le-mdp-dun-wifi","text":"","title":"Cracker le mdp d'un wifi"},{"location":"wifi-cracking/#les-types-de-wifi","text":"Il ya 3 types de r\u00e9seau wifi :","title":"Les types de wifi :"},{"location":"wifi-cracking/#wep","text":"Les r\u00e9seaux WEP pour Wired Equivalent Privacy ne sont normalement plus utilis\u00e9s car ils a \u00e9t\u00e9 prouv\u00e9 qu'ils ont une faille de s\u00e9curit\u00e9 qui permet, apr\u00e8s avoir captur\u00e9 assez de paquets, de faire une attaque statistique pour d\u00e9terminer le mdp.","title":"WEP"},{"location":"wifi-cracking/#wpa2-psk","text":"Les r\u00e9seaux Wifi auxquels vous vous connectez en fournissant un mot de passe qui est le m\u00eame pour tout le monde","title":"WPA2-PSK"},{"location":"wifi-cracking/#wpa2-eap","text":"R\u00e9seaux Wifi auxquels vous vous authentifiez en fournissant un nom d'utilisateur et un mot de passe, qui sont envoy\u00e9s \u00e0 un serveur RADIUS(Un serveur pour l'authentification des clients, pas seulement pour le wifi).","title":"WPA2-EAP"},{"location":"wifi-cracking/#type-dauthentification","text":"Les r\u00e9seaux WPA2 utilise une authentification appel\u00e9e 4-way handshake. Globalement, sans rentrer dans les d\u00e9tails \u00e7a permet au client et \u00e0 l'AP de prouver qu'ils connaissent la cl\u00e9, sans se le dire l'un \u00e0 l'autre. Le WPA et le WPA2 utilisent pratiquement la m\u00eame m\u00e9thode d'authentification, de sorte que les attaques sont les m\u00eames.","title":"Type d'authentification"},{"location":"wifi-cracking/#vulnerabilite","text":"Il n'y en a pas de connu pour le WPA2, il faut donc passer par une attaque bruteforce. A noter que le nombre de caract\u00e8re minimal pour un mdp de WPA2 c'est 8. Les cl\u00e9s du WPA sont d\u00e9riv\u00e9es de l'ESSID (Un SSID (Le \"nom\" du r\u00e9seau que vous voyez lorsque vous essayez de vous connecter) qui peut s'appliquer \u00e0 plusieurs points d'acc\u00e8s, par exemple un bureau d'entreprise, formant normalement un r\u00e9seau plus grand. Pour Aircrack, ils font normalement r\u00e9f\u00e9rence au r\u00e9seau que vous attaquez.) et du mot de passe du r\u00e9seau. L'ESSID agit comme un sel, ce qui rend les attaques par dictionnaire plus difficiles. Cela signifie que pour un mot de passe donn\u00e9, la cl\u00e9 variera toujours pour chaque point d'acc\u00e8s. Cela signifie qu'\u00e0 moins de calculer \u00e0 l'avance le dictionnaire pour ce seul point d'acc\u00e8s/adresse MAC, vous devrez essayer des mots de passe jusqu'\u00e0 ce que vous trouviez le bon.","title":"Vuln\u00e9rabilit\u00e9"},{"location":"wifi-cracking/#outil-utilise","text":"Pour les r\u00e9seaux wifi on va utiliser l'outil aircrack-ng pour le bruteforce : site de l'outil","title":"Outil utilis\u00e9"}]}